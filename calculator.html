<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Research Calculator - Substrate Math</title>
<style>
body {
  font-family: 'Courier New', monospace;
  background: #0a0a1a;
  color: #e0e0f0;
  margin: 0;
  padding: 20px;
}
.container {
  max-width: 1200px;
  margin: 0 auto;
}
h1 {
  background: linear-gradient(135deg, #6366f1, #a855f7, #ec4899);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  text-align: center;
  font-size: 1.8rem;
  margin-bottom: 30px;
}
.calc-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 20px;
  margin-bottom: 20px;
}
.card {
  background: #111128;
  border: 1px solid #1a1a3a;
  border-radius: 12px;
  padding: 20px;
}
.input-group {
  margin: 10px 0;
}
.input-group label {
  display: block;
  color: #8888aa;
  margin-bottom: 5px;
  font-size: 0.9rem;
}
input, textarea, select {
  width: 100%;
  background: #0d0d24;
  border: 1px solid #333;
  color: #e0e0f0;
  padding: 8px 12px;
  border-radius: 6px;
  font-family: 'Courier New', monospace;
  font-size: 0.9rem;
}
textarea {
  height: 100px;
  resize: vertical;
}
.btn {
  background: #6366f1;
  color: white;
  border: none;
  padding: 10px 20px;
  border-radius: 6px;
  cursor: pointer;
  font-family: inherit;
  margin: 5px;
  transition: all 0.2s;
}
.btn:hover {
  background: #a855f7;
}
.btn-small {
  padding: 5px 10px;
  font-size: 0.8rem;
}
.result {
  background: #0d0d24;
  border: 1px solid #22c55e;
  border-radius: 8px;
  padding: 15px;
  margin: 15px 0;
  font-family: 'Courier New', monospace;
}
.error {
  border-color: #ef4444;
  color: #ef4444;
}
.constants {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: 10px;
  margin: 15px 0;
}
.constant {
  background: #0d0d24;
  border: 1px solid #333;
  border-radius: 6px;
  padding: 8px;
  text-align: center;
  cursor: pointer;
  transition: all 0.2s;
}
.constant:hover {
  border-color: #6366f1;
}
.constant .name {
  font-size: 0.8rem;
  color: #8888aa;
}
.constant .value {
  font-size: 0.9rem;
  font-weight: bold;
}
</style>
</head>
<body>

<div class="container">
  <h1>üßÆ Research Calculator</h1>
  
  <div class="calc-grid">
    <div class="card">
      <h3>üìê Basic Calculator</h3>
      
      <div class="input-group">
        <label>Expression:</label>
        <textarea id="expression" placeholder="Enter mathematical expression...
Examples:
2 + 3 * 4
sqrt(16) + log(10)
sin(pi/4) + cos(pi/4)
pow(2, 8)"></textarea>
      </div>
      
      <button class="btn" onclick="calculate()">Calculate</button>
      <button class="btn btn-small" onclick="clearCalc()">Clear</button>
      
      <div id="basicResult" class="result" style="display: none;"></div>
      
      <h4>Constants</h4>
      <div class="constants">
        <div class="constant" onclick="insertValue('3.141592653589793')">
          <div class="name">œÄ (pi)</div>
          <div class="value">3.14159</div>
        </div>
        <div class="constant" onclick="insertValue('2.718281828459045')">
          <div class="name">e</div>
          <div class="value">2.71828</div>
        </div>
        <div class="constant" onclick="insertValue('299792458')">
          <div class="name">c (m/s)</div>
          <div class="value">2.998√ó10‚Å∏</div>
        </div>
        <div class="constant" onclick="insertValue('6.67430e-11')">
          <div class="name">G</div>
          <div class="value">6.67√ó10‚Åª¬π¬π</div>
        </div>
      </div>
    </div>
    
    <div class="card">
      <h3>üåå Substrate Calculations</h3>
      
      <div class="input-group">
        <label>Calculation Type:</label>
        <select id="substrateType" onchange="updateSubstrateInputs()">
          <option value="zeta">Zeta Function Œ∂(s)</option>
          <option value="schwarzschild">Schwarzschild Radius</option>
          <option value="time_dilation">Time Dilation Factor</option>
          <option value="substrate_density">Substrate Density</option>
        </select>
      </div>
      
      <div id="substrateInputs">
        <!-- Dynamic inputs based on calculation type -->
      </div>
      
      <button class="btn" onclick="calculateSubstrate()">Calculate</button>
      
      <div id="substrateResult" class="result" style="display: none;"></div>
    </div>
  </div>
  
  <div class="card">
    <h3>üî¨ Research Formulas</h3>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px;">
      <div>
        <h4>5D Metric Components</h4>
        <p><strong>g‚ÇÄ‚ÇÄ:</strong> -(1-r‚Çõ/r)¬∑Œ∂</p>
        <p><strong>g·µ¢·µ¢:</strong> spatial √ó Œ∂</p>
        <p><strong>g‚ÇÑ‚ÇÑ:</strong> ·π†¬≤ (entropy rate)</p>
        <p><strong>g‚ÇÖ‚ÇÖ:</strong> 1/r (temperature)</p>
      </div>
      
      <div>
        <h4>Substrate Relations</h4>
        <p><strong>Œ∂ mapping:</strong> Œ∂(1 + (r/r‚Çõ)¬≥)</p>
        <p><strong>Time factor:</strong> ‚àö(r‚Çõ/r)</p>
        <p><strong>Substrate excess:</strong> (Œ∂-1) √ó 100%</p>
      </div>
      
      <div>
        <h4>Physical Constants</h4>
        <p><strong>r‚Çõ‚òâ:</strong> 2.95 km (solar)</p>
        <p><strong>M‚òâ:</strong> 1.989√ó10¬≥‚Å∞ kg</p>
        <p><strong>Merger Œ∂:</strong> ~1.214 (21.4% excess)</p>
      </div>
    </div>
  </div>
</div>

<script>
// Enhanced Math functions
const MathExt = {
  // Approximate zeta function for s > 1
  zeta: function(s) {
    if (s <= 1) return NaN;
    let sum = 0;
    for (let n = 1; n <= 1000; n++) {
      sum += 1 / Math.pow(n, s);
    }
    return sum;
  },
  
  // Factorial
  factorial: function(n) {
    if (n < 0) return NaN;
    if (n === 0) return 1;
    let result = 1;
    for (let i = 1; i <= n; i++) {
      result *= i;
    }
    return result;
  },
  
  // Schwarzschild radius
  schwarzschild: function(mass) {
    const G = 6.67430e-11;
    const c = 299792458;
    return (2 * G * mass) / (c * c);
  },
  
  // Time dilation factor
  timeDilation: function(r, rs) {
    if (r <= rs) return NaN;
    return Math.sqrt(1 - rs/r);
  },
  
  // Substrate density approximation
  substrateDensity: function(r, rs) {
    if (r <= 0) return NaN;
    const s = 1 + Math.pow(r/rs, 3);
    return this.zeta(s);
  }
};

// Safe eval with math functions
function safeEval(expression) {
  // Replace common math notation
  let expr = expression
    .replace(/\bpi\b/g, 'Math.PI')
    .replace(/\be\b/g, 'Math.E')
    .replace(/\bsin\b/g, 'Math.sin')
    .replace(/\bcos\b/g, 'Math.cos')
    .replace(/\btan\b/g, 'Math.tan')
    .replace(/\bsqrt\b/g, 'Math.sqrt')
    .replace(/\blog\b/g, 'Math.log10')
    .replace(/\bln\b/g, 'Math.log')
    .replace(/\bpow\b/g, 'Math.pow')
    .replace(/\babs\b/g, 'Math.abs')
    .replace(/\bfloor\b/g, 'Math.floor')
    .replace(/\bceil\b/g, 'Math.ceil')
    .replace(/\bzeta\b/g, 'MathExt.zeta')
    .replace(/\bfactorial\b/g, 'MathExt.factorial');
  
  try {
    return eval(expr);
  } catch (e) {
    throw new Error('Invalid expression: ' + e.message);
  }
}

function calculate() {
  const expression = document.getElementById('expression').value;
  const resultDiv = document.getElementById('basicResult');
  
  if (!expression.trim()) {
    resultDiv.style.display = 'none';
    return;
  }
  
  try {
    const result = safeEval(expression);
    resultDiv.className = 'result';
    resultDiv.innerHTML = `
      <strong>Result:</strong> ${result}<br>
      <small>Scientific: ${result.toExponential(6)}</small>
    `;
    resultDiv.style.display = 'block';
  } catch (error) {
    resultDiv.className = 'result error';
    resultDiv.innerHTML = `<strong>Error:</strong> ${error.message}`;
    resultDiv.style.display = 'block';
  }
}

function clearCalc() {
  document.getElementById('expression').value = '';
  document.getElementById('basicResult').style.display = 'none';
}

function insertValue(value) {
  const textarea = document.getElementById('expression');
  const start = textarea.selectionStart;
  const end = textarea.selectionEnd;
  const text = textarea.value;
  textarea.value = text.substring(0, start) + value + text.substring(end);
  textarea.focus();
  textarea.setSelectionRange(start + value.length, start + value.length);
}

function updateSubstrateInputs() {
  const type = document.getElementById('substrateType').value;
  const container = document.getElementById('substrateInputs');
  
  let html = '';
  switch (type) {
    case 'zeta':
      html = `
        <div class="input-group">
          <label>s value:</label>
          <input type="number" id="s_value" value="2" step="0.1" placeholder="s > 1">
        </div>
      `;
      break;
    case 'schwarzschild':
      html = `
        <div class="input-group">
          <label>Mass (kg):</label>
          <input type="number" id="mass_value" value="1.989e30" step="any" placeholder="Solar mass = 1.989e30">
        </div>
      `;
      break;
    case 'time_dilation':
      html = `
        <div class="input-group">
          <label>Radius r (m):</label>
          <input type="number" id="r_value" value="10000" step="any">
        </div>
        <div class="input-group">
          <label>Schwarzschild radius rs (m):</label>
          <input type="number" id="rs_value" value="2950" step="any">
        </div>
      `;
      break;
    case 'substrate_density':
      html = `
        <div class="input-group">
          <label>Radius r:</label>
          <input type="number" id="r_value2" value="2" step="0.1">
        </div>
        <div class="input-group">
          <label>Schwarzschild radius rs:</label>
          <input type="number" id="rs_value2" value="1" step="0.1">
        </div>
      `;
      break;
  }
  
  container.innerHTML = html;
}

function calculateSubstrate() {
  const type = document.getElementById('substrateType').value;
  const resultDiv = document.getElementById('substrateResult');
  
  try {
    let result, description;
    
    switch (type) {
      case 'zeta':
        const s = parseFloat(document.getElementById('s_value').value);
        result = MathExt.zeta(s);
        description = `Œ∂(${s}) = ${result.toFixed(6)}`;
        break;
        
      case 'schwarzschild':
        const mass = parseFloat(document.getElementById('mass_value').value);
        result = MathExt.schwarzschild(mass);
        description = `Schwarzschild radius = ${result.toFixed(2)} m = ${(result/1000).toFixed(1)} km`;
        break;
        
      case 'time_dilation':
        const r = parseFloat(document.getElementById('r_value').value);
        const rs = parseFloat(document.getElementById('rs_value').value);
        result = MathExt.timeDilation(r, rs);
        const percent = (1 - result) * 100;
        description = `Time dilation factor = ${result.toFixed(6)}<br>Time runs ${percent.toFixed(3)}% slower`;
        break;
        
      case 'substrate_density':
        const r2 = parseFloat(document.getElementById('r_value2').value);
        const rs2 = parseFloat(document.getElementById('rs_value2').value);
        result = MathExt.substrateDensity(r2, rs2);
        const excess = (result - 1) * 100;
        description = `Substrate density Œ∂ = ${result.toFixed(6)}<br>Excess = ${excess.toFixed(3)}%`;
        break;
    }
    
    resultDiv.className = 'result';
    resultDiv.innerHTML = `<strong>Result:</strong><br>${description}`;
    resultDiv.style.display = 'block';
    
  } catch (error) {
    resultDiv.className = 'result error';
    resultDiv.innerHTML = `<strong>Error:</strong> ${error.message}`;
    resultDiv.style.display = 'block';
  }
}

// Initialize
window.onload = function() {
  updateSubstrateInputs();
};

// Allow Enter key to calculate in basic calculator
document.addEventListener('DOMContentLoaded', function() {
  document.getElementById('expression').addEventListener('keydown', function(e) {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      calculate();
    }
  });
});
</script>

</body>
</html>