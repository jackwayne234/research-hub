<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Repo Viewer - Live HTML from Git</title>
<style>
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
body {
  font-family: 'JetBrains Mono', monospace;
  background: #0a0a1a;
  color: #e0e0f0;
  padding: 20px;
}
.container {
  max-width: 1200px;
  margin: 0 auto;
}
h1 {
  background: linear-gradient(135deg, #6366f1, #a855f7, #ec4899);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  text-align: center;
  font-size: 2rem;
  margin-bottom: 30px;
}
.repo-section {
  background: #111128;
  border: 1px solid #1a1a3a;
  border-radius: 12px;
  padding: 25px;
  margin: 20px 0;
}
.repo-section h2 {
  color: #6366f1;
  margin-bottom: 20px;
  display: flex;
  align-items: center;
  gap: 10px;
}
.file-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 15px;
}
.file-card {
  background: #0d0d24;
  border: 1px solid #333;
  border-radius: 8px;
  padding: 20px;
  transition: all 0.2s;
  cursor: pointer;
}
.file-card:hover {
  border-color: #6366f1;
  transform: translateY(-2px);
}
.file-card h3 {
  color: #22c55e;
  margin-bottom: 10px;
  font-size: 1.1rem;
}
.file-card p {
  color: #8888aa;
  font-size: 0.9rem;
  margin-bottom: 15px;
}
.file-actions {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
}
.btn {
  padding: 6px 12px;
  border-radius: 6px;
  font-size: 0.8rem;
  font-family: inherit;
  text-decoration: none;
  text-align: center;
  transition: all 0.2s;
  cursor: pointer;
  border: none;
}
.btn-view {
  background: #22c55e;
  color: white;
}
.btn-view:hover {
  background: #16a34a;
}
.btn-source {
  background: #6366f1;
  color: white;
}
.btn-source:hover {
  background: #5148f3;
}
.btn-fetch {
  background: #f59e0b;
  color: white;
}
.btn-fetch:hover {
  background: #d97706;
}
.status {
  font-size: 0.7rem;
  padding: 2px 8px;
  border-radius: 12px;
  margin-top: 5px;
  display: inline-block;
}
.status-cached {
  background: #22c55e;
  color: #000;
}
.status-remote {
  background: #f59e0b;
  color: #000;
}
.instructions {
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(168, 85, 247, 0.1));
  border: 1px solid rgba(99, 102, 241, 0.3);
  border-radius: 12px;
  padding: 20px;
  margin-bottom: 30px;
}
</style>
</head>
<body>

<div class="container">
  <h1>üîó Repo Viewer</h1>
  
  <div class="instructions">
    <h3>üí° How This Works</h3>
    <p>Click "View Live" to render HTML files as actual webpages. Click "Fetch & Cache" to pull files from Gitea and serve them locally for faster access.</p>
  </div>

  <div class="repo-section">
    <h2>üìä benford-fun Repository</h2>
    
    <div class="file-grid">
      <div class="file-card">
        <h3>üåë Black Hole Simulator 5D</h3>
        <p>Interactive 5D prime-modified metric black hole visualization</p>
        <div class="file-actions">
          <a href="blackhole-simulator.html" class="btn btn-view">View Live</a>
          <a href="http://gitea:3000/chris/benford-fun/src/branch/main/results/html/blackhole_simulator_5D_prime.html" class="btn btn-source" target="_blank">View Source</a>
          <button class="btn btn-fetch" onclick="fetchFile('benford-fun', 'results/html/blackhole_simulator_5D_prime.html', 'blackhole-simulator.html')">Fetch & Cache</button>
        </div>
        <div class="status status-cached">Cached Locally</div>
      </div>
      
      <div class="file-card">
        <h3>üìà Metric Visualization</h3>
        <p>5D metric component visualizations and analysis</p>
        <div class="file-actions">
          <button class="btn btn-fetch" onclick="fetchFile('benford-fun', 'results/html/metric_visualization.html', 'metric-viz.html')">Fetch & View</button>
          <a href="http://gitea:3000/chris/benford-fun/tree/main/results/html" class="btn btn-source" target="_blank">Browse Repo</a>
        </div>
        <div class="status status-remote">Remote Only</div>
      </div>
      
      <div class="file-card">
        <h3>üî¨ Analysis Tools</h3>
        <p>Interactive analysis and calculation tools</p>
        <div class="file-actions">
          <button class="btn btn-fetch" onclick="fetchFile('benford-fun', 'results/html/analysis_tools.html', 'analysis-tools.html')">Fetch & View</button>
          <a href="http://gitea:3000/chris/benford-fun/tree/main/results/html" class="btn btn-source" target="_blank">Browse Repo</a>
        </div>
        <div class="status status-remote">Remote Only</div>
      </div>
    </div>
  </div>

  <div class="repo-section">
    <h2>üå°Ô∏è optical-computing-workspace</h2>
    
    <div class="file-grid">
      <div class="file-card">
        <h3>üíª N-Radix Simulator</h3>
        <p>Wavelength-division optical computing simulation</p>
        <div class="file-actions">
          <button class="btn btn-fetch" onclick="fetchFile('optical-computing-workspace', 'simulator.html', 'nradix-simulator.html')">Fetch & View</button>
          <a href="http://gitea:3000/chris/optical-computing-workspace" class="btn btn-source" target="_blank">Browse Repo</a>
        </div>
        <div class="status status-remote">Remote Only</div>
      </div>
    </div>
  </div>

  <div class="repo-section">
    <h2>üåç Climate_Benford</h2>
    
    <div class="file-grid">
      <div class="file-card">
        <h3>üìä Climate Benford Analysis</h3>
        <p>Environmental dataset Benford's Law analysis</p>
        <div class="file-actions">
          <button class="btn btn-fetch" onclick="fetchFile('Climate_Benford', 'visualization.html', 'climate-viz.html')">Fetch & View</button>
          <a href="http://gitea:3000/chris/Climate_Benford" class="btn btn-source" target="_blank">Browse Repo</a>
        </div>
        <div class="status status-remote">Remote Only</div>
      </div>
    </div>
  </div>
  
  <div style="text-align: center; margin-top: 40px;">
    <a href="working-index.html" class="btn btn-view">‚Üê Back to Research Hub</a>
    <button class="btn btn-fetch" onclick="scanRepos()">üîç Scan All Repos</button>
  </div>
</div>

<script>
async function fetchFile(repo, filePath, localName) {
  const button = event.target;
  const originalText = button.textContent;
  button.textContent = 'Fetching...';
  button.disabled = true;
  
  try {
    const url = `http://gitea:3000/chris/${repo}/raw/branch/main/${filePath}`;
    const response = await fetch(url);
    
    if (!response.ok) {
      throw new Error(`Failed to fetch: ${response.status}`);
    }
    
    const html = await response.text();
    
    // Send to server to save locally (this would need server-side implementation)
    // For now, open in new window with data URL
    const dataUrl = 'data:text/html;charset=utf-8,' + encodeURIComponent(html);
    window.open(dataUrl, '_blank');
    
    button.textContent = '‚úÖ Fetched';
    setTimeout(() => {
      button.textContent = 'View Live';
      button.disabled = false;
      button.onclick = () => window.open(dataUrl, '_blank');
    }, 2000);
    
  } catch (error) {
    console.error('Fetch failed:', error);
    button.textContent = '‚ùå Failed';
    setTimeout(() => {
      button.textContent = originalText;
      button.disabled = false;
    }, 2000);
  }
}

async function scanRepos() {
  alert('Repo scanning would be implemented server-side to automatically discover and cache HTML files from your repositories.');
}

// Show status of what's already cached
document.addEventListener('DOMContentLoaded', function() {
  // Check if files exist locally
  fetch('blackhole-simulator.html', {method: 'HEAD'})
    .then(response => {
      if (response.ok) {
        console.log('Black hole simulator cached locally');
      }
    })
    .catch(() => console.log('Black hole simulator not cached'));
});
</script>

</body>
</html>