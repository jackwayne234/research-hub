<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Daily Practice ‚Äî Riner Research Hub</title>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="../shared.css">
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
</head>
<body>
<div class="main">
<a href="../index.html" class="back-link">‚Üê Back to Hub</a>
<header class="header">
  <h1>üßÆ Daily Practice</h1>
</header>
<div class="card" id="math-qotd" style="border-color: var(--accent2);">
  <div class="card-header" onclick="toggle(this)">
    <h2>üßÆ Math Question of the Day</h2>
    <span class="chevron">‚ñº</span>
  </div>
  <div class="card-body">
    <div id="mqotd-streak" style="text-align:center;margin-bottom:12px;font-size:1.1rem;display:none;"></div>
    <div id="mqotd-content"></div>
  </div>
</div>

<script>
(function(){
  /* ‚ïê‚ïê‚ïê Geometric context templates ‚ïê‚ïê‚ïê */
  const geoText = {
    'unit-circle':'On the unit circle, sin(x) is the height (y-coordinate) and cos(x) is the horizontal position (x-coordinate) of a point at angle x. As you sweep the angle from 0 to 2\u03C0, these values trace smooth waves ‚Äî and their rates of change are each other\u2019s derivatives.',
    'slope-tangent':'The derivative measures slope ‚Äî the steepness of the tangent line at each point on the curve. Positive means rising, zero means a peak or valley, negative means falling. Zoom in far enough on any smooth curve, and it looks like a straight line ‚Äî the derivative gives you that line\u2019s slope.',
    'area-under':'The integral accumulates area under the curve. Picture sweeping a thin vertical strip from left to right ‚Äî the integral at each x is the total area swept so far. Area above the x-axis counts positive; area below counts negative.'
  };

  /* ‚ïê‚ïê‚ïê 20 curated problems ‚ïê‚ïê‚ïê */
  const problems = [
  /* ‚îÄ‚îÄ 0  Trig: d/dx[sin(x)] ‚îÄ‚îÄ */
  { cat:'Trig Derivatives', catIcon:'\uD83D\uDCD0',
    q:'What is d/dx [sin(x)]?', qDisplay:'d/dx [sin(x)] = ?',
    choices:['cos(x)','\u2212cos(x)','sin(x)','\u2212sin(x)'], correct:0,
    vars:[
      {symbol:'sin(x)',meaning:'Height (y-coordinate) on the unit circle at angle x'},
      {symbol:'cos(x)',meaning:'Horizontal position (x-coordinate) on the unit circle'},
      {symbol:'d/dx',meaning:'Rate of change of the function as x changes'}
    ],
    why:{title:'Why the derivative of sin is cos',
      paragraphs:[
        'Walk counterclockwise around the unit circle. sin(x) tracks your height. At x=0 you\u2019re about to climb at full speed \u2014 vertical velocity is 1 = cos(0).',
        'At x=\u03C0/2 (the top), height momentarily stops changing \u2014 velocity is 0 = cos(\u03C0/2). At every angle, cos(x) tells you how fast sin(x) is changing.'
      ], geometric:'unit-circle'},
    connections:['d/dx[cos(x)] = \u2212sin(x) follows the same circle logic','Chain rule extends this: d/dx[sin(f(x))] = cos(f(x))\u00B7f\u2032(x)'],
    practice:{question:'If f(x) = sin(x), find f\u2032(\u03C0/6).',
      steps:['f\u2032(x) = cos(x)','f\u2032(\u03C0/6) = cos(\u03C0/6)','cos(\u03C0/6) = \u221A3/2 \u2248 0.866'],
      answer:'f\u2032(\u03C0/6) = \u221A3/2'},
    quote:'The circle speaks through its derivatives!',
    wrongMsgs:['Think unit circle: sin traces height, its rate of change is\u2026','Remember: sin \u2192 cos \u2192 \u2212sin \u2192 \u2212cos','When sin peaks (slope=0), cos equals 0 too \u2014 which answer does that?']
  },

  /* ‚îÄ‚îÄ 1  Trig: d/dx[cos(x)] ‚îÄ‚îÄ */
  { cat:'Trig Derivatives', catIcon:'\uD83D\uDCD0',
    q:'What is d/dx [cos(x)]?', qDisplay:'d/dx [cos(x)] = ?',
    choices:['\u2212sin(x)','sin(x)','\u2212cos(x)','cos(x)'], correct:0,
    vars:[
      {symbol:'cos(x)',meaning:'Horizontal position (x-coordinate) on the unit circle'},
      {symbol:'sin(x)',meaning:'Height (y-coordinate) on the unit circle'},
      {symbol:'d/dx',meaning:'Rate of change as x changes'}
    ],
    why:{title:'Why the derivative of cos is \u2212sin',
      paragraphs:[
        'cos(x) tracks your horizontal position on the unit circle. At x=0 you\u2019re at (1,0) \u2014 about to move left, so the rate of change of the x-coordinate is 0. But at x=\u03C0/2 (the top), you\u2019re moving leftward fastest \u2014 the rate is \u22121 = \u2212sin(\u03C0/2).',
        'The minus sign reflects the direction: as you pass the top of the circle, your horizontal position is decreasing.'
      ], geometric:'unit-circle'},
    connections:['d/dx[sin(x)] = cos(x) is the companion rule','Second derivative: d\u00B2/dx\u00B2[cos(x)] = \u2212cos(x) \u2014 cosine is its own negative second derivative'],
    practice:{question:'Find f\u2032(\u03C0/3) if f(x) = cos(x).',
      steps:['f\u2032(x) = \u2212sin(x)','f\u2032(\u03C0/3) = \u2212sin(\u03C0/3)','= \u2212\u221A3/2 \u2248 \u22120.866'],
      answer:'f\u2032(\u03C0/3) = \u2212\u221A3/2'},
    quote:'Cosine\u2019s rate of change always looks backward to sine!',
    wrongMsgs:['Trig derivative cycle: cos \u2192 \u2212sin. Don\u2019t forget the minus!','Think about horizontal motion on the unit circle.','At x=\u03C0/2 cos is decreasing \u2014 the derivative must be negative there.']
  },

  /* ‚îÄ‚îÄ 2  Trig: d/dx[tan(x)] ‚îÄ‚îÄ */
  { cat:'Trig Derivatives', catIcon:'\uD83D\uDCD0',
    q:'What is d/dx [tan(x)]?', qDisplay:'d/dx [tan(x)] = ?',
    choices:['sec\u00B2(x)','csc\u00B2(x)','sec(x)\u00B7tan(x)','\u2212cot\u00B2(x)'], correct:0,
    vars:[
      {symbol:'tan(x)',meaning:'sin(x)/cos(x) \u2014 the slope of the line from the origin to the unit-circle point'},
      {symbol:'sec(x)',meaning:'1/cos(x) \u2014 the reciprocal of the horizontal coordinate'},
      {symbol:'sec\u00B2(x)',meaning:'Always \u2265 1, so tan(x) is always getting steeper (or less steep) \u2014 never flat'}
    ],
    why:{title:'Why d/dx[tan] = sec\u00B2',
      paragraphs:[
        'Write tan(x) = sin(x)/cos(x) and apply the quotient rule: [cos\u00B7cos \u2212 sin\u00B7(\u2212sin)] / cos\u00B2 = [cos\u00B2 + sin\u00B2] / cos\u00B2 = 1/cos\u00B2 = sec\u00B2(x).',
        'The Pythagorean identity cos\u00B2+sin\u00B2=1 does the heavy lifting \u2014 it collapses the numerator beautifully.'
      ], geometric:'unit-circle'},
    connections:['tan relates to the slope of the terminal side on the unit circle','This also means \u222B sec\u00B2(x) dx = tan(x) + C'],
    practice:{question:'Evaluate d/dx[tan(x)] at x = \u03C0/4.',
      steps:['d/dx[tan(x)] = sec\u00B2(x)','sec(\u03C0/4) = 1/cos(\u03C0/4) = 1/(\u221A2/2) = \u221A2','sec\u00B2(\u03C0/4) = (\u221A2)\u00B2 = 2'],
      answer:'f\u2032(\u03C0/4) = 2'},
    quote:'Quotient rule + Pythagoras = elegance!',
    wrongMsgs:['Try the quotient rule on sin/cos and simplify.','sec\u00B2 vs sec\u00B7tan \u2014 which one comes from the quotient rule?','Remember: cos\u00B2+sin\u00B2 = 1 simplifies the numerator.']
  },

  /* ‚îÄ‚îÄ 3  Core: Product rule ‚îÄ‚îÄ */
  { cat:'Core Derivatives', catIcon:'\u2702\uFE0F',
    q:'Find d/dx [x\u00B3 \u00B7 sin(x)]', qDisplay:'d/dx [x\u00B3 \u00B7 sin(x)] = ?',
    choices:['3x\u00B2 sin(x) + x\u00B3 cos(x)','3x\u00B2 cos(x)','x\u00B3 cos(x)','3x\u00B2 sin(x) \u2212 x\u00B3 cos(x)'], correct:0,
    vars:[
      {symbol:'f(x) = x\u00B3',meaning:'The polynomial factor \u2014 f\u2032 = 3x\u00B2'},
      {symbol:'g(x) = sin(x)',meaning:'The trig factor \u2014 g\u2032 = cos(x)'},
      {symbol:'(fg)\u2032 = f\u2032g + fg\u2032',meaning:'Product rule: each factor takes a turn being differentiated'}
    ],
    why:{title:'Why the product rule has two terms',
      paragraphs:[
        'When two quantities multiply, the total change comes from two sources: (1) the first factor changes while the second stays put, and (2) the second changes while the first stays put. The product rule adds both contributions.',
        'Think of area: if width and height both grow, the new area = (old width \u00D7 height change) + (old height \u00D7 width change).'
      ], geometric:'slope-tangent'},
    connections:['Product rule extends to 3+ factors: (fgh)\u2032 = f\u2032gh + fg\u2032h + fgh\u2032','Combine with chain rule for complex expressions like x\u00B3 sin(2x)'],
    practice:{question:'Evaluate d/dx[x\u00B3 sin(x)] at x = \u03C0.',
      steps:['f\u2032(\u03C0) = 3\u03C0\u00B2 sin(\u03C0) + \u03C0\u00B3 cos(\u03C0)','sin(\u03C0) = 0, cos(\u03C0) = \u22121','= 0 + \u03C0\u00B3(\u22121) = \u2212\u03C0\u00B3'],
      answer:'f\u2032(\u03C0) = \u2212\u03C0\u00B3 \u2248 \u221231.01'},
    quote:'Two terms, two contributions \u2014 that\u2019s the product rule!',
    wrongMsgs:['Product rule: differentiate each factor separately, then add both terms.','Don\u2019t forget: (fg)\u2032 = f\u2032g + fg\u2032, not just one term.','Both x\u00B3 and sin(x) contribute to the rate of change.']
  },

  /* ‚îÄ‚îÄ 4  Core: Power rule ‚îÄ‚îÄ */
  { cat:'Core Derivatives', catIcon:'\u2702\uFE0F',
    q:'What is d/dx [x\u2075]?', qDisplay:'d/dx [x\u2075] = ?',
    choices:['5x\u2074','4x\u2075','5x\u2075','x\u2074'], correct:0,
    vars:[
      {symbol:'x\u207F',meaning:'x raised to the nth power'},
      {symbol:'nx\u207F\u207B\u00B9',meaning:'Power rule result: bring the exponent down, reduce it by 1'},
      {symbol:'n',meaning:'The exponent \u2014 here n = 5'}
    ],
    why:{title:'Why the power rule works',
      paragraphs:[
        'Expand x\u207F as x\u00B7x\u00B7x\u2026 (n times). By the product rule on all n copies, each x gets a turn being differentiated (giving 1) while the others stay. That\u2019s n copies of x\u207F\u207B\u00B9.',
        'This elegant pattern \u2014 d/dx[x\u207F] = nx\u207F\u207B\u00B9 \u2014 works for all real n, not just integers: fractions, negatives, even irrational exponents.'
      ], geometric:'slope-tangent'},
    connections:['Reverse it for integration: \u222B x\u207F dx = x\u207F\u207A\u00B9/(n+1) + C (when n \u2260 \u22121)','Combine with chain rule: d/dx[(f(x))\u207F] = n(f(x))\u207F\u207B\u00B9 \u00B7 f\u2032(x)'],
    practice:{question:'Find f\u2032(2) if f(x) = x\u2075.',
      steps:['f\u2032(x) = 5x\u2074','f\u2032(2) = 5 \u00B7 2\u2074','= 5 \u00B7 16 = 80'],
      answer:'f\u2032(2) = 80'},
    quote:'Bring it down, knock it back \u2014 the power rule!',
    wrongMsgs:['Power rule: multiply by the exponent, then reduce it by 1.','d/dx[x\u207F] = nx\u207F\u207B\u00B9 \u2014 the exponent becomes the coefficient.','5 comes down in front, and the new exponent is 4.']
  },

  /* ‚îÄ‚îÄ 5  Core: d/dx[e^x] ‚îÄ‚îÄ */
  { cat:'Core Derivatives', catIcon:'\u2702\uFE0F',
    q:'What is d/dx [e\u02E3]?', qDisplay:'d/dx [e\u02E3] = ?',
    choices:['e\u02E3','x\u00B7e\u02E3\u207B\u00B9','x\u00B7e\u02E3','ln(x)\u00B7e\u02E3'], correct:0,
    vars:[
      {symbol:'e',meaning:'Euler\u2019s number \u2248 2.71828 \u2014 the base of the natural logarithm'},
      {symbol:'e\u02E3',meaning:'The exponential function \u2014 grows faster than any polynomial'},
      {symbol:'d/dx[e\u02E3] = e\u02E3',meaning:'The unique function that equals its own derivative'}
    ],
    why:{title:'Why e\u02E3 is its own derivative',
      paragraphs:[
        'The number e is defined so that the slope of e\u02E3 at every point equals the value of e\u02E3 at that point. At x=0, the value is 1 and the slope is 1. At x=1, the value is e \u2248 2.718 and the slope is also e.',
        'No other base does this: d/dx[2\u02E3] = ln(2)\u00B72\u02E3, d/dx[10\u02E3] = ln(10)\u00B710\u02E3. Only base e has that perfect coefficient of 1.'
      ], geometric:'slope-tangent'},
    connections:['This is why e appears everywhere in math and physics','Chain rule: d/dx[e^(f(x))] = e^(f(x)) \u00B7 f\u2032(x)'],
    practice:{question:'What is the slope of e\u02E3 at x = 0?',
      steps:['Slope = d/dx[e\u02E3] = e\u02E3','At x=0: e\u2070 = 1'],
      answer:'Slope at x=0 is exactly 1'},
    quote:'e\u02E3 is the fixed point of differentiation!',
    wrongMsgs:['e\u02E3 is special: it doesn\u2019t change when you differentiate it.','Don\u2019t apply the power rule here \u2014 x is in the exponent, not the base.','The function that equals its own derivative is\u2026']
  },

  /* ‚îÄ‚îÄ 6  Chain Rule: d/dx[e^(x\u00B2)] ‚îÄ‚îÄ */
  { cat:'Chain Rule', catIcon:'\uD83D\uDD17',
    q:'Find d/dx [e^(x\u00B2)]', qDisplay:'d/dx [e^(x\u00B2)] = ?',
    choices:['2x \u00B7 e^(x\u00B2)','e^(x\u00B2)','x\u00B2 \u00B7 e^(x\u00B2\u22121)','2x \u00B7 e^(2x)'], correct:0,
    vars:[
      {symbol:'e^(x\u00B2)',meaning:'e raised to the power x\u00B2 \u2014 the outer function is e^u, the inner is u = x\u00B2'},
      {symbol:'2x',meaning:'The derivative of the inner function x\u00B2'},
      {symbol:'chain rule',meaning:'d/dx[f(g(x))] = f\u2032(g(x)) \u00B7 g\u2032(x) \u2014 outer derivative \u00D7 inner derivative'}
    ],
    why:{title:'Chain rule: peel the onion',
      paragraphs:[
        'e^(x\u00B2) is a composition: the outer function e^u applied to the inner function u = x\u00B2. The chain rule says: differentiate the outside (leaving the inside alone), then multiply by the derivative of the inside.',
        'd/dx[e^u] = e^u, and d/dx[x\u00B2] = 2x. Multiply: e^(x\u00B2) \u00B7 2x.'
      ], geometric:'slope-tangent'},
    connections:['This pattern works for any e^(f(x)): the answer is always f\u2032(x)\u00B7e^(f(x))','Reverse: \u222B 2x\u00B7e^(x\u00B2) dx = e^(x\u00B2) + C by substitution'],
    practice:{question:'Find d/dx[e^(3x)] using the chain rule.',
      steps:['Outer: e^u \u2192 d/du[e^u] = e^u','Inner: u = 3x \u2192 du/dx = 3','Chain rule: e^(3x) \u00B7 3 = 3e^(3x)'],
      answer:'d/dx[e^(3x)] = 3e^(3x)'},
    quote:'Peel the layers \u2014 outer times inner!',
    wrongMsgs:['Chain rule: differentiate the outside, then multiply by the inside\u2019s derivative.','The inner function is x\u00B2 \u2014 its derivative is 2x.','Don\u2019t use the power rule on the exponent!']
  },

  /* ‚îÄ‚îÄ 7  Chain Rule: d/dx[ln(cos(x))] ‚îÄ‚îÄ */
  { cat:'Chain Rule', catIcon:'\uD83D\uDD17',
    q:'Find d/dx [ln(cos(x))]', qDisplay:'d/dx [ln(cos(x))] = ?',
    choices:['\u2212tan(x)','tan(x)','\u22121/cos(x)','1/cos\u00B2(x)'], correct:0,
    vars:[
      {symbol:'ln(u)',meaning:'Natural log \u2014 outer function, with u = cos(x)'},
      {symbol:'d/du[ln(u)] = 1/u',meaning:'Derivative of ln: the reciprocal'},
      {symbol:'d/dx[cos(x)] = \u2212sin(x)',meaning:'Derivative of the inner function'}
    ],
    why:{title:'Two-layer chain rule',
      paragraphs:[
        'Outer function: ln(u) with derivative 1/u. Inner function: cos(x) with derivative \u2212sin(x).',
        'Chain rule: (1/cos(x)) \u00B7 (\u2212sin(x)) = \u2212sin(x)/cos(x) = \u2212tan(x). The ratio sin/cos simplifies to tan!'
      ], geometric:'slope-tangent'},
    connections:['d/dx[ln(f(x))] = f\u2032(x)/f(x) \u2014 this pattern is called logarithmic differentiation','Useful in integration: \u222B tan(x) dx = \u2212ln|cos(x)| + C'],
    practice:{question:'Find d/dx[ln(sin(x))].',
      steps:['Outer: 1/sin(x)','Inner derivative: cos(x)','Chain rule: cos(x)/sin(x) = cot(x)'],
      answer:'d/dx[ln(sin(x))] = cot(x)'},
    quote:'Log + trig = beautiful simplification!',
    wrongMsgs:['Outer: 1/cos(x). Inner: \u2212sin(x). Multiply them.','sin(x)/cos(x) has a name \u2014 what is it?','Don\u2019t forget the minus sign from differentiating cos.']
  },

  /* ‚îÄ‚îÄ 8  Integrals: Power rule ‚îÄ‚îÄ */
  { cat:'Integrals', catIcon:'\u222B',
    q:'Evaluate \u222B x\u00B3 dx', qDisplay:'\u222B x\u00B3 dx = ?',
    choices:['x\u2074/4 + C','x\u2074 + C','3x\u00B2 + C','x\u00B3/3 + C'], correct:0,
    vars:[
      {symbol:'\u222B',meaning:'Integral sign \u2014 \u201Cundo\u201D the derivative, find the antiderivative'},
      {symbol:'C',meaning:'Constant of integration \u2014 any constant vanishes when differentiated'},
      {symbol:'x\u207F\u207A\u00B9/(n+1)',meaning:'Reverse power rule: increase exponent by 1, divide by the new exponent'}
    ],
    why:{title:'Reversing the power rule',
      paragraphs:[
        'Since d/dx[x\u2074] = 4x\u00B3, we need to undo that 4. Dividing by 4 gives d/dx[x\u2074/4] = x\u00B3. So x\u2074/4 is the antiderivative.',
        'The +C accounts for the fact that d/dx[constant] = 0 \u2014 any constant could have been there before differentiating.'
      ], geometric:'area-under'},
    connections:['This reverses the power rule for derivatives','Exception: \u222B x\u207B\u00B9 dx = ln|x| + C (can\u2019t divide by 0)'],
    practice:{question:'Evaluate \u222B x\u2077 dx.',
      steps:['\u222B x\u207F dx = x\u207F\u207A\u00B9/(n+1) + C','n = 7: x\u2078/8 + C'],
      answer:'\u222B x\u2077 dx = x\u2078/8 + C'},
    quote:'Integration: the art of going backwards!',
    wrongMsgs:['Reverse the power rule: raise the exponent by 1, divide by it.','3x\u00B2 is the derivative of x\u00B3, not its integral.','Increase the exponent, then divide.']
  },

  /* ‚îÄ‚îÄ 9  Integrals: u-substitution ‚îÄ‚îÄ */
  { cat:'Integrals', catIcon:'\u222B',
    q:'Evaluate \u222B 2x \u00B7 e^(x\u00B2) dx', qDisplay:'\u222B 2x \u00B7 e^(x\u00B2) dx = ?',
    choices:['e^(x\u00B2) + C','x\u00B2 \u00B7 e\u02E3 + C','2e\u02E3 + C','e^(2x) + C'], correct:0,
    vars:[
      {symbol:'u = x\u00B2',meaning:'The substitution \u2014 the inner function inside e^(\u2026)'},
      {symbol:'du = 2x dx',meaning:'Differentiating the substitution gives us exactly the leftover factor'},
      {symbol:'\u222B e^u du = e^u + C',meaning:'Once substituted, it\u2019s just the basic exponential integral'}
    ],
    why:{title:'u-substitution undoes the chain rule',
      paragraphs:[
        'We know d/dx[e^(x\u00B2)] = 2x \u00B7 e^(x\u00B2) by the chain rule. Integration is the reverse \u2014 so \u222B 2x \u00B7 e^(x\u00B2) dx = e^(x\u00B2) + C.',
        'The key insight: the 2x factor is exactly the derivative of x\u00B2. When you see f\u2032(x) \u00B7 g(f(x)), substitution collapses it to \u222B g(u) du.'
      ], geometric:'area-under'},
    connections:['u-substitution is the integration version of the chain rule','Pattern: \u222B f\u2032(x) \u00B7 e^(f(x)) dx = e^(f(x)) + C always works'],
    practice:{question:'Evaluate \u222B 6x\u00B2 \u00B7 e^(x\u00B3) dx.',
      steps:['u = x\u00B3, du = 3x\u00B2 dx','Rewrite: 2\u222B 3x\u00B2 \u00B7 e^(x\u00B3) dx = 2\u222B e^u du','= 2e^(x\u00B3) + C'],
      answer:'2e^(x\u00B3) + C'},
    quote:'Spot the chain-rule pattern and substitution writes itself!',
    wrongMsgs:['Look for a function and its derivative sitting together.','u = x\u00B2, du = 2x dx \u2014 everything matches perfectly!','This reverses the chain rule: d/dx[e^(x\u00B2)] = 2x\u00B7e^(x\u00B2).']
  },

  /* ‚îÄ‚îÄ 10  Integrals: by parts ‚îÄ‚îÄ */
  { cat:'Integrals', catIcon:'\u222B',
    q:'Evaluate \u222B x \u00B7 e\u02E3 dx', qDisplay:'\u222B x \u00B7 e\u02E3 dx = ?',
    choices:['x\u00B7e\u02E3 \u2212 e\u02E3 + C','x\u00B7e\u02E3 + C','x\u00B2e\u02E3/2 + C','e\u02E3(x+1) + C'], correct:0,
    vars:[
      {symbol:'u = x, dv = e\u02E3 dx',meaning:'Choose u to differentiate (simplifies) and dv to integrate'},
      {symbol:'du = dx, v = e\u02E3',meaning:'After choosing, differentiate u and integrate dv'},
      {symbol:'\u222B u dv = uv \u2212 \u222B v du',meaning:'The integration-by-parts formula'}
    ],
    why:{title:'Integration by parts: the product rule in reverse',
      paragraphs:[
        'The product rule says d/dx[uv] = u\u2032v + uv\u2032. Rearranging: uv\u2032 = d/dx[uv] \u2212 u\u2032v. Integrate both sides: \u222B u dv = uv \u2212 \u222B v du.',
        'Choose u = x (which simplifies when differentiated to 1) and dv = e\u02E3 dx. Then uv \u2212 \u222B v du = xe\u02E3 \u2212 \u222B e\u02E3 dx = xe\u02E3 \u2212 e\u02E3 + C.'
      ], geometric:'area-under'},
    connections:['Mnemonic LIATE: Log, Inverse trig, Algebraic, Trig, Exponential \u2014 pick u from left','Note: x\u00B7e\u02E3 \u2212 e\u02E3 = e\u02E3(x\u22121) \u2014 but the first form is the standard answer'],
    practice:{question:'Evaluate \u222B x\u00B7cos(x) dx.',
      steps:['u = x, dv = cos(x) dx','du = dx, v = sin(x)','= x\u00B7sin(x) \u2212 \u222B sin(x) dx = x\u00B7sin(x) + cos(x) + C'],
      answer:'x\u00B7sin(x) + cos(x) + C'},
    quote:'When substitution won\u2019t work, try parts!',
    wrongMsgs:['Integration by parts: \u222B u dv = uv \u2212 \u222B v du','Let u = x and dv = e\u02E3 dx. What do you get?','e\u02E3(x+1) has the wrong sign \u2014 check the subtraction.']
  },

  /* ‚îÄ‚îÄ 11  Integrals: Definite ‚îÄ‚îÄ */
  { cat:'Integrals', catIcon:'\u222B',
    q:'Evaluate \u222B\u2080\u00B9 3x\u00B2 dx', qDisplay:'\u222B\u2080\u00B9 3x\u00B2 dx = ?',
    choices:['1','3','0','1/3'], correct:0,
    vars:[
      {symbol:'\u222B\u2080\u00B9',meaning:'Definite integral from 0 to 1 \u2014 evaluate the antiderivative at the bounds'},
      {symbol:'3x\u00B2',meaning:'The integrand \u2014 the function whose area we\u2019re computing'},
      {symbol:'F(b) \u2212 F(a)',meaning:'Fundamental Theorem: evaluate antiderivative at top bound minus bottom bound'}
    ],
    why:{title:'The Fundamental Theorem in action',
      paragraphs:[
        'First find the antiderivative: \u222B 3x\u00B2 dx = x\u00B3. Then evaluate at the bounds: F(1) \u2212 F(0) = 1\u00B3 \u2212 0\u00B3 = 1.',
        'Geometrically, this is the area under the parabola y = 3x\u00B2 from x = 0 to x = 1. The area happens to be exactly 1 square unit.'
      ], geometric:'area-under'},
    connections:['The antiderivative of 3x\u00B2 is x\u00B3 \u2014 power rule in reverse','FTC connects slopes (derivatives) to areas (integrals)'],
    practice:{question:'Evaluate \u222B\u2080\u00B2 x\u00B3 dx.',
      steps:['\u222B x\u00B3 dx = x\u2074/4','F(2) \u2212 F(0) = 16/4 \u2212 0 = 4'],
      answer:'\u222B\u2080\u00B2 x\u00B3 dx = 4'},
    quote:'Boundaries make it concrete \u2014 a definite answer!',
    wrongMsgs:['Find the antiderivative first, then plug in the bounds.','Antiderivative of 3x\u00B2 is x\u00B3 \u2014 now evaluate at 1 and 0.','Don\u2019t forget to subtract: F(1) \u2212 F(0).']
  },

  /* ‚îÄ‚îÄ 12  Limits: sin(x)/x ‚îÄ‚îÄ */
  { cat:'Limits', catIcon:'\uD83C\uDFAF',
    q:'Evaluate lim(x\u21920) sin(x)/x', qDisplay:'lim(x\u21920) sin(x)/x = ?',
    choices:['1','0','\u221E','DNE'], correct:0,
    vars:[
      {symbol:'lim(x\u21920)',meaning:'The value the expression approaches as x gets arbitrarily close to 0'},
      {symbol:'sin(x)/x',meaning:'Both top and bottom \u2192 0 as x\u21920 (an indeterminate 0/0 form)'},
      {symbol:'squeeze theorem',meaning:'sin(x)/x is squeezed between cos(x) and 1 near 0, both \u2192 1'}
    ],
    why:{title:'The most important limit in calculus',
      paragraphs:[
        'At x = 0, sin(0)/0 is undefined (0/0). But as x shrinks toward 0, sin(x) and x become nearly identical \u2014 for small angles, sin(x) \u2248 x.',
        'The squeeze theorem proves it rigorously: cos(x) \u2264 sin(x)/x \u2264 1 for small x, and since cos(0) = 1, the limit is squeezed to exactly 1.'
      ], geometric:'unit-circle'},
    connections:['This limit is used to prove d/dx[sin(x)] = cos(x)','Variant: lim(x\u21920) sin(kx)/x = k (the constant pulls out)'],
    practice:{question:'Evaluate lim(x\u21920) sin(5x)/x.',
      steps:['Rewrite: 5 \u00B7 sin(5x)/(5x)','Let u = 5x \u2192 sin(u)/u \u2192 1','= 5 \u00B7 1 = 5'],
      answer:'lim(x\u21920) sin(5x)/x = 5'},
    quote:'Small angles, big consequences!',
    wrongMsgs:['This is 0/0, not 0 or \u221E \u2014 need more analysis.','For tiny x, sin(x) \u2248 x, so the ratio approaches\u2026','The squeeze theorem pins it to exactly 1.']
  },

  /* ‚îÄ‚îÄ 13  Limits: L\u2019H\u00F4pital ‚îÄ‚îÄ */
  { cat:'Limits', catIcon:'\uD83C\uDFAF',
    q:'Evaluate lim(x\u21920) (e\u02E3 \u2212 1)/x', qDisplay:'lim(x\u21920) (e\u02E3 \u2212 1)/x = ?',
    choices:['1','0','e','\u221E'], correct:0,
    vars:[
      {symbol:'e\u02E3 \u2212 1',meaning:'Numerator \u2192 0 as x\u21920 (since e\u2070 = 1)'},
      {symbol:'x',meaning:'Denominator \u2192 0 as x\u21920'},
      {symbol:'L\u2019H\u00F4pital\u2019s Rule',meaning:'For 0/0 or \u221E/\u221E, take derivatives of top and bottom separately'}
    ],
    why:{title:'L\u2019H\u00F4pital turns 0/0 into something computable',
      paragraphs:[
        'Both numerator and denominator \u2192 0 as x\u21920, giving 0/0. L\u2019H\u00F4pital says: differentiate top and bottom separately.',
        'd/dx[e\u02E3 \u2212 1] = e\u02E3, and d/dx[x] = 1. So the limit becomes lim(x\u21920) e\u02E3/1 = e\u2070 = 1.'
      ], geometric:'slope-tangent'},
    connections:['This limit equals d/dx[e\u02E3] evaluated at x=0 (definition of derivative!)','L\u2019H\u00F4pital also works for \u221E/\u221E forms'],
    practice:{question:'Evaluate lim(x\u21920) (e\u00B3\u02E3 \u2212 1)/x.',
      steps:['0/0 form \u2192 apply L\u2019H\u00F4pital','d/dx[e\u00B3\u02E3 \u2212 1] = 3e\u00B3\u02E3, d/dx[x] = 1','lim(x\u21920) 3e\u00B3\u02E3/1 = 3'],
      answer:'lim(x\u21920) (e\u00B3\u02E3 \u2212 1)/x = 3'},
    quote:'When 0/0 blocks the way, L\u2019H\u00F4pital clears the path!',
    wrongMsgs:['This is 0/0 \u2014 not 0 and not e.','Differentiate top and bottom separately (not quotient rule!).','d/dx[e\u02E3 \u2212 1] = e\u02E3. At x=0 that\u2019s\u2026']
  },

  /* ‚îÄ‚îÄ 14  Limits: at infinity ‚îÄ‚îÄ */
  { cat:'Limits', catIcon:'\uD83C\uDFAF',
    q:'Evaluate lim(x\u2192\u221E) (3x\u00B2+1)/(x\u00B2\u22122)', qDisplay:'lim(x\u2192\u221E) (3x\u00B2+1)/(x\u00B2\u22122) = ?',
    choices:['3','1','\u221E','0'], correct:0,
    vars:[
      {symbol:'x\u2192\u221E',meaning:'x grows without bound \u2014 we want the long-run behavior'},
      {symbol:'highest-degree terms',meaning:'For rational functions, only the leading terms matter as x\u2192\u221E'},
      {symbol:'3x\u00B2/x\u00B2 = 3',meaning:'Divide everything by x\u00B2 and the small terms vanish'}
    ],
    why:{title:'Dominant terms determine the limit at infinity',
      paragraphs:[
        'Divide numerator and denominator by x\u00B2: (3 + 1/x\u00B2)/(1 \u2212 2/x\u00B2). As x\u2192\u221E, 1/x\u00B2 \u2192 0 and 2/x\u00B2 \u2192 0.',
        'The limit becomes 3/1 = 3. The rule: when degrees match, the limit is the ratio of leading coefficients.'
      ], geometric:'slope-tangent'},
    connections:['Same degree \u2192 ratio of coefficients; higher on top \u2192 \u221E; higher on bottom \u2192 0','This determines horizontal asymptotes of rational functions'],
    practice:{question:'Evaluate lim(x\u2192\u221E) (5x\u00B3+x)/(2x\u00B3\u22127).',
      steps:['Same degree (3) in top and bottom','Ratio of leading coefficients: 5/2'],
      answer:'5/2'},
    quote:'At infinity, only the biggest terms survive!',
    wrongMsgs:['Look at the highest power of x in top and bottom.','Both are degree 2 \u2014 so take the ratio of leading coefficients.','Divide everything by x\u00B2 to see what survives.']
  },

  /* ‚îÄ‚îÄ 15  LinAlg: Eigenvalues ‚îÄ‚îÄ */
  { cat:'Linear Algebra', catIcon:'\uD83D\uDCCA',
    q:'Find the eigenvalues of A = [[2,1],[0,3]]', qDisplay:'Eigenvalues of [[2,1],[0,3]] = ?',
    choices:['\u03BB = 2, 3','\u03BB = 1, 6','\u03BB = 2, 1','\u03BB = 0, 5'], correct:0,
    vars:[
      {symbol:'\u03BB (lambda)',meaning:'Eigenvalue \u2014 the scalar by which eigenvectors are stretched'},
      {symbol:'det(A \u2212 \u03BBI) = 0',meaning:'The characteristic equation that eigenvalues satisfy'},
      {symbol:'triangular matrix',meaning:'A matrix with all zeros below (or above) the diagonal'}
    ],
    why:{title:'Triangular matrices reveal eigenvalues instantly',
      paragraphs:[
        'For a triangular matrix, det(A \u2212 \u03BBI) = (a\u2081\u2081 \u2212 \u03BB)(a\u2082\u2082 \u2212 \u03BB)\u2026 because the off-diagonal terms don\u2019t contribute to the determinant.',
        'So eigenvalues = diagonal entries. Here: (2\u2212\u03BB)(3\u2212\u03BB) = 0 gives \u03BB = 2 and \u03BB = 3.'
      ], geometric:null},
    connections:['Trace = sum of eigenvalues: 2+3 = 5 = tr(A)','Determinant = product of eigenvalues: 2\u00D73 = 6 = det(A)'],
    practice:{question:'Find eigenvalues of [[5,2],[0,\u22121]].',
      steps:['Triangular \u2192 eigenvalues are diagonal entries','(5\u2212\u03BB)(\u22121\u2212\u03BB) = 0'],
      answer:'\u03BB = 5, \u03BB = \u22121'},
    quote:'Triangular matrices don\u2019t hide their eigenvalues!',
    wrongMsgs:['For triangular matrices, eigenvalues sit on the diagonal.','Compute det(A \u2212 \u03BBI) and set it to 0.','The zero below the diagonal is the key \u2014 it\u2019s triangular!']
  },

  /* ‚îÄ‚îÄ 16  LinAlg: Dot product ‚îÄ‚îÄ */
  { cat:'Linear Algebra', catIcon:'\uD83D\uDCCA',
    q:'Compute [1,2,3] \u00B7 [4,\u22121,2]', qDisplay:'[1,2,3] \u00B7 [4,\u22121,2] = ?',
    choices:['8','6','10','12'], correct:0,
    vars:[
      {symbol:'a \u00B7 b',meaning:'Dot product \u2014 multiply corresponding components and sum'},
      {symbol:'\u03A3 a\u1D62b\u1D62',meaning:'Sum of products: a\u2081b\u2081 + a\u2082b\u2082 + a\u2083b\u2083'},
      {symbol:'a \u00B7 b = |a||b|cos\u03B8',meaning:'Geometrically: relates to the angle between vectors'}
    ],
    why:{title:'Component-by-component multiplication and sum',
      paragraphs:[
        '1\u00D74 + 2\u00D7(\u22121) + 3\u00D72 = 4 \u2212 2 + 6 = 8. Each pair of components contributes to the total.',
        'The dot product measures how much two vectors point in the same direction. Positive = similar direction, zero = perpendicular, negative = opposite.'
      ], geometric:null},
    connections:['If a \u00B7 b = 0, the vectors are orthogonal (perpendicular)','Used to compute projections: proj\u2090b = (a\u00B7b/a\u00B7a) \u00B7 a'],
    practice:{question:'Compute [2,\u22121] \u00B7 [3,6]. Are they perpendicular?',
      steps:['2\u00D73 + (\u22121)\u00D76 = 6 \u2212 6 = 0','Dot product is 0 \u2192 they ARE perpendicular!'],
      answer:'0 \u2014 yes, they\u2019re perpendicular'},
    quote:'Multiply, sum, done \u2014 the dot product is fast!',
    wrongMsgs:['Multiply each pair of components: 1\u00D74, 2\u00D7(\u22121), 3\u00D72, then add.','Don\u2019t forget the sign: 2\u00D7(\u22121) = \u22122.','4 \u2212 2 + 6 = ?']
  },

  /* ‚îÄ‚îÄ 17  LinAlg: Determinant ‚îÄ‚îÄ */
  { cat:'Linear Algebra', catIcon:'\uD83D\uDCCA',
    q:'Compute det([[3,7],[1,5]])', qDisplay:'det [[3,7],[1,5]] = ?',
    choices:['8','22','\u22122','15'], correct:0,
    vars:[
      {symbol:'det(A)',meaning:'Determinant \u2014 a single number capturing how the matrix scales area'},
      {symbol:'ad \u2212 bc',meaning:'For a 2\u00D72 matrix [[a,b],[c,d]], the determinant is ad \u2212 bc'},
      {symbol:'det = 0',meaning:'Would mean the matrix is singular (non-invertible, squishes to lower dimension)'}
    ],
    why:{title:'The 2\u00D72 determinant formula',
      paragraphs:[
        'For [[3,7],[1,5]]: det = 3\u00D75 \u2212 7\u00D71 = 15 \u2212 7 = 8. The cross-multiplication pattern goes: main diagonal minus off-diagonal.',
        'Geometrically, |det| = 8 means this matrix scales areas by a factor of 8. Since det > 0, it preserves orientation (no reflection).'
      ], geometric:null},
    connections:['det(A) = product of eigenvalues','If det(A) \u2260 0, the matrix is invertible: A\u207B\u00B9 exists'],
    practice:{question:'Find det([[1,2],[3,4]]).',
      steps:['ad \u2212 bc = 1\u00D74 \u2212 2\u00D73','= 4 \u2212 6 = \u22122'],
      answer:'det = \u22122 (invertible, orientation-reversing)'},
    quote:'Two products, one subtraction \u2014 the determinant!',
    wrongMsgs:['Formula: ad \u2212 bc for [[a,b],[c,d]].','3\u00D75 = 15, 7\u00D71 = 7. Now subtract.','Don\u2019t add \u2014 the determinant subtracts the diagonals.']
  },

  /* ‚îÄ‚îÄ 18  Connections: FTC ‚îÄ‚îÄ */
  { cat:'Connections', catIcon:'\uD83D\uDD17',
    q:'What is d/dx [\u222B\u2080\u02E3 sin(t) dt]?', qDisplay:'d/dx [\u222B\u2080\u02E3 sin(t) dt] = ?',
    choices:['sin(x)','\u2212cos(x)','cos(x)','\u222B sin(x) dx'], correct:0,
    vars:[
      {symbol:'\u222B\u2080\u02E3 f(t) dt',meaning:'Area under f from 0 to x \u2014 a function of the upper limit x'},
      {symbol:'FTC Part 1',meaning:'d/dx[\u222B\u2080\u02E3 f(t) dt] = f(x) \u2014 differentiating the area gives back the function'},
      {symbol:'f(t) = sin(t)',meaning:'The integrand \u2014 we evaluate it at the upper limit x'}
    ],
    why:{title:'The Fundamental Theorem of Calculus',
      paragraphs:[
        'The FTC says differentiation and integration are inverse operations. If you accumulate area under f(t) from 0 to x, the rate at which that area grows at x is exactly f(x).',
        'Think of it physically: if \u222B measures total distance, then d/dx of that total gives instantaneous speed = the original function.'
      ], geometric:'area-under'},
    connections:['FTC Part 2 connects this to evaluation: \u222B\u2090\u1D47 f = F(b)\u2212F(a)','With chain rule: d/dx[\u222B\u2080^(x\u00B2) f(t) dt] = f(x\u00B2)\u00B72x'],
    practice:{question:'Find d/dx [\u222B\u2080\u02E3 e^(t\u00B2) dt].',
      steps:['By FTC Part 1: d/dx[\u222B\u2080\u02E3 f(t) dt] = f(x)','f(t) = e^(t\u00B2), so f(x) = e^(x\u00B2)'],
      answer:'e^(x\u00B2)'},
    quote:'Derivatives and integrals: two sides of one coin!',
    wrongMsgs:['FTC says: differentiate the integral \u2192 get the integrand back at x.','Don\u2019t actually compute the integral! FTC gives the answer directly.','Just replace t with x in the integrand.']
  },

  /* ‚îÄ‚îÄ 19  Connections: Odd/Even ‚îÄ‚îÄ */
  { cat:'Connections', catIcon:'\uD83D\uDD17',
    q:'Is f(x) = x\u00B3 even, odd, or neither?', qDisplay:'f(x) = x\u00B3 \u2014 even, odd, or neither?',
    choices:['Odd','Even','Neither','Both'], correct:0,
    vars:[
      {symbol:'f(\u2212x) = \u2212f(x)',meaning:'Definition of an odd function \u2014 symmetric about the origin'},
      {symbol:'f(\u2212x) = f(x)',meaning:'Definition of an even function \u2014 symmetric about the y-axis'},
      {symbol:'x\u00B3',meaning:'A cubic \u2014 f(\u2212x) = (\u2212x)\u00B3 = \u2212x\u00B3 = \u2212f(x)'}
    ],
    why:{title:'Odd means origin-symmetric',
      paragraphs:[
        'Test: f(\u2212x) = (\u2212x)\u00B3 = \u2212x\u00B3 = \u2212f(x). Since f(\u2212x) = \u2212f(x) for all x, the function is odd.',
        'Visually: rotate the graph 180\u00B0 around the origin and it looks the same. Every point (a, a\u00B3) has a mirror (\u2212a, \u2212a\u00B3).'
      ], geometric:null},
    connections:['\u222B\u208B\u2090\u1D43 (odd function) dx = 0 \u2014 positive and negative areas cancel perfectly','All x\u207F with odd n are odd functions; even n gives even functions'],
    practice:{question:'Is f(x) = x\u2074 + x\u00B2 even, odd, or neither?',
      steps:['f(\u2212x) = (\u2212x)\u2074 + (\u2212x)\u00B2 = x\u2074 + x\u00B2','f(\u2212x) = f(x) \u2192 even!'],
      answer:'Even \u2014 symmetric about the y-axis'},
    quote:'Symmetry reveals deep structure!',
    wrongMsgs:['Check: does f(\u2212x) = \u2212f(x) or f(\u2212x) = f(x)?','(\u2212x)\u00B3 = \u2212x\u00B3. What does that tell you?','Odd: origin symmetry. Even: y-axis symmetry. Which fits?']
  },

  /* ‚îÄ‚îÄ 20  Quotient Rule ‚îÄ‚îÄ */
  { cat:'Core Derivatives', catIcon:'\u2702\uFE0F',
    q:'Find d/dx [x\u00B2 / e\u02E3]', qDisplay:'d/dx [x\u00B2 / e\u02E3] = ?',
    choices:['(2x \u2212 x\u00B2)/e\u02E3','2x/e\u02E3','x\u00B2/e\u02E3','(2x + x\u00B2)/e\u02E3'], correct:0,
    vars:[
      {symbol:'f/g',meaning:'A quotient of two functions'},
      {symbol:'(f\u2032g \u2212 fg\u2032)/g\u00B2',meaning:'Quotient rule formula'},
      {symbol:'d/dx[e\u02E3] = e\u02E3',meaning:'The denominator\u2019s derivative'}
    ],
    why:{title:'Quotient rule: low d-high minus high d-low over low squared',
      paragraphs:[
        'f = x\u00B2, g = e\u02E3. Then f\u2032 = 2x, g\u2032 = e\u02E3. Quotient rule: (2x\u00B7e\u02E3 \u2212 x\u00B2\u00B7e\u02E3)/(e\u02E3)\u00B2.',
        'Factor e\u02E3 from the numerator: e\u02E3(2x \u2212 x\u00B2)/(e\u02E3)\u00B2 = (2x \u2212 x\u00B2)/e\u02E3.'
      ], geometric:'slope-tangent'},
    connections:['Often easier to rewrite as x\u00B2\u00B7e^(\u2212x) and use the product rule instead','Quotient rule is derived from the product rule applied to f\u00B7(1/g)'],
    practice:{question:'Find d/dx [sin(x)/x].',
      steps:['f = sin(x), g = x, f\u2032 = cos(x), g\u2032 = 1','(cos(x)\u00B7x \u2212 sin(x)\u00B71)/x\u00B2','= (x cos(x) \u2212 sin(x))/x\u00B2'],
      answer:'(x cos(x) \u2212 sin(x))/x\u00B2'},
    quote:'Low d-high minus high d-low, draw the line and square below!',
    wrongMsgs:['Quotient rule: (f\u2032g \u2212 fg\u2032)/g\u00B2.','Don\u2019t forget to subtract fg\u2032 in the numerator.','Factor out e\u02E3 from the numerator to simplify.']
  },

  /* ‚îÄ‚îÄ 21  Inverse trig: d/dx[arctan(x)] ‚îÄ‚îÄ */
  { cat:'Trig Derivatives', catIcon:'\uD83D\uDCD0',
    q:'What is d/dx [arctan(x)]?', qDisplay:'d/dx [arctan(x)] = ?',
    choices:['1/(1+x\u00B2)','\u22121/(1+x\u00B2)','1/\u221A(1\u2212x\u00B2)','sec\u00B2(x)'], correct:0,
    vars:[
      {symbol:'arctan(x)',meaning:'Inverse tangent \u2014 returns the angle whose tangent is x'},
      {symbol:'1/(1+x\u00B2)',meaning:'Always positive, approaches 0 as |x| grows'},
      {symbol:'implicit diff',meaning:'If y = arctan(x), then tan(y) = x; differentiate both sides'}
    ],
    why:{title:'Deriving d/dx[arctan] via implicit differentiation',
      paragraphs:[
        'Let y = arctan(x), so tan(y) = x. Differentiate: sec\u00B2(y)\u00B7dy/dx = 1, so dy/dx = 1/sec\u00B2(y).',
        'Since sec\u00B2(y) = 1 + tan\u00B2(y) = 1 + x\u00B2, we get dy/dx = 1/(1 + x\u00B2). Beautiful!'
      ], geometric:'slope-tangent'},
    connections:['The integral version: \u222B 1/(1+x\u00B2) dx = arctan(x) + C','At x = 0, the slope is 1; as x \u2192 \u00B1\u221E, the slope \u2192 0 (horizontal asymptote of arctan)'],
    practice:{question:'Find d/dx[arctan(3x)] using the chain rule.',
      steps:['Outer: 1/(1+u\u00B2), inner: u = 3x','d/dx = 1/(1+(3x)\u00B2) \u00B7 3','= 3/(1+9x\u00B2)'],
      answer:'3/(1+9x\u00B2)'},
    quote:'Implicit differentiation reveals the hidden derivative!',
    wrongMsgs:['If y = arctan(x), then tan(y) = x. Differentiate implicitly.','sec\u00B2(y) = 1 + tan\u00B2(y) = 1 + x\u00B2.','The answer involves 1 + x\u00B2 in the denominator.']
  },

  /* ‚îÄ‚îÄ 22  Inverse trig: d/dx[arcsin(x)] ‚îÄ‚îÄ */
  { cat:'Trig Derivatives', catIcon:'\uD83D\uDCD0',
    q:'What is d/dx [arcsin(x)]?', qDisplay:'d/dx [arcsin(x)] = ?',
    choices:['1/\u221A(1\u2212x\u00B2)','\u22121/\u221A(1\u2212x\u00B2)','1/(1+x\u00B2)','1/(1\u2212x\u00B2)'], correct:0,
    vars:[
      {symbol:'arcsin(x)',meaning:'Inverse sine \u2014 returns the angle whose sine is x'},
      {symbol:'\u221A(1\u2212x\u00B2)',meaning:'Comes from cos(y) = \u221A(1\u2212sin\u00B2(y)) = \u221A(1\u2212x\u00B2)'},
      {symbol:'domain: [\u22121, 1]',meaning:'arcsin is only defined for inputs between \u22121 and 1'}
    ],
    why:{title:'Implicit differentiation for arcsin',
      paragraphs:[
        'Let y = arcsin(x), so sin(y) = x. Differentiate: cos(y)\u00B7dy/dx = 1, so dy/dx = 1/cos(y).',
        'Since cos(y) = \u221A(1 \u2212 sin\u00B2(y)) = \u221A(1 \u2212 x\u00B2), the derivative is 1/\u221A(1 \u2212 x\u00B2).'
      ], geometric:'unit-circle'},
    connections:['\u222B 1/\u221A(1\u2212x\u00B2) dx = arcsin(x) + C','Note the derivative blows up at x = \u00B11 \u2014 the curve becomes vertical there'],
    practice:{question:'Find d/dx[arcsin(x/2)].',
      steps:['Chain rule: 1/\u221A(1\u2212(x/2)\u00B2) \u00B7 (1/2)','= 1/(2\u221A(1\u2212x\u00B2/4))','= 1/\u221A(4\u2212x\u00B2)'],
      answer:'1/\u221A(4\u2212x\u00B2)'},
    quote:'The unit circle gives arcsin its derivative!',
    wrongMsgs:['If sin(y) = x, then cos(y) dy/dx = 1.','cos(y) = \u221A(1 \u2212 x\u00B2) from the Pythagorean identity.','The square root in the denominator is the key.']
  },

  /* ‚îÄ‚îÄ 23  d/dx[ln(x)] ‚îÄ‚îÄ */
  { cat:'Core Derivatives', catIcon:'\u2702\uFE0F',
    q:'What is d/dx [ln(x)]?', qDisplay:'d/dx [ln(x)] = ?',
    choices:['1/x','ln(x)/x','x\u00B7ln(x)','e\u02E3'], correct:0,
    vars:[
      {symbol:'ln(x)',meaning:'Natural logarithm \u2014 inverse of e\u02E3'},
      {symbol:'1/x',meaning:'The reciprocal function \u2014 decreases as x grows'},
      {symbol:'e^(ln(x)) = x',meaning:'ln and exp are inverses'}
    ],
    why:{title:'The natural log has the simplest derivative of any log',
      paragraphs:[
        'Since e^(ln(x)) = x, differentiate both sides: e^(ln(x)) \u00B7 d/dx[ln(x)] = 1. So d/dx[ln(x)] = 1/e^(ln(x)) = 1/x.',
        'This is why \u222B 1/x dx = ln|x| + C \u2014 the natural log fills the gap in the power rule (where n = \u22121 breaks).'
      ], geometric:'slope-tangent'},
    connections:['For other bases: d/dx[log_a(x)] = 1/(x\u00B7ln(a))','Chain rule: d/dx[ln(f(x))] = f\u2032(x)/f(x) \u2014 this is logarithmic differentiation'],
    practice:{question:'Find d/dx[ln(x\u00B3)].',
      steps:['ln(x\u00B3) = 3ln(x) by log rules','d/dx[3ln(x)] = 3/x'],
      answer:'3/x'},
    quote:'The reciprocal: simple but fundamental!',
    wrongMsgs:['ln(x) is the inverse of e\u02E3. Differentiate e^(ln(x)) = x implicitly.','The derivative gets smaller as x grows \u2014 which answer does that?','1/x is the only answer that makes \u222B 1/x dx = ln|x| + C work.']
  },

  /* ‚îÄ‚îÄ 24  Implicit differentiation ‚îÄ‚îÄ */
  { cat:'Chain Rule', catIcon:'\uD83D\uDD17',
    q:'If x\u00B2 + y\u00B2 = 25, find dy/dx', qDisplay:'x\u00B2 + y\u00B2 = 25, dy/dx = ?',
    choices:['\u2212x/y','x/y','\u22122x','y/x'], correct:0,
    vars:[
      {symbol:'x\u00B2 + y\u00B2 = 25',meaning:'Equation of a circle with radius 5'},
      {symbol:'dy/dx',meaning:'The slope of the circle at any point (x, y)'},
      {symbol:'implicit',meaning:'y is not isolated \u2014 differentiate both sides treating y as a function of x'}
    ],
    why:{title:'Implicit differentiation: y depends on x',
      paragraphs:[
        'Differentiate both sides: 2x + 2y\u00B7(dy/dx) = 0. The 2y\u00B7(dy/dx) comes from the chain rule \u2014 y is a function of x.',
        'Solve for dy/dx: dy/dx = \u22122x/(2y) = \u2212x/y. At (3,4) on the circle, the slope is \u22123/4.'
      ], geometric:'slope-tangent'},
    connections:['At the top of the circle (0,5), dy/dx = 0 \u2014 the tangent is horizontal','At (5,0), dy/dx is undefined \u2014 the tangent is vertical'],
    practice:{question:'Find dy/dx if x\u00B3 + y\u00B3 = 6xy.',
      steps:['3x\u00B2 + 3y\u00B2(dy/dx) = 6y + 6x(dy/dx)','3y\u00B2(dy/dx) \u2212 6x(dy/dx) = 6y \u2212 3x\u00B2','dy/dx = (6y \u2212 3x\u00B2)/(3y\u00B2 \u2212 6x)'],
      answer:'dy/dx = (6y \u2212 3x\u00B2)/(3y\u00B2 \u2212 6x)'},
    quote:'When you can\u2019t solve for y, differentiate implicitly!',
    wrongMsgs:['Differentiate y\u00B2 with chain rule: 2y\u00B7(dy/dx).','After differentiating, isolate dy/dx.','The minus sign comes from moving 2x to the other side.']
  },

  /* ‚îÄ‚îÄ 25  Integral: trig ‚îÄ‚îÄ */
  { cat:'Integrals', catIcon:'\u222B',
    q:'Evaluate \u222B cos\u00B2(x) dx', qDisplay:'\u222B cos\u00B2(x) dx = ?',
    choices:['x/2 + sin(2x)/4 + C','cos(x)sin(x) + C','sin\u00B2(x)/2 + C','cos\u00B3(x)/3 + C'], correct:0,
    vars:[
      {symbol:'cos\u00B2(x)',meaning:'Cosine squared \u2014 always between 0 and 1'},
      {symbol:'half-angle identity',meaning:'cos\u00B2(x) = (1 + cos(2x))/2'},
      {symbol:'sin(2x) = 2sin(x)cos(x)',meaning:'Double angle formula used in simplification'}
    ],
    why:{title:'Power-reduction makes trig integrals possible',
      paragraphs:[
        'Rewrite cos\u00B2(x) = (1 + cos(2x))/2 using the half-angle identity. Now integrate term by term:',
        '\u222B (1/2 + cos(2x)/2) dx = x/2 + sin(2x)/4 + C. The identity transforms a hard integral into two easy ones!'
      ], geometric:'area-under'},
    connections:['Similarly: \u222B sin\u00B2(x) dx = x/2 \u2212 sin(2x)/4 + C','Adding both: \u222B sin\u00B2 + cos\u00B2 dx = \u222B 1 dx = x. Check: x/2 + x/2 = x!'],
    practice:{question:'Evaluate \u222B sin\u00B2(x) dx.',
      steps:['sin\u00B2(x) = (1 \u2212 cos(2x))/2','\u222B (1/2 \u2212 cos(2x)/2) dx','= x/2 \u2212 sin(2x)/4 + C'],
      answer:'x/2 \u2212 sin(2x)/4 + C'},
    quote:'Half-angle identities are the key to trig integrals!',
    wrongMsgs:['You can\u2019t integrate cos\u00B2 directly \u2014 use the half-angle identity first.','cos\u00B2(x) = (1 + cos(2x))/2.','Integrate each piece: 1/2 \u2192 x/2, cos(2x)/2 \u2192 sin(2x)/4.']
  },

  /* ‚îÄ‚îÄ 26  Integral: 1/x ‚îÄ‚îÄ */
  { cat:'Integrals', catIcon:'\u222B',
    q:'Evaluate \u222B 1/x dx', qDisplay:'\u222B 1/x dx = ?',
    choices:['ln|x| + C','x\u207B\u00B9 + C','\u2212x\u207B\u00B2 + C','1 + C'], correct:0,
    vars:[
      {symbol:'1/x',meaning:'The reciprocal function \u2014 the one case the power rule can\u2019t handle'},
      {symbol:'ln|x|',meaning:'Natural log of the absolute value \u2014 defined for all x \u2260 0'},
      {symbol:'+ C',meaning:'Constant of integration'}
    ],
    why:{title:'The gap in the power rule',
      paragraphs:[
        'The power rule says \u222B x\u207F dx = x^(n+1)/(n+1) + C. But when n = \u22121, the denominator is 0!',
        'The natural log fills this gap: d/dx[ln|x|] = 1/x, so \u222B 1/x dx = ln|x| + C. The absolute value handles negative x.'
      ], geometric:'area-under'},
    connections:['This is why ln(x) appears so often in solutions','Related: \u222B f\u2032(x)/f(x) dx = ln|f(x)| + C'],
    practice:{question:'Evaluate \u222B 3/x dx.',
      steps:['Factor out the constant: 3\u222B 1/x dx','= 3ln|x| + C'],
      answer:'3ln|x| + C'},
    quote:'Where the power rule fails, the logarithm saves the day!',
    wrongMsgs:['The power rule breaks when n = \u22121. What function has derivative 1/x?','d/dx[ln|x|] = 1/x \u2014 so the antiderivative is\u2026','x\u207B\u00B9 IS 1/x. Its integral is ln|x|.']
  },

  /* ‚îÄ‚îÄ 27  Partial Fractions ‚îÄ‚îÄ */
  { cat:'Integrals', catIcon:'\u222B',
    q:'Evaluate \u222B 1/(x\u00B2\u22121) dx', qDisplay:'\u222B 1/(x\u00B2\u22121) dx = ?',
    choices:['(1/2)ln|(x\u22121)/(x+1)| + C','arctan(x) + C','ln|x\u00B2\u22121| + C','1/(2x) + C'], correct:0,
    vars:[
      {symbol:'x\u00B2\u22121 = (x\u22121)(x+1)',meaning:'Factor the denominator first'},
      {symbol:'partial fractions',meaning:'Split 1/((x\u22121)(x+1)) into A/(x\u22121) + B/(x+1)'},
      {symbol:'A = 1/2, B = \u22121/2',meaning:'Solve by plugging in x = 1 and x = \u22121'}
    ],
    why:{title:'Partial fractions decompose rational integrands',
      paragraphs:[
        '1/(x\u00B2\u22121) = 1/((x\u22121)(x+1)) = (1/2)/(x\u22121) + (\u22121/2)/(x+1). Now each piece integrates to a log!',
        '\u222B = (1/2)ln|x\u22121| \u2212 (1/2)ln|x+1| + C = (1/2)ln|(x\u22121)/(x+1)| + C.'
      ], geometric:'area-under'},
    connections:['Partial fractions work whenever the denominator factors','Alternative: the integral equals (1/2)arctanh(x) + C for |x| < 1'],
    practice:{question:'Decompose 1/(x(x+1)) into partial fractions.',
      steps:['1/(x(x+1)) = A/x + B/(x+1)','x=0: 1 = A(1), so A = 1','x=\u22121: 1 = B(\u22121), so B = \u22121'],
      answer:'1/x \u2212 1/(x+1)'},
    quote:'Factor, decompose, integrate \u2014 partial fractions!',
    wrongMsgs:['First factor x\u00B2\u22121 = (x\u22121)(x+1).','arctan(x) comes from 1/(1+x\u00B2), not 1/(x\u00B2\u22121).','Split into two simpler fractions, then integrate each.']
  },

  /* ‚îÄ‚îÄ 28  Taylor series ‚îÄ‚îÄ */
  { cat:'Series', catIcon:'\u03A3',
    q:'What is the Maclaurin series for e\u02E3?', qDisplay:'e\u02E3 = \u03A3 ? ',
    choices:['\u03A3 x\u207F/n! (n=0 to \u221E)','\u03A3 x\u207F (n=0 to \u221E)','\u03A3 nx\u207F (n=0 to \u221E)','\u03A3 (\u22121)\u207Fx\u207F/n!'], correct:0,
    vars:[
      {symbol:'n!',meaning:'n factorial = n\u00D7(n\u22121)\u00D7\u2026\u00D71'},
      {symbol:'Maclaurin',meaning:'Taylor series centered at x = 0'},
      {symbol:'x\u207F/n!',meaning:'Each term: x raised to the nth power divided by n factorial'}
    ],
    why:{title:'e\u02E3 is its own Taylor series',
      paragraphs:[
        'Since every derivative of e\u02E3 is e\u02E3, and e\u2070 = 1, the nth coefficient is f\u207F(0)/n! = 1/n!.',
        'So e\u02E3 = 1 + x + x\u00B2/2! + x\u00B3/3! + x\u2074/4! + \u2026 This series converges for ALL x.'
      ], geometric:null},
    connections:['At x = 1: e = 1 + 1 + 1/2 + 1/6 + 1/24 + \u2026 \u2248 2.71828','This is why e\u02E3 appears in probability, physics, and finance'],
    practice:{question:'Approximate e\u00B9 using 5 terms.',
      steps:['1 + 1 + 1/2 + 1/6 + 1/24','= 1 + 1 + 0.5 + 0.1667 + 0.0417','= 2.7083 (actual: 2.71828\u2026)'],
      answer:'e \u2248 2.7083 with 5 terms'},
    quote:'Infinite sums, finite beauty \u2014 that\u2019s Taylor series!',
    wrongMsgs:['Every derivative of e\u02E3 evaluated at 0 is 1.','The coefficient of x\u207F is 1/n!, not 1.','The alternating series (\u22121)\u207F is for sin or cos, not e\u02E3.']
  },

  /* ‚îÄ‚îÄ 29  Geometric series ‚îÄ‚îÄ */
  { cat:'Series', catIcon:'\u03A3',
    q:'What does \u03A3 (1/2)\u207F (n=0 to \u221E) converge to?', qDisplay:'\u03A3 (1/2)\u207F, n=0 to \u221E = ?',
    choices:['2','1','\u221E','1/2'], correct:0,
    vars:[
      {symbol:'geometric series',meaning:'\u03A3 r\u207F = 1/(1\u2212r) when |r| < 1'},
      {symbol:'r = 1/2',meaning:'The common ratio \u2014 each term is half the previous'},
      {symbol:'|r| < 1',meaning:'Convergence condition \u2014 the ratio must be less than 1 in absolute value'}
    ],
    why:{title:'Geometric series: the simplest infinite sum',
      paragraphs:[
        'With r = 1/2: S = 1/(1 \u2212 1/2) = 1/(1/2) = 2. The sum is finite even though we\u2019re adding infinitely many terms!',
        'Intuition: 1 + 1/2 + 1/4 + 1/8 + \u2026 Each step covers half the remaining distance to 2. You never overshoot.'
      ], geometric:null},
    connections:['Diverges when |r| \u2265 1: the harmonic series \u03A3 1/n diverges even though terms \u2192 0','This formula underlies present-value calculations in finance'],
    practice:{question:'Find \u03A3 (1/3)\u207F (n=0 to \u221E).',
      steps:['Geometric series with r = 1/3','S = 1/(1 \u2212 1/3) = 1/(2/3)','= 3/2'],
      answer:'3/2'},
    quote:'Half the distance, then half again \u2014 but it all adds up!',
    wrongMsgs:['Use the formula S = 1/(1\u2212r) for |r| < 1.','r = 1/2, so 1/(1\u22121/2) = ?','The sum is finite because each term shrinks by half.']
  },

  /* ‚îÄ‚îÄ 30  Convergence test ‚îÄ‚îÄ */
  { cat:'Series', catIcon:'\u03A3',
    q:'Does \u03A3 1/n (n=1 to \u221E) converge or diverge?', qDisplay:'\u03A3 1/n (n=1 to \u221E) = ?',
    choices:['Diverges','Converges to 1','Converges to 2','Converges to \u03C0'], correct:0,
    vars:[
      {symbol:'\u03A3 1/n',meaning:'The harmonic series \u2014 the most famous divergent series'},
      {symbol:'integral test',meaning:'\u222B\u2081^\u221E 1/x dx = \u221E, so the series diverges too'},
      {symbol:'p-series',meaning:'\u03A3 1/n^p converges when p > 1, diverges when p \u2264 1'}
    ],
    why:{title:'The harmonic series: terms \u2192 0 but the sum \u2192 \u221E',
      paragraphs:[
        'Group the terms: 1 + 1/2 + (1/3+1/4) + (1/5+1/6+1/7+1/8) + \u2026 Each group sums to at least 1/2.',
        'So the partial sums grow without bound: S > 1 + 1/2 + 1/2 + 1/2 + \u2026 = \u221E. Terms going to 0 is necessary but NOT sufficient for convergence!'
      ], geometric:null},
    connections:['Compare: \u03A3 1/n\u00B2 converges to \u03C0\u00B2/6 (Euler\u2019s famous result)','The harmonic series grows like ln(n) \u2014 extremely slowly'],
    practice:{question:'Does \u03A3 1/n\u00B2 converge or diverge?',
      steps:['p-series with p = 2 > 1','Converges!','(In fact, to \u03C0\u00B2/6 \u2248 1.6449)'],
      answer:'Converges to \u03C0\u00B2/6'},
    quote:'Going to zero isn\u2019t enough \u2014 you need to go FAST enough!',
    wrongMsgs:['Even though 1/n \u2192 0, the sum itself grows without bound.','Group terms to show each group adds at least 1/2.','This is the harmonic series \u2014 the classic example of slow divergence.']
  },

  /* ‚îÄ‚îÄ 31  Partial derivatives ‚îÄ‚îÄ */
  { cat:'Multivariable Calculus', catIcon:'\u2207',
    q:'If f(x,y) = x\u00B2y + y\u00B3, find \u2202f/\u2202x', qDisplay:'\u2202f/\u2202x of x\u00B2y + y\u00B3 = ?',
    choices:['2xy','x\u00B2 + 3y\u00B2','2x + 3y\u00B2','2xy + 3y\u00B2'], correct:0,
    vars:[
      {symbol:'\u2202f/\u2202x',meaning:'Partial derivative \u2014 differentiate with respect to x, treating y as a constant'},
      {symbol:'x\u00B2y',meaning:'Differentiate: y is a constant, so d/dx[x\u00B2y] = 2xy'},
      {symbol:'y\u00B3',meaning:'Pure y-term \u2014 its partial derivative with respect to x is 0'}
    ],
    why:{title:'Partial derivatives: one variable at a time',
      paragraphs:[
        'When taking \u2202f/\u2202x, treat y as a constant. d/dx[x\u00B2y] = 2xy (y is just a coefficient). d/dx[y\u00B3] = 0 (constant).',
        'In GR, the metric g_{\u03BC\u03BD} depends on spacetime coordinates x\u00B0,x\u00B9,x\u00B2,x\u00B3. Partial derivatives of the metric appear in the Christoffel symbols.'
      ], geometric:'slope-tangent'},
    connections:['\u2202f/\u2202y = x\u00B2 + 3y\u00B2 \u2014 now x is treated as constant','The gradient \u2207f = (\u2202f/\u2202x, \u2202f/\u2202y) gives the direction of steepest ascent'],
    practice:{question:'Find \u2202f/\u2202y for f(x,y) = x\u00B2y + y\u00B3.',
      steps:['Treat x as constant','d/dy[x\u00B2y] = x\u00B2','d/dy[y\u00B3] = 3y\u00B2'],
      answer:'\u2202f/\u2202y = x\u00B2 + 3y\u00B2'},
    quote:'Hold one variable still, differentiate the other!',
    wrongMsgs:['When finding \u2202f/\u2202x, y is a constant.','d/dx[y\u00B3] = 0 because y is constant with respect to x.','Only differentiate the x parts: x\u00B2y \u2192 2xy.']
  },

  /* ‚îÄ‚îÄ 32  Second partial / mixed partials ‚îÄ‚îÄ */
  { cat:'Multivariable Calculus', catIcon:'\u2207',
    q:'If f(x,y) = x\u00B3y\u00B2, find \u2202\u00B2f/\u2202x\u2202y', qDisplay:'\u2202\u00B2f/\u2202x\u2202y of x\u00B3y\u00B2 = ?',
    choices:['6x\u00B2y','3x\u00B2y\u00B2','2x\u00B3y','6x\u00B2y\u00B2'], correct:0,
    vars:[
      {symbol:'\u2202\u00B2f/\u2202x\u2202y',meaning:'Mixed partial: first differentiate w.r.t. y, then w.r.t. x'},
      {symbol:'Clairaut\u2019s theorem',meaning:'If mixed partials are continuous, \u2202\u00B2f/\u2202x\u2202y = \u2202\u00B2f/\u2202y\u2202x'},
      {symbol:'order doesn\u2019t matter',meaning:'For smooth functions, you can differentiate in either order'}
    ],
    why:{title:'Mixed partial derivatives and Clairaut\u2019s theorem',
      paragraphs:[
        'First: \u2202f/\u2202y = 2x\u00B3y. Then: \u2202/\u2202x[2x\u00B3y] = 6x\u00B2y.',
        'Clairaut\u2019s theorem guarantees the other order gives the same result: \u2202f/\u2202x = 3x\u00B2y\u00B2, then \u2202/\u2202y[3x\u00B2y\u00B2] = 6x\u00B2y. This symmetry is essential in GR \u2014 the metric tensor is symmetric!'
      ], geometric:null},
    connections:['In GR: \u2202_\u03BC \u2202_\u03BD g_{\u03B1\u03B2} appears in the Riemann curvature tensor','Symmetry of mixed partials ensures consistency of the Christoffel symbols'],
    practice:{question:'Find both mixed partials of f = x\u00B2y\u00B3 and verify they\u2019re equal.',
      steps:['\u2202f/\u2202x = 2xy\u00B3, then \u2202/\u2202y = 6xy\u00B2','\u2202f/\u2202y = 3x\u00B2y\u00B2, then \u2202/\u2202x = 6xy\u00B2','Both give 6xy\u00B2 \u2714'],
      answer:'\u2202\u00B2f/\u2202x\u2202y = \u2202\u00B2f/\u2202y\u2202x = 6xy\u00B2'},
    quote:'Symmetry of mixed partials: the universe plays fair!',
    wrongMsgs:['First find \u2202f/\u2202y = 2x\u00B3y, then differentiate that w.r.t. x.','Don\u2019t multiply the exponents \u2014 differentiate step by step.','The answer should have both x and y in it.']
  },

  /* ‚îÄ‚îÄ 33  Gradient ‚îÄ‚îÄ */
  { cat:'Multivariable Calculus', catIcon:'\u2207',
    q:'Find \u2207f if f(x,y,z) = x\u00B2 + yz', qDisplay:'\u2207f of x\u00B2 + yz = ?',
    choices:['(2x, z, y)','(2x, y, z)','(x\u00B2, yz, 0)','(2, 1, 1)'], correct:0,
    vars:[
      {symbol:'\u2207f',meaning:'Gradient \u2014 vector of all partial derivatives'},
      {symbol:'(\u2202f/\u2202x, \u2202f/\u2202y, \u2202f/\u2202z)',meaning:'Components of the gradient vector'},
      {symbol:'direction of steepest ascent',meaning:'The gradient points where f increases fastest'}
    ],
    why:{title:'The gradient collects all partial derivatives into a vector',
      paragraphs:[
        '\u2202f/\u2202x = 2x, \u2202f/\u2202y = z, \u2202f/\u2202z = y. So \u2207f = (2x, z, y).',
        'In GR, the gradient of a scalar field \u03C6 gives a covector (one-form): \u2202_\u03BC \u03C6. This is the simplest tensor operation and the building block for everything else.'
      ], geometric:'slope-tangent'},
    connections:['|\u2207f| gives the maximum rate of change of f','In GR: \u2202_\u03BC \u03C6 transforms as a covector under coordinate changes'],
    practice:{question:'Find \u2207f if f = xyz.',
      steps:['\u2202f/\u2202x = yz','\u2202f/\u2202y = xz','\u2202f/\u2202z = xy'],
      answer:'\u2207f = (yz, xz, xy)'},
    quote:'The gradient: nature\u2019s GPS for steepest ascent!',
    wrongMsgs:['Take each partial derivative separately.','When differentiating w.r.t. x, both y and z are constants.','\u2202/\u2202y of yz is z (y is the variable, z is constant).']
  },

  /* ‚îÄ‚îÄ 34  Matrix multiplication ‚îÄ‚îÄ */
  { cat:'Linear Algebra', catIcon:'\uD83D\uDCCA',
    q:'Compute [[1,2],[3,4]] \u00B7 [[5],[6]]', qDisplay:'[[1,2],[3,4]] \u00B7 [[5],[6]] = ?',
    choices:['[[17],[39]]','[[11],[34]]','[[17],[34]]','[[11],[39]]'], correct:0,
    vars:[
      {symbol:'A\u00B7B',meaning:'Matrix multiplication \u2014 rows of A dot columns of B'},
      {symbol:'(AB)\u1D62\u2C7C = \u03A3 A\u1D62\u2096 B\u2096\u2C7C',meaning:'Each entry is a dot product of a row and a column'},
      {symbol:'(m\u00D7n)(n\u00D7p) = m\u00D7p',meaning:'Dimensions: inner dimensions must match'}
    ],
    why:{title:'Matrix multiplication: dot products organized in a grid',
      paragraphs:[
        'Row 1: [1,2]\u00B7[5,6] = 1\u00D75 + 2\u00D76 = 5 + 12 = 17. Row 2: [3,4]\u00B7[5,6] = 3\u00D75 + 4\u00D76 = 15 + 24 = 39.',
        'In GR, matrix multiplication represents tensor contraction: g^{\u03BC\u03B1}g_{\u03B1\u03BD} = \u03B4^\u03BC_\u03BD. The metric times its inverse gives the identity!'
      ], geometric:null},
    connections:['Matrix multiplication is NOT commutative: AB \u2260 BA in general','In GR, index contraction (summing over repeated indices) is matrix multiplication in disguise'],
    practice:{question:'Compute [[1,0],[0,\u22121]] \u00B7 [[3],[7]].',
      steps:['Row 1: 1\u00D73 + 0\u00D77 = 3','Row 2: 0\u00D73 + (\u22121)\u00D77 = \u22127'],
      answer:'[[3],[\u22127]]'},
    quote:'Row dot column \u2014 that\u2019s the recipe!',
    wrongMsgs:['Multiply row 1 of the left matrix by the column on the right.','1\u00D75 + 2\u00D76 = 5 + 12 = 17.','3\u00D75 + 4\u00D76 = 15 + 24 = 39.']
  },

  /* ‚îÄ‚îÄ 35  Matrix inverse 2x2 ‚îÄ‚îÄ */
  { cat:'Linear Algebra', catIcon:'\uD83D\uDCCA',
    q:'Find the inverse of A = [[2,1],[5,3]]', qDisplay:'A\u207B\u00B9 of [[2,1],[5,3]] = ?',
    choices:['[[3,\u22121],[\u22125,2]]','[[3,1],[\u22125,2]]','[[2,\u22121],[\u22125,3]]','[[3,\u22121],[5,\u22122]]'], correct:0,
    vars:[
      {symbol:'A\u207B\u00B9',meaning:'The inverse \u2014 A\u00B7A\u207B\u00B9 = I (identity matrix)'},
      {symbol:'1/det(A)',meaning:'Scale factor: 1/(ad\u2212bc) = 1/(6\u22125) = 1'},
      {symbol:'swap and negate',meaning:'Swap a,d; negate b,c; then divide by det'}
    ],
    why:{title:'2\u00D72 inverse: swap, negate, scale',
      paragraphs:[
        'For [[a,b],[c,d]], the inverse is (1/det) \u00B7 [[d,\u2212b],[\u2212c,a]]. Here det = 2\u00D73 \u2212 1\u00D75 = 1.',
        'So A\u207B\u00B9 = [[3,\u22121],[\u22125,2]]. Check: [[2,1],[5,3]]\u00B7[[3,\u22121],[\u22125,2]] = [[1,0],[0,1]]. In GR, the inverse metric g^{\u03BC\u03BD} is used to raise indices.'
      ], geometric:null},
    connections:['The metric tensor g_{\u03BC\u03BD} and its inverse g^{\u03BC\u03BD} satisfy g^{\u03BC\u03B1}g_{\u03B1\u03BD} = \u03B4^{\u03BC}_{\u03BD}','det = 1 means this matrix preserves area (volume in higher dimensions)'],
    practice:{question:'Find the inverse of [[1,2],[3,7]].',
      steps:['det = 1\u00D77 \u2212 2\u00D73 = 7 \u2212 6 = 1','A\u207B\u00B9 = [[7,\u22122],[\u22123,1]]'],
      answer:'[[7,\u22122],[\u22123,1]]'},
    quote:'Swap the diagonals, flip the signs \u2014 that\u2019s the 2\u00D72 inverse!',
    wrongMsgs:['Formula: (1/det)[[d,\u2212b],[\u2212c,a]] for [[a,b],[c,d]].','det = 2\u00D73 \u2212 1\u00D75 = 1, so no scaling needed.','Swap the diagonal entries (2 and 3), negate the off-diagonals (1 and 5).']
  },

  /* ‚îÄ‚îÄ 36  Einstein summation / index notation ‚îÄ‚îÄ */
  { cat:'Tensor Calculus', catIcon:'\uD83E\uDDF2',
    q:'In Einstein notation, what does A\u1D62\u2C7CB\u2C7C\u2096 represent?', qDisplay:'A\u1D62\u2C7CB\u2C7C\u2096 (summing over j) = ?',
    choices:['Matrix product (AB)\u1D62\u2096','Dot product A\u00B7B','Outer product','Element-wise product'], correct:0,
    vars:[
      {symbol:'Einstein convention',meaning:'Repeated indices (one up, one down) are summed over automatically'},
      {symbol:'A\u1D62\u2C7CB\u2C7C\u2096',meaning:'\u03A3\u2C7C A\u1D62\u2C7CB\u2C7C\u2096 \u2014 the j index is summed over'},
      {symbol:'contraction',meaning:'Summing over a repeated index reduces the total number of free indices'}
    ],
    why:{title:'Einstein\u2019s summation convention eliminates \u03A3 signs',
      paragraphs:[
        'Instead of writing \u03A3\u2C7C A\u1D62\u2C7CB\u2C7C\u2096, Einstein\u2019s convention says: any index that appears twice (once up, once down) is automatically summed.',
        'A\u1D62\u2C7CB\u2C7C\u2096 = \u03A3\u2C7C A\u1D62\u2C7CB\u2C7C\u2096 = (AB)\u1D62\u2096. This is literally matrix multiplication! Every equation in GR uses this convention.'
      ], geometric:null},
    connections:['g_{\u03BC\u03BD}x^\u03BD = x_\u03BC \u2014 the metric lowers an index by contracting','T^{\u03BC\u03BD}_{;\u03BD} = 0 (energy-momentum conservation) uses this convention throughout'],
    practice:{question:'What does \u03B4\u1D62\u2C7CA\u2C7C\u2096 simplify to?',
      steps:['\u03B4\u1D62\u2C7C is the Kronecker delta: 1 if i=j, 0 otherwise','Summing over j picks out the j=i term','= A\u1D62\u2096'],
      answer:'\u03B4\u1D62\u2C7CA\u2C7C\u2096 = A\u1D62\u2096'},
    quote:'Einstein\u2019s laziest and most brilliant invention!',
    wrongMsgs:['When an index appears twice, sum over it.','This is the same as row-times-column matrix multiplication.','j is the summed (dummy) index; i and k are free indices.']
  },

  /* ‚îÄ‚îÄ 37  Metric tensor basics ‚îÄ‚îÄ */
  { cat:'Tensor Calculus', catIcon:'\uD83E\uDDF2',
    q:'For flat 2D space with metric ds\u00B2 = dx\u00B2 + dy\u00B2, what is g\u2081\u2082?', qDisplay:'g\u2081\u2082 for ds\u00B2 = dx\u00B2 + dy\u00B2 = ?',
    choices:['0','1','dx\u00B7dy','\u22121'], correct:0,
    vars:[
      {symbol:'g_{\u03BC\u03BD}',meaning:'Metric tensor \u2014 tells you how to measure distances'},
      {symbol:'ds\u00B2 = g_{\u03BC\u03BD}dx^\u03BCdx^\u03BD',meaning:'The line element: distance formula in curved space'},
      {symbol:'g = [[1,0],[0,1]]',meaning:'For flat Cartesian space, the metric is the identity matrix'}
    ],
    why:{title:'The metric tensor encodes geometry',
      paragraphs:[
        'ds\u00B2 = dx\u00B2 + dy\u00B2 = g\u2081\u2081dx\u00B2 + 2g\u2081\u2082dxdy + g\u2082\u2082dy\u00B2. Matching terms: g\u2081\u2081 = 1, g\u2082\u2082 = 1, and g\u2081\u2082 = 0.',
        'The zero off-diagonal means x and y are orthogonal. In curved space (like the Schwarzschild metric), these entries become functions of position!'
      ], geometric:null},
    connections:['In polar coordinates: ds\u00B2 = dr\u00B2 + r\u00B2d\u03B8\u00B2, so g_{\u03B8\u03B8} = r\u00B2','The metric is the fundamental object in GR \u2014 everything else derives from it'],
    practice:{question:'Write the metric tensor for ds\u00B2 = dr\u00B2 + r\u00B2d\u03B8\u00B2.',
      steps:['g_{rr} = 1, g_{\u03B8\u03B8} = r\u00B2','g_{r\u03B8} = g_{\u03B8r} = 0','g = [[1, 0],[0, r\u00B2]]'],
      answer:'g = diag(1, r\u00B2)'},
    quote:'The metric IS geometry \u2014 distances, angles, curvature, all in one tensor!',
    wrongMsgs:['Match coefficients: ds\u00B2 = g_{\u03BC\u03BD}dx^\u03BCdx^\u03BD.','There\u2019s no dxdy cross term, so g\u2081\u2082 = 0.','The metric for flat Cartesian space is just the identity matrix.']
  },

  /* ‚îÄ‚îÄ 38  Christoffel symbols concept ‚îÄ‚îÄ */
  { cat:'Tensor Calculus', catIcon:'\uD83E\uDDF2',
    q:'Christoffel symbols \u0393^\u03BB_{\u03BC\u03BD} are computed from what?', qDisplay:'\u0393^\u03BB_{\u03BC\u03BD} are derived from?',
    choices:['Derivatives of the metric g_{\u03BC\u03BD}','The stress-energy tensor','The Ricci scalar','The cosmological constant'], correct:0,
    vars:[
      {symbol:'\u0393^\u03BB_{\u03BC\u03BD}',meaning:'Christoffel symbols \u2014 encode how basis vectors change from point to point'},
      {symbol:'g_{\u03BC\u03BD}',meaning:'The metric tensor \u2014 the source of the Christoffel symbols'},
      {symbol:'\u0393 = \u00BD g^{\u03BB\u03C3}(\u2202g + \u2202g \u2212 \u2202g)',meaning:'Formula involves first derivatives of the metric'}
    ],
    why:{title:'Christoffel symbols: how coordinates curve',
      paragraphs:[
        '\u0393^\u03BB_{\u03BC\u03BD} = \u00BD g^{\u03BB\u03C3}(\u2202_\u03BC g_{\u03BD\u03C3} + \u2202_\u03BD g_{\u03C3\u03BC} \u2212 \u2202_\u03C3 g_{\u03BC\u03BD}). They\u2019re built entirely from the metric and its first partial derivatives.',
        'They\u2019re NOT tensors themselves (they vanish in locally flat coordinates), but they\u2019re essential for defining covariant derivatives and the geodesic equation.'
      ], geometric:null},
    connections:['In flat Cartesian coordinates, all \u0393 = 0','In polar coordinates, \u0393^r_{\u03B8\u03B8} = \u2212r captures centripetal acceleration','They appear in the geodesic equation: d\u00B2x^\u03BB/d\u03C4\u00B2 + \u0393^\u03BB_{\u03BC\u03BD} dx^\u03BC/d\u03C4 dx^\u03BD/d\u03C4 = 0'],
    practice:{question:'In polar coordinates (ds\u00B2 = dr\u00B2 + r\u00B2d\u03B8\u00B2), what is \u0393^r_{\u03B8\u03B8}?',
      steps:['g_{rr}=1, g_{\u03B8\u03B8}=r\u00B2, g^{rr}=1','\u0393^r_{\u03B8\u03B8} = \u00BD g^{rr}(\u2212\u2202_r g_{\u03B8\u03B8}) = \u00BD(1)(\u22122r)','= \u2212r'],
      answer:'\u0393^r_{\u03B8\u03B8} = \u2212r'},
    quote:'The Christoffel symbols are the GPS of curved spacetime!',
    wrongMsgs:['Christoffel symbols come from derivatives of the metric \u2014 not from T_{\u03BC\u03BD}.','The formula involves g and \u2202g \u2014 first derivatives of the metric.','They encode how coordinate basis vectors rotate and stretch.']
  },

  /* ‚îÄ‚îÄ 39  Covariant derivative concept ‚îÄ‚îÄ */
  { cat:'Tensor Calculus', catIcon:'\uD83E\uDDF2',
    q:'The covariant derivative \u2207_\u03BC V^\u03BD adds what correction term?', qDisplay:'\u2207_\u03BC V^\u03BD = \u2202_\u03BC V^\u03BD + ?',
    choices:['\u0393^\u03BD_{\u03BC\u03BB} V^\u03BB','\u2212\u0393^\u03BD_{\u03BC\u03BB} V^\u03BB','g_{\u03BC\u03BD} V^\u03BB','R^\u03BD_{\u03BC\u03BB\u03C3} V^\u03BB'], correct:0,
    vars:[
      {symbol:'\u2207_\u03BC',meaning:'Covariant derivative \u2014 the \u201Cproper\u201D derivative that works in curved space'},
      {symbol:'\u2202_\u03BC V^\u03BD',meaning:'Ordinary partial derivative \u2014 not a tensor by itself'},
      {symbol:'\u0393^\u03BD_{\u03BC\u03BB} V^\u03BB',meaning:'Christoffel correction that makes the derivative a tensor'}
    ],
    why:{title:'Why partial derivatives aren\u2019t enough in curved space',
      paragraphs:[
        'In curved space, partial derivatives of vectors don\u2019t transform properly under coordinate changes. The Christoffel symbols fix this.',
        '\u2207_\u03BC V^\u03BD = \u2202_\u03BC V^\u03BD + \u0393^\u03BD_{\u03BC\u03BB} V^\u03BB. The + sign is for upper indices; lower indices get a minus sign. This is the foundation of all GR calculations.'
      ], geometric:null},
    connections:['For covectors: \u2207_\u03BC V_\u03BD = \u2202_\u03BC V_\u03BD \u2212 \u0393^\u03BB_{\u03BC\u03BD} V_\u03BB (note the minus!)','The metric is covariantly constant: \u2207_\u03BB g_{\u03BC\u03BD} = 0 (metric compatibility)'],
    practice:{question:'What is \u2207_\u03BC g_{\u03B1\u03B2}?',
      steps:['The Levi-Civita connection is metric-compatible','This means \u2207_\u03BC g_{\u03B1\u03B2} = 0 identically','This is a DEFINITION: we chose \u0393 to make this true'],
      answer:'\u2207_\u03BC g_{\u03B1\u03B2} = 0'},
    quote:'Curved space needs curved derivatives!',
    wrongMsgs:['The correction involves Christoffel symbols \u0393, not the Riemann tensor.','For an upper index, the Christoffel term is added with a + sign.','This correction makes the derivative transform as a tensor.']
  },

  /* ‚îÄ‚îÄ 40  Riemann curvature tensor ‚îÄ‚îÄ */
  { cat:'Tensor Calculus', catIcon:'\uD83E\uDDF2',
    q:'The Riemann tensor R^\u03C1_{\u03C3\u03BC\u03BD} measures what?', qDisplay:'R^\u03C1_{\u03C3\u03BC\u03BD} measures?',
    choices:['Spacetime curvature','Energy density','Expansion rate','Gravitational potential'], correct:0,
    vars:[
      {symbol:'R^\u03C1_{\u03C3\u03BC\u03BD}',meaning:'Riemann curvature tensor \u2014 4 indices capturing all curvature information'},
      {symbol:'parallel transport',meaning:'Moving a vector around a closed loop; if it comes back changed, space is curved'},
      {symbol:'\u2202\u0393 \u2212 \u2202\u0393 + \u0393\u0393 \u2212 \u0393\u0393',meaning:'Built from Christoffel symbols and their derivatives'}
    ],
    why:{title:'Riemann tensor: the complete measure of curvature',
      paragraphs:[
        'R^\u03C1_{\u03C3\u03BC\u03BD} = \u2202_\u03BC \u0393^\u03C1_{\u03BD\u03C3} \u2212 \u2202_\u03BD \u0393^\u03C1_{\u03BC\u03C3} + \u0393^\u03C1_{\u03BC\u03BB}\u0393^\u03BB_{\u03BD\u03C3} \u2212 \u0393^\u03C1_{\u03BD\u03BB}\u0393^\u03BB_{\u03BC\u03C3}.',
        'If you parallel-transport a vector around a tiny loop, the Riemann tensor tells you how much it rotates. If R = 0 everywhere, space is flat!'
      ], geometric:null},
    connections:['Contract to get Ricci tensor: R_{\u03BC\u03BD} = R^\u03BB_{\u03BC\u03BB\u03BD}','Contract again for Ricci scalar: R = g^{\u03BC\u03BD}R_{\u03BC\u03BD}','These appear directly in Einstein\u2019s field equations!'],
    practice:{question:'How many independent components does R^\u03C1_{\u03C3\u03BC\u03BD} have in 4D?',
      steps:['Na\u00EFve count: 4\u2074 = 256 components','Symmetries reduce this dramatically','Bianchi + index symmetries \u2192 20 independent components'],
      answer:'20 independent components in 4D'},
    quote:'Curvature is the soul of gravity!',
    wrongMsgs:['The Riemann tensor measures intrinsic curvature of spacetime.','Energy density is T_{\u03BC\u03BD} \u2014 the stress-energy tensor.','Expansion rate is the Hubble parameter, not the Riemann tensor.']
  },

  /* ‚îÄ‚îÄ 41  Ricci tensor ‚îÄ‚îÄ */
  { cat:'Tensor Calculus', catIcon:'\uD83E\uDDF2',
    q:'How is the Ricci tensor R_{\u03BC\u03BD} obtained from the Riemann tensor?', qDisplay:'R_{\u03BC\u03BD} = ?',
    choices:['R^\u03BB_{\u03BC\u03BB\u03BD} (contraction)','R_{\u03BC\u03BD\u03BB\u03C3}g^{\u03BB\u03C3}','\u2202_\u03BC R_\u03BD','g_{\u03BC\u03BD}R'], correct:0,
    vars:[
      {symbol:'R_{\u03BC\u03BD}',meaning:'Ricci tensor \u2014 a contraction of the Riemann tensor'},
      {symbol:'contraction',meaning:'Setting two indices equal and summing \u2014 reduces rank by 2'},
      {symbol:'R^\u03BB_{\u03BC\u03BB\u03BD}',meaning:'Sum over \u03BB: collapse the 4-index tensor to 2 indices'}
    ],
    why:{title:'Contraction: simplifying the Riemann tensor',
      paragraphs:[
        'The Riemann tensor has 4 indices. To get Einstein\u2019s equations, we need a 2-index object. Contracting the first and third indices gives the Ricci tensor.',
        'R_{\u03BC\u03BD} = R^\u03BB_{\u03BC\u03BB\u03BD} = \u03A3_\u03BB R^\u03BB_{\u03BC\u03BB\u03BD}. This captures how volumes change due to curvature \u2014 matter causes volume focusing.'
      ], geometric:null},
    connections:['R_{\u03BC\u03BD} is symmetric: R_{\u03BC\u03BD} = R_{\u03BD\u03BC}','One more contraction gives the Ricci scalar: R = g^{\u03BC\u03BD}R_{\u03BC\u03BD}','Einstein\u2019s equation: R_{\u03BC\u03BD} \u2212 \u00BDg_{\u03BC\u03BD}R = 8\u03C0G T_{\u03BC\u03BD}'],
    practice:{question:'If R_{\u03BC\u03BD} = 0 everywhere, what does that mean physically?',
      steps:['R_{\u03BC\u03BD} = 0 is the vacuum Einstein equation','No matter/energy present','But spacetime can still be curved! (e.g., gravitational waves, Schwarzschild exterior)'],
      answer:'Vacuum spacetime \u2014 curved but matter-free'},
    quote:'From 256 components down to 10 \u2014 that\u2019s the power of contraction!',
    wrongMsgs:['Contraction means summing over a repeated index.','Set the first and third indices equal: R^\u03BB_{\u03BC\u03BB\u03BD}.','This reduces the 4-index Riemann down to 2 indices.']
  },

  /* ‚îÄ‚îÄ 42  Trace and matrix ‚îÄ‚îÄ */
  { cat:'Linear Algebra', catIcon:'\uD83D\uDCCA',
    q:'What is the trace of A = [[3,1,2],[0,5,1],[0,0,7]]?', qDisplay:'tr(A) = ? for [[3,1,2],[0,5,1],[0,0,7]]',
    choices:['15','8','21','35'], correct:0,
    vars:[
      {symbol:'tr(A)',meaning:'Trace \u2014 sum of diagonal entries'},
      {symbol:'\u03A3 a_{ii}',meaning:'Add up a\u2081\u2081 + a\u2082\u2082 + a\u2083\u2083'},
      {symbol:'tr(A) = \u03A3 \u03BB\u1D62',meaning:'Trace equals the sum of eigenvalues'}
    ],
    why:{title:'The trace: simplest invariant of a matrix',
      paragraphs:[
        'tr(A) = 3 + 5 + 7 = 15. Just add the diagonal entries.',
        'The trace is coordinate-independent: it\u2019s the same no matter what basis you use. In GR, g^{\u03BC\u03BD}R_{\u03BC\u03BD} = R (the Ricci scalar) is a trace operation!'
      ], geometric:null},
    connections:['tr(AB) = tr(BA) even though AB \u2260 BA','Contraction in index notation: A^\u03BC_\u03BC = tr(A)','For this triangular matrix, eigenvalues = diagonal entries = {3,5,7}'],
    practice:{question:'Find the trace and determinant of [[2,0],[0,\u22123]].',
      steps:['tr = 2 + (\u22123) = \u22121','det = 2\u00D7(\u22123) \u2212 0\u00D70 = \u22126'],
      answer:'tr = \u22121, det = \u22126'},
    quote:'Sum the diagonal \u2014 the trace is as simple as it gets!',
    wrongMsgs:['Trace = sum of diagonal entries only.','3 + 5 + 7 = ?','Don\u2019t include off-diagonal entries in the trace.']
  },

  /* ‚îÄ‚îÄ 43  Linear independence ‚îÄ‚îÄ */
  { cat:'Linear Algebra', catIcon:'\uD83D\uDCCA',
    q:'Are v\u2081 = [1,2] and v\u2082 = [2,4] linearly independent?', qDisplay:'[1,2] and [2,4] \u2014 independent?',
    choices:['No (dependent)','Yes (independent)','Can\u2019t determine','Only if scaled'], correct:0,
    vars:[
      {symbol:'linearly independent',meaning:'No vector can be written as a scalar multiple/combination of the others'},
      {symbol:'v\u2082 = 2v\u2081',meaning:'[2,4] = 2\u00D7[1,2] \u2014 one is a scalar multiple of the other'},
      {symbol:'det = 0',meaning:'The matrix [[1,2],[2,4]] has determinant 0 \u2014 singular'}
    ],
    why:{title:'Parallel vectors are always dependent',
      paragraphs:[
        '[2,4] = 2\u00D7[1,2], so v\u2082 is just a scaled version of v\u2081. They point in the same direction and are linearly dependent.',
        'Equivalently, det([[1,2],[2,4]]) = 1\u00D74 \u2212 2\u00D72 = 0. A zero determinant always means dependence.'
      ], geometric:null},
    connections:['In GR, linearly independent vectors form a basis for the tangent space','4 linearly independent vectors span 4D spacetime at each point'],
    practice:{question:'Are [1,0,0], [0,1,0], [0,0,1] linearly independent?',
      steps:['The identity matrix: det = 1 \u2260 0','No vector is a combination of the others','Yes, they\u2019re independent \u2014 they form the standard basis'],
      answer:'Yes \u2014 they are the standard basis for R\u00B3'},
    quote:'If det = 0, the vectors are telling you the same story twice!',
    wrongMsgs:['Check: is one vector a scalar multiple of the other?','[2,4] = 2 \u00D7 [1,2] \u2014 that\u2019s a clear dependency.','det = 1\u00D74 \u2212 2\u00D72 = 0 confirms dependence.']
  },

  /* ‚îÄ‚îÄ 44  Change of basis / coordinate transformation ‚îÄ‚îÄ */
  { cat:'Linear Algebra', catIcon:'\uD83D\uDCCA',
    q:'If A\u2032 = P\u207B\u00B9AP, what is this operation called?', qDisplay:'A\u2032 = P\u207B\u00B9AP is called?',
    choices:['Similarity transformation','Transpose','Inverse','Eigendecomposition'], correct:0,
    vars:[
      {symbol:'P\u207B\u00B9AP',meaning:'Expresses matrix A in a new basis defined by columns of P'},
      {symbol:'similarity',meaning:'A and A\u2032 represent the SAME linear map in different coordinates'},
      {symbol:'invariants',meaning:'tr(A) = tr(A\u2032), det(A) = det(A\u2032), eigenvalues are preserved'}
    ],
    why:{title:'Same transformation, different coordinates',
      paragraphs:[
        'A similarity transformation changes the basis (coordinate system) but NOT the underlying linear map. It\u2019s like describing the same vector in Cartesian vs. polar coordinates.',
        'In GR, this is exactly what happens when you change coordinates: tensors transform, but the physics (invariants like eigenvalues, trace, determinant) stays the same.'
      ], geometric:null},
    connections:['Diagonalization: if P is the eigenvector matrix, A\u2032 = P\u207B\u00B9AP is diagonal','In GR: g\u2032_{\u03BC\u03BD} = (\u2202x^\u03B1/\u2202x\u2032^\u03BC)(\u2202x^\u03B2/\u2202x\u2032^\u03BD) g_{\u03B1\u03B2} is the tensor version'],
    practice:{question:'If A has eigenvalues 2,5, what are the eigenvalues of P\u207B\u00B9AP?',
      steps:['Similarity preserves eigenvalues','A\u2032 = P\u207B\u00B9AP has the same eigenvalues as A'],
      answer:'Still 2 and 5'},
    quote:'Change your coordinates, not your physics!',
    wrongMsgs:['This operation changes the basis, not the transformation itself.','P\u207B\u00B9AP is a similarity transformation \u2014 it preserves eigenvalues.','Transpose, inverse, and eigendecomposition are different operations.']
  },

  /* ‚îÄ‚îÄ 45  Divergence ‚îÄ‚îÄ */
  { cat:'Multivariable Calculus', catIcon:'\u2207',
    q:'Find \u2207\u00B7F if F = (x\u00B2, y\u00B2, z\u00B2)', qDisplay:'\u2207\u00B7(x\u00B2, y\u00B2, z\u00B2) = ?',
    choices:['2x + 2y + 2z','2(x+y+z)','x\u00B2+y\u00B2+z\u00B2','6'], correct:0,
    vars:[
      {symbol:'\u2207\u00B7F',meaning:'Divergence \u2014 sum of partial derivatives of each component'},
      {symbol:'\u2202F\u2081/\u2202x + \u2202F\u2082/\u2202y + \u2202F\u2083/\u2202z',meaning:'Each component differentiated w.r.t. its own variable'},
      {symbol:'scalar output',meaning:'Divergence of a vector field is a scalar'}
    ],
    why:{title:'Divergence measures source/sink behavior',
      paragraphs:[
        '\u2202(x\u00B2)/\u2202x = 2x, \u2202(y\u00B2)/\u2202y = 2y, \u2202(z\u00B2)/\u2202z = 2z. Sum: 2x + 2y + 2z.',
        'Positive divergence means the field is expanding (source). In GR, the covariant divergence of the stress-energy tensor must vanish: \u2207_\u03BC T^{\u03BC\u03BD} = 0 (energy conservation).'
      ], geometric:null},
    connections:['In index notation: \u2207\u00B7F = \u2202_\u03BC F^\u03BC','Gauss\u2019s theorem: \u222B\u222B\u222B \u2207\u00B7F dV = \u222F F\u00B7dA','In GR: \u2207_\u03BC G^{\u03BC\u03BD} = 0 (Bianchi identity) ensures conservation'],
    practice:{question:'Find \u2207\u00B7F if F = (xy, yz, xz).',
      steps:['\u2202(xy)/\u2202x = y','\u2202(yz)/\u2202y = z','\u2202(xz)/\u2202z = x'],
      answer:'\u2207\u00B7F = x + y + z'},
    quote:'Divergence: are things flowing in or out?',
    wrongMsgs:['Differentiate each component w.r.t. its own variable.','2x + 2y + 2z is the same as 2(x+y+z).','Divergence produces a scalar, not a vector.']
  },

  /* ‚îÄ‚îÄ 46  Multivariable chain rule ‚îÄ‚îÄ */
  { cat:'Multivariable Calculus', catIcon:'\u2207',
    q:'If f = x\u00B2 + y\u00B2, x = cos(t), y = sin(t), find df/dt', qDisplay:'df/dt if f=x\u00B2+y\u00B2, x=cos t, y=sin t?',
    choices:['0','\u22122sin(2t)','2cos(2t)','2'], correct:0,
    vars:[
      {symbol:'df/dt',meaning:'Total derivative \u2014 how f changes as t changes through x and y'},
      {symbol:'chain rule',meaning:'df/dt = (\u2202f/\u2202x)(dx/dt) + (\u2202f/\u2202y)(dy/dt)'},
      {symbol:'x\u00B2 + y\u00B2 = 1',meaning:'cos\u00B2(t) + sin\u00B2(t) = 1 \u2014 f is constant!'}
    ],
    why:{title:'Multivariable chain rule and a beautiful shortcut',
      paragraphs:[
        'By chain rule: df/dt = 2x(\u2212sin t) + 2y(cos t) = \u22122cos(t)sin(t) + 2sin(t)cos(t) = 0.',
        'But there\u2019s a faster way: f = cos\u00B2(t) + sin\u00B2(t) = 1 for all t, so df/dt = 0 trivially. The path traces the unit circle, which stays at distance 1 from the origin!'
      ], geometric:'unit-circle'},
    connections:['In GR: proper time along a worldline uses d\u03C4/dt with the chain rule','The multivariable chain rule generalizes to: df = (\u2202f/\u2202x^\u03BC) dx^\u03BC'],
    practice:{question:'If f = xy, x = t\u00B2, y = t\u00B3, find df/dt.',
      steps:['df/dt = y\u00B7(2t) + x\u00B7(3t\u00B2)','= t\u00B3(2t) + t\u00B2(3t\u00B2)','= 2t\u2074 + 3t\u2074 = 5t\u2074'],
      answer:'df/dt = 5t\u2074'},
    quote:'Multiple paths, one derivative \u2014 the chain rule ties them together!',
    wrongMsgs:['Use df/dt = (\u2202f/\u2202x)(dx/dt) + (\u2202f/\u2202y)(dy/dt).','Or notice: f = cos\u00B2(t) + sin\u00B2(t) = 1, which is constant.','A constant function has derivative 0.']
  },

  /* ‚îÄ‚îÄ 47  Symmetric matrix ‚îÄ‚îÄ */
  { cat:'Linear Algebra', catIcon:'\uD83D\uDCCA',
    q:'A symmetric matrix has what property?', qDisplay:'Symmetric matrix: A = ?',
    choices:['A = A\u1D40 (equals its transpose)','A = A\u207B\u00B9','A = \u2212A\u1D40','det(A) = 1'], correct:0,
    vars:[
      {symbol:'A\u1D40',meaning:'Transpose \u2014 flip rows and columns: (A\u1D40)\u1D62\u2C7C = A\u2C7C\u1D62'},
      {symbol:'a\u1D62\u2C7C = a\u2C7C\u1D62',meaning:'Entry (i,j) equals entry (j,i) \u2014 symmetric across the diagonal'},
      {symbol:'real eigenvalues',meaning:'Symmetric matrices always have real eigenvalues'}
    ],
    why:{title:'Symmetry: the most important matrix property in physics',
      paragraphs:[
        'A symmetric matrix satisfies A = A\u1D40, meaning a\u1D62\u2C7C = a\u2C7C\u1D62 for all i,j. The matrix is mirrored across its main diagonal.',
        'The metric tensor g_{\u03BC\u03BD} in GR is always symmetric: g_{\u03BC\u03BD} = g_{\u03BD\u03BC}. In 4D, this means 10 independent components instead of 16. The Ricci tensor R_{\u03BC\u03BD} is also symmetric.'
      ], geometric:null},
    connections:['Real symmetric matrices are diagonalizable with orthogonal eigenvectors','The spectral theorem: A = Q\u039BQ\u1D40 where Q is orthogonal','g_{\u03BC\u03BD} symmetric means ds\u00B2 has no dxdy \u2212 dydx ambiguity'],
    practice:{question:'Is [[1,3,5],[3,2,4],[5,4,6]] symmetric?',
      steps:['Check: a\u2081\u2082 = a\u2082\u2081 = 3 \u2714','a\u2081\u2083 = a\u2083\u2081 = 5 \u2714, a\u2082\u2083 = a\u2083\u2082 = 4 \u2714','All off-diagonal pairs match \u2192 symmetric!'],
      answer:'Yes, it\u2019s symmetric'},
    quote:'The metric tensor is symmetric \u2014 and that simplifies everything!',
    wrongMsgs:['Symmetric means A equals its transpose: a_ij = a_ji.','A = A\u207B\u00B9 is orthogonal, not symmetric.','A = \u2212A\u1D40 is anti-symmetric (skew-symmetric).']
  },

  /* ‚îÄ‚îÄ 48  Second derivative test (multivariable) ‚îÄ‚îÄ */
  { cat:'Multivariable Calculus', catIcon:'\u2207',
    q:'The Hessian matrix contains what?', qDisplay:'Hessian H\u1D62\u2C7C = ?',
    choices:['Second partial derivatives \u2202\u00B2f/\u2202x\u1D62\u2202x\u2C7C','First partial derivatives','Christoffel symbols','Eigenvalues of f'], correct:0,
    vars:[
      {symbol:'H\u1D62\u2C7C',meaning:'Hessian matrix \u2014 matrix of all second partial derivatives'},
      {symbol:'\u2202\u00B2f/\u2202x\u1D62\u2202x\u2C7C',meaning:'Entry (i,j) is the mixed partial derivative'},
      {symbol:'det(H) > 0',meaning:'At a critical point: min if H\u2081\u2081 > 0, max if H\u2081\u2081 < 0'}
    ],
    why:{title:'The Hessian: curvature of a function',
      paragraphs:[
        'The Hessian matrix H\u1D62\u2C7C = \u2202\u00B2f/\u2202x\u1D62\u2202x\u2C7C collects all second derivatives. It tells you about the curvature of f at a point.',
        'By Clairaut\u2019s theorem, the Hessian is symmetric! Its eigenvalues determine the nature of critical points. In GR, the Riemann tensor plays an analogous role for spacetime curvature.'
      ], geometric:null},
    connections:['Positive definite Hessian \u2192 local minimum','Negative definite \u2192 local maximum, indefinite \u2192 saddle point','The Hessian is to scalar functions what the Riemann tensor is to spacetime geometry'],
    practice:{question:'Find the Hessian of f(x,y) = x\u00B2 + xy + y\u00B2.',
      steps:['\u2202\u00B2f/\u2202x\u00B2 = 2, \u2202\u00B2f/\u2202y\u00B2 = 2','\u2202\u00B2f/\u2202x\u2202y = 1','H = [[2,1],[1,2]], det = 3 > 0, H\u2081\u2081 > 0 \u2192 minimum'],
      answer:'H = [[2,1],[1,2]] \u2014 positive definite (minimum)'},
    quote:'Second derivatives tell you the shape of the landscape!',
    wrongMsgs:['The Hessian contains SECOND partial derivatives, not first.','It\u2019s a matrix of \u2202\u00B2f/\u2202x\u1D62\u2202x\u2C7C.','Christoffel symbols live in differential geometry, not in the Hessian.']
  },

  /* ‚îÄ‚îÄ 49  Einstein field equation structure ‚îÄ‚îÄ */
  { cat:'Tensor Calculus', catIcon:'\uD83E\uDDF2',
    q:'In G_{\u03BC\u03BD} = 8\u03C0G T_{\u03BC\u03BD}, what is G_{\u03BC\u03BD}?', qDisplay:'G_{\u03BC\u03BD} = R_{\u03BC\u03BD} \u2212 ?',
    choices:['\u00BDg_{\u03BC\u03BD}R','g_{\u03BC\u03BD}R','R_{\u03BC\u03BD}','\u039Bg_{\u03BC\u03BD}'], correct:0,
    vars:[
      {symbol:'G_{\u03BC\u03BD}',meaning:'Einstein tensor \u2014 encodes spacetime curvature on the left side of EFE'},
      {symbol:'R_{\u03BC\u03BD}',meaning:'Ricci tensor \u2014 contraction of the Riemann tensor'},
      {symbol:'\u00BDg_{\u03BC\u03BD}R',meaning:'Trace-correction term ensuring \u2207_\u03BC G^{\u03BC\u03BD} = 0'}
    ],
    why:{title:'The Einstein tensor: geometry\u2019s response to matter',
      paragraphs:[
        'G_{\u03BC\u03BD} = R_{\u03BC\u03BD} \u2212 \u00BDg_{\u03BC\u03BD}R. The subtracted term ensures the Bianchi identity \u2207_\u03BC G^{\u03BC\u03BD} = 0, which is needed for energy conservation (\u2207_\u03BC T^{\u03BC\u03BD} = 0).',
        'This is Einstein\u2019s masterpiece: geometry (left side) = matter-energy (right side). The metric determines curvature, curvature determines motion, and matter determines curvature. A perfect loop!'
      ], geometric:null},
    connections:['With cosmological constant: G_{\u03BC\u03BD} + \u039Bg_{\u03BC\u03BD} = 8\u03C0G T_{\u03BC\u03BD}','In vacuum (T = 0): G_{\u03BC\u03BD} = 0 \u21D4 R_{\u03BC\u03BD} = 0','10 independent equations (symmetric 4\u00D74 tensor)'],
    practice:{question:'Why is the \u00BDg_{\u03BC\u03BD}R term necessary?',
      steps:['Without it: \u2207_\u03BC R^{\u03BC\u03BD} \u2260 0 in general','But we need \u2207_\u03BC T^{\u03BC\u03BD} = 0 (conservation of energy)','The trace correction ensures \u2207_\u03BC G^{\u03BC\u03BD} = 0 identically (Bianchi)'],
      answer:'It enforces energy-momentum conservation via the Bianchi identity'},
    quote:'Matter tells spacetime how to curve; spacetime tells matter how to move!',
    wrongMsgs:['G_{\u03BC\u03BD} is R_{\u03BC\u03BD} minus a trace-correction term.','The \u00BD factor comes from ensuring the Bianchi identity holds.','g_{\u03BC\u03BD}R without the \u00BD would overcorrect.']
  }
  ];
  /* ‚ïê‚ïê‚ïê end of problems array ‚ïê‚ïê‚ïê */

  /* ‚îÄ‚îÄ State ‚îÄ‚îÄ */
  var currentIdx = parseInt(localStorage.getItem('mqotd-currentIdx') || '0');
  if (currentIdx < 0 || currentIdx >= problems.length) currentIdx = 0;

  let streak = parseInt(localStorage.getItem('mqotd-streak') || '0');
  let lastDay = parseInt(localStorage.getItem('mqotd-lastday') || '-1');
  const dayOfYear = Math.floor((Date.now() - new Date(new Date().getFullYear(),0,0)) / 86400000);

  const el = document.getElementById('mqotd-content');

  function updateStreak() {
    const sel = document.getElementById('mqotd-streak');
    if (streak > 0) {
      const fire = streak >= 7 ? '\uD83D\uDD25\uD83D\uDD25\uD83D\uDD25' : streak >= 4 ? '\uD83D\uDD25\uD83D\uDD25' : '\uD83D\uDD25';
      sel.style.display = 'block';
      sel.innerHTML = '<span style="background:linear-gradient(135deg,rgba(198,118,0,0.2),rgba(42,122,111,0.15));padding:6px 16px;border-radius:99px;font-weight:700;">' + fire + ' ' + streak + '-day streak!</span>';
    }
  }
  updateStreak();

  /* ‚îÄ‚îÄ Shuffle helper (deterministic per problem index) ‚îÄ‚îÄ */
  function shuffleForIdx(idx) {
    var prob = problems[idx];
    var correctAnswer = prob.choices[prob.correct];
    var sh = [].concat(prob.choices);
    for (var i = sh.length - 1; i > 0; i--) {
      var j = (idx * 7 + i * 13) % (i + 1);
      var tmp = sh[i]; sh[i] = sh[j]; sh[j] = tmp;
    }
    return { shuffled: sh, correctIdx: sh.indexOf(correctAnswer), correctAnswer: correctAnswer };
  }

  /* ‚îÄ‚îÄ Navigation bar ‚îÄ‚îÄ */
  function renderNav() {
    return '<div style="display:flex;align-items:center;justify-content:center;gap:12px;margin-bottom:18px;">' +
      '<button id="mqotd-prev" class="mqotd-action-btn" style="padding:6px 14px;font-size:0.95rem;">\u25C0 Prev</button>' +
      '<span style="color:var(--text-dim);font-size:0.95rem;min-width:100px;text-align:center;">' + (currentIdx + 1) + ' / ' + problems.length + '</span>' +
      '<button id="mqotd-next" class="mqotd-action-btn" style="padding:6px 14px;font-size:0.95rem;">Next \u25B6</button>' +
      '<button id="mqotd-rand" class="mqotd-action-btn" style="padding:6px 14px;font-size:0.95rem;background:transparent;border:1px solid var(--accent2);color:var(--accent2);" title="Random problem">\uD83C\uDFB2</button>' +
    '</div>';
  }

  function bindNav() {
    document.getElementById('mqotd-prev').addEventListener('click', function() {
      currentIdx = (currentIdx - 1 + problems.length) % problems.length;
      localStorage.setItem('mqotd-currentIdx', String(currentIdx));
      loadProblem();
    });
    document.getElementById('mqotd-next').addEventListener('click', function() {
      currentIdx = (currentIdx + 1) % problems.length;
      localStorage.setItem('mqotd-currentIdx', String(currentIdx));
      loadProblem();
    });
    document.getElementById('mqotd-rand').addEventListener('click', function() {
      currentIdx = Math.floor(Math.random() * problems.length);
      localStorage.setItem('mqotd-currentIdx', String(currentIdx));
      loadProblem();
    });
  }

  /* ‚ïê‚ïê‚ïê Load a problem ‚ïê‚ïê‚ïê */
  function loadProblem() {
    var prob = problems[currentIdx];
    var s = shuffleForIdx(currentIdx);
    window.mqotdProblem = prob;

    el.innerHTML = renderNav() +
      '<div style="text-align:center;margin-bottom:20px;">' +
        '<div style="margin-bottom:10px;"><span class="mqotd-cat-pill">' + prob.catIcon + ' ' + prob.cat + '</span></div>' +
        '<div class="mqotd-eq-box">' + prob.qDisplay + '</div>' +
      '</div>' +
      '<div id="mqotd-choices" class="mqotd-grid">' +
        s.shuffled.map(function(c, i) {
          return '<button class="mqotd-btn" data-idx="' + i + '">' + c + '</button>';
        }).join('') +
      '</div>' +
      '<div id="mqotd-feedback" style="text-align:center;margin-top:14px;font-size:1rem;min-height:28px;"></div>';

    bindNav();

    document.querySelectorAll('.mqotd-btn').forEach(function(btn) {
      btn.addEventListener('click', function() {
        var idx = parseInt(this.dataset.idx);
        if (idx === s.correctIdx) handleCorrect(this, prob, s); else handleWrong(this, prob);
      });
    });
  }

  /* ‚ïê‚ïê‚ïê Wrong answer ‚ïê‚ïê‚ïê */
  function handleWrong(btn, prob) {
    btn.style.borderColor = '#b33a3a';
    btn.style.background = 'rgba(239,68,68,0.15)';
    btn.style.pointerEvents = 'none';
    var fb = document.getElementById('mqotd-feedback');
    var msg = prob.wrongMsgs[Math.floor(Math.random() * prob.wrongMsgs.length)];
    fb.innerHTML = '<span style="color:#b33a3a;">' + msg + '</span>';
  }

  /* ‚ïê‚ïê‚ïê Correct answer ‚ïê‚ïê‚ïê */
  function handleCorrect(btn, prob, s) {
    btn.style.borderColor = 'var(--green)';
    btn.style.background = 'rgba(45,125,70,0.15)';
    document.querySelectorAll('.mqotd-btn').forEach(function(b) { b.style.pointerEvents = 'none'; });

    if (lastDay !== dayOfYear) {
      streak++;
      lastDay = dayOfYear;
      localStorage.setItem('mqotd-streak', String(streak));
      localStorage.setItem('mqotd-lastday', String(dayOfYear));
    }
    updateStreak();

    if (typeof confetti === 'function') {
      confetti({particleCount:150, spread:80, origin:{y:0.7}});
      setTimeout(function(){ confetti({particleCount:80, spread:100, origin:{y:0.5}}); }, 300);
      setTimeout(function(){ confetti({particleCount:60, spread:120, origin:{y:0.6}, colors:['#1e3a5f','#b8860b','#2a7a6f','#2d7d46']}); }, 600);
    }

    var fb = document.getElementById('mqotd-feedback');
    fb.innerHTML =
      '<div style="animation:mqotdBounce 0.5s ease-out;margin:16px 0;">' +
        '<div style="font-size:2.5rem;margin-bottom:6px;">\uD83C\uDF89</div>' +
        '<div style="background:linear-gradient(135deg,rgba(45,125,70,0.15),rgba(30,58,95,0.1));border:1px solid rgba(45,125,70,0.3);border-radius:12px;padding:16px 20px;display:inline-block;max-width:400px;">' +
          '<div style="font-weight:700;color:var(--green);font-size:1.1rem;margin-bottom:4px;">\u2705 Correct!</div>' +
          '<div style="color:var(--text);font-size:0.95rem;font-style:italic;">' + prob.quote + '</div>' +
        '</div>' +
      '</div>';

    setTimeout(function(){ renderExplanation(prob); }, 1200);
  }

  /* ‚ïê‚ïê‚ïê Deep Explanation ‚ïê‚ïê‚ïê */
  function renderExplanation(prob) {
    var html = '<div class="mqotd-explain" style="animation:mqotdSlideIn 0.6s ease-out;">';

    html += '<h3 style="font-size:1.15rem;color:var(--accent2);margin-bottom:12px;">\uD83D\uDCA1 ' + prob.why.title + '</h3>';
    prob.why.paragraphs.forEach(function(p) {
      html += '<p style="font-size:1rem;line-height:1.7;margin-bottom:10px;color:var(--text);">' + p + '</p>';
    });

    if (prob.why.geometric && geoText[prob.why.geometric]) {
      html += '<div class="mqotd-geo-callout"><strong style="color:var(--accent2);">' +
        (prob.why.geometric === 'unit-circle' ? '\uD83D\uDD35 Unit Circle Intuition' :
         prob.why.geometric === 'slope-tangent' ? '\uD83D\uDCC8 Slope / Tangent Line' :
         '\u222B Area Under the Curve') +
        '</strong><p style="margin-top:6px;font-size:0.95rem;line-height:1.6;color:var(--text);">' + geoText[prob.why.geometric] + '</p></div>';
    }

    html += '<div class="mqotd-var-section"><h4 style="font-size:1rem;color:var(--text);margin-bottom:8px;">\uD83D\uDD24 Variables</h4><div class="mqotd-var-grid">';
    prob.vars.forEach(function(v) {
      html += '<div class="mqotd-var"><span class="mqotd-var-sym">' + v.symbol + '</span><span class="mqotd-var-mean">' + v.meaning + '</span></div>';
    });
    html += '</div></div>';

    if (prob.connections.length > 0) {
      html += '<div class="mqotd-conn-section"><h4 style="font-size:1rem;color:var(--text);margin-bottom:8px;">\u2194\uFE0F Connections</h4>';
      prob.connections.forEach(function(c) {
        html += '<div class="mqotd-conn">\u2192 ' + c + '</div>';
      });
      html += '</div>';
    }

    html += '<div class="mqotd-practice">' +
      '<h4 style="font-size:1rem;color:var(--text);margin-bottom:8px;">\uD83E\uDDEA Practice Problem</h4>' +
      '<p style="font-size:1rem;color:var(--text);margin-bottom:12px;">' + prob.practice.question + '</p>' +
      '<div id="mqotd-steps">';
    prob.practice.steps.forEach(function(s, i) {
      html += '<div class="mqotd-step" id="mqotd-step-' + i + '" style="display:none;"><span class="mqotd-step-num">Step ' + (i+1) + '</span> ' + s + '</div>';
    });
    html += '<div class="mqotd-step" id="mqotd-step-answer" style="display:none;border-color:var(--green);"><strong style="color:var(--green);">\u2705 ' + prob.practice.answer + '</strong></div>';
    html += '</div>';
    html += '<div style="display:flex;gap:10px;margin-top:10px;flex-wrap:wrap;">' +
      '<button id="mqotd-next-step" class="mqotd-action-btn">Next Step \u25B6</button>' +
      '<button id="mqotd-show-all" class="mqotd-action-btn" style="background:transparent;border:1px solid var(--accent2);color:var(--accent2);">Show All</button>' +
    '</div></div>';

    html += '</div>';

    var wrapper = document.createElement('div');
    wrapper.style.cssText = 'margin-top:20px;';
    wrapper.innerHTML = html;
    el.appendChild(wrapper);

    var stepIdx = 0;
    var totalSteps = prob.practice.steps.length + 1;
    document.getElementById('mqotd-next-step').addEventListener('click', function() {
      if (stepIdx < totalSteps) {
        var id = stepIdx < prob.practice.steps.length ? 'mqotd-step-' + stepIdx : 'mqotd-step-answer';
        var stepEl = document.getElementById(id);
        stepEl.style.display = 'block';
        stepEl.style.animation = 'mqotdSlideIn 0.3s ease-out';
        stepIdx++;
        if (stepIdx >= totalSteps) this.textContent = 'All Done \u2713';
      }
    });
    document.getElementById('mqotd-show-all').addEventListener('click', function() {
      for (var i = 0; i < prob.practice.steps.length; i++) {
        document.getElementById('mqotd-step-' + i).style.display = 'block';
      }
      document.getElementById('mqotd-step-answer').style.display = 'block';
      stepIdx = totalSteps;
      document.getElementById('mqotd-next-step').textContent = 'All Done \u2713';
    });
  }

  /* ‚îÄ‚îÄ Init ‚îÄ‚îÄ */
  loadProblem();

})();
</script>

<!-- AI Chat removed -->
</script>

<!-- Physics Equation of the Day -->
<div class="card" id="physics-eotd" style="border-color: var(--accent3);">
  <div class="card-header" onclick="toggle(this)">
    <h2>‚öõÔ∏è Physics Equation of the Day</h2>
    <span class="chevron">‚ñº</span>
  </div>
  <div class="card-body">
    <div id="peotd-streak" style="text-align:center;margin-bottom:12px;font-size:1.1rem;display:none;"></div>
    <div id="peotd-content"></div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
<script>
(function(){
  const eqs = [
    {eq:"E = mc¬≤", name:"Mass‚ÄìEnergy Equivalence", choices:["Mass‚ÄìEnergy Equivalence","Planck‚ÄìEinstein Relation","Lorentz Factor","de Broglie Wavelength"],
     explain:"Energy equals mass times the speed of light squared. Shows mass and energy are interchangeable.",
     vars:"E = energy, m = mass, c = speed of light (3√ó10‚Å∏ m/s)",
     practice:"How much energy is in 1 kg of matter?", practiceA:"E = 1 √ó (3√ó10‚Å∏)¬≤ = 9√ó10¬π‚Å∂ J ‚Äî about 21 megatons of TNT!",
     physicist:"Einstein", quote:"üòú Nicht schlecht! (Not bad!)", correct:0},
    {eq:"F = G¬∑m‚ÇÅm‚ÇÇ / r¬≤", name:"Newton's Law of Gravitation", choices:["Coulomb's Law","Newton's Law of Gravitation","Hooke's Law","Kepler's Third Law"],
     explain:"The gravitational force between two masses is proportional to their product and inversely proportional to the square of the distance.",
     vars:"F = force, G = gravitational constant, m‚ÇÅ,m‚ÇÇ = masses, r = distance",
     practice:"What happens to the force if you double the distance?", practiceA:"F drops to 1/4 ‚Äî inverse square law!",
     physicist:"Newton", quote:"üçé That one was a no-brainer!", correct:1},
    {eq:"ds¬≤ = ‚àí(1 ‚àí 2GM/rc¬≤)c¬≤dt¬≤ + (1 ‚àí 2GM/rc¬≤)‚Åª¬πdr¬≤ + r¬≤dŒ©¬≤", name:"Schwarzschild Metric", choices:["Friedmann Equation","FLRW Metric","Schwarzschild Metric","Kerr Metric"],
     explain:"Describes spacetime geometry around a non-rotating spherical mass. The foundation of black hole physics.",
     vars:"ds¬≤ = spacetime interval, G = gravitational constant, M = mass, r = radial coordinate, dŒ©¬≤ = angular part",
     practice:"At what radius does the time component vanish?", practiceA:"When r = 2GM/c¬≤ ‚Äî the Schwarzschild radius (event horizon)!",
     physicist:"Einstein", quote:"üòú Gravity is not a force ‚Äî it's geometry!", correct:2},
    {eq:"GŒºŒΩ + ŒõgŒºŒΩ = (8œÄG/c‚Å¥) TŒºŒΩ", name:"Einstein Field Equations", choices:["Maxwell's Equations","Einstein Field Equations","Navier-Stokes Equations","Yang-Mills Equations"],
     explain:"Mass-energy tells spacetime how to curve; curved spacetime tells matter how to move.",
     vars:"GŒºŒΩ = Einstein tensor, Œõ = cosmological constant, gŒºŒΩ = metric tensor, TŒºŒΩ = stress-energy tensor",
     practice:"What does Œõ represent physically?", practiceA:"The cosmological constant ‚Äî dark energy driving the universe's accelerating expansion!",
     physicist:"Einstein", quote:"üòú God does not play dice‚Ä¶ but he does curve spacetime!", correct:1},
    {eq:"‚àá¬∑E = œÅ/Œµ‚ÇÄ ,  ‚àá¬∑B = 0 ,  ‚àá√óE = ‚àí‚àÇB/‚àÇt ,  ‚àá√óB = Œº‚ÇÄJ + Œº‚ÇÄŒµ‚ÇÄ ‚àÇE/‚àÇt", name:"Maxwell's Equations", choices:["Maxwell's Equations","Navier-Stokes Equations","Euler-Lagrange Equations","Hamilton's Equations"],
     explain:"Four equations unifying electricity, magnetism, and light. One of the great triumphs of physics.",
     vars:"E = electric field, B = magnetic field, œÅ = charge density, J = current density, Œµ‚ÇÄ, Œº‚ÇÄ = vacuum constants",
     practice:"What do Maxwell's equations predict travels at c?", practiceA:"Electromagnetic waves ‚Äî light! ‚àá√ó(‚àá√óE) gives a wave equation with speed 1/‚àö(Œº‚ÇÄŒµ‚ÇÄ) = c",
     physicist:"Maxwell", quote:"‚ö° Electrifying performance!", correct:0},
    {eq:"i‚Ñè ‚àÇŒ®/‚àÇt = ƒ§Œ®", name:"Schr√∂dinger Equation", choices:["Dirac Equation","Schr√∂dinger Equation","Klein-Gordon Equation","Heisenberg Equation"],
     explain:"The master equation of quantum mechanics. Describes how the quantum state evolves in time.",
     vars:"i = imaginary unit, ‚Ñè = reduced Planck constant, Œ® = wave function, ƒ§ = Hamiltonian operator",
     practice:"What does |Œ®|¬≤ represent?", practiceA:"The probability density ‚Äî the chance of finding the particle at that location!",
     physicist:"Feynman", quote:"ü§ô If you can't explain it simply, you understand it. And you do!", correct:1},
    {eq:"T_H = ‚Ñèc¬≥ / (8œÄGMk_B)", name:"Hawking Temperature", choices:["Planck Temperature","Hawking Temperature","CMB Temperature","Unruh Temperature"],
     explain:"Black holes aren't completely black ‚Äî they radiate thermally at this temperature. Smaller = hotter!",
     vars:"T_H = temperature, ‚Ñè = reduced Planck constant, c = speed of light, G = gravitational constant, M = black hole mass, k_B = Boltzmann constant",
     practice:"What happens to temperature as M decreases?", practiceA:"T increases! Tiny black holes are incredibly hot ‚Äî they evaporate explosively!",
     physicist:"Hawking", quote:"üåå Intelligence is the ability to adapt to change. You're adapting!", correct:1},
    {eq:"E = hf = ‚Ñèœâ", name:"Planck‚ÄìEinstein Relation", choices:["Mass‚ÄìEnergy Equivalence","Planck‚ÄìEinstein Relation","de Broglie Relation","Rydberg Formula"],
     explain:"Energy of a photon is proportional to its frequency. The birth of quantum theory!",
     vars:"E = energy, h = Planck constant, f = frequency, ‚Ñè = h/2œÄ, œâ = angular frequency",
     practice:"A photon has f = 5√ó10¬π‚Å¥ Hz. What's its energy?", practiceA:"E = 6.626√ó10‚Åª¬≥‚Å¥ √ó 5√ó10¬π‚Å¥ ‚âà 3.3√ó10‚Åª¬π‚Åπ J ‚âà 2.07 eV (visible light!)",
     physicist:"Euler", quote:"üß† A mathematician who is not somewhat of a poet will never be a complete mathematician.", correct:1},
    {eq:"Œ≥ = 1 / ‚àö(1 ‚àí v¬≤/c¬≤)", name:"Lorentz Factor", choices:["Lorentz Factor","Hubble Parameter","Fine Structure Constant","Compton Wavelength"],
     explain:"The factor that governs time dilation and length contraction in special relativity.",
     vars:"Œ≥ = Lorentz factor, v = velocity, c = speed of light",
     practice:"What is Œ≥ at v = 0.8c?", practiceA:"Œ≥ = 1/‚àö(1‚àí0.64) = 1/‚àö0.36 = 1/0.6 ‚âà 1.667 ‚Äî time runs 60% slower!",
     physicist:"Einstein", quote:"üòú Put your hand on a hot stove‚Ä¶ that's relativity!", correct:0},
    {eq:"S = k_B ¬∑ ln(Œ©)", name:"Boltzmann Entropy", choices:["Shannon Entropy","Boltzmann Entropy","Gibbs Free Energy","von Neumann Entropy"],
     explain:"Connects the microscopic world (number of microstates Œ©) to the macroscopic property of entropy.",
     vars:"S = entropy, k_B = Boltzmann constant (1.38√ó10‚Åª¬≤¬≥ J/K), Œ© = number of microstates",
     practice:"If a system has 1 microstate, what is S?", practiceA:"S = k_B ¬∑ ln(1) = 0 ‚Äî perfect order, zero entropy!",
     physicist:"Dirac", quote:"‚ú® The answer is beautiful, as expected.", correct:1},
    {eq:"(iŒ≥·µò‚àÇŒº ‚àí m)œà = 0", name:"Dirac Equation", choices:["Schr√∂dinger Equation","Klein-Gordon Equation","Dirac Equation","Proca Equation"],
     explain:"Relativistic quantum equation for spin-¬Ω particles. Predicted antimatter before it was discovered!",
     vars:"Œ≥·µò = Dirac gamma matrices, ‚àÇŒº = four-gradient, m = mass, œà = four-component spinor",
     practice:"What did Dirac's equation predict that shocked physics?", practiceA:"The existence of the positron (antielectron) ‚Äî antimatter! Confirmed by Anderson in 1932.",
     physicist:"Dirac", quote:"‚ú® The answer is beautiful, as expected.", correct:2},
    {eq:"F = k_e ¬∑ q‚ÇÅq‚ÇÇ / r¬≤", name:"Coulomb's Law", choices:["Newton's Law of Gravitation","Coulomb's Law","Biot-Savart Law","Amp√®re's Force Law"],
     explain:"The electric force between two charges ‚Äî same inverse-square structure as gravity, but vastly stronger.",
     vars:"F = force, k_e = Coulomb constant (8.99√ó10‚Åπ), q‚ÇÅ,q‚ÇÇ = charges, r = distance",
     practice:"How much stronger is the electric force than gravity between two protons?", practiceA:"About 10¬≥‚Å∂ times stronger! Electromagnetism absolutely dwarfs gravity at particle scales.",
     physicist:"Feynman", quote:"ü§ô Nature uses only the longest threads to weave her patterns!", correct:1},
    {eq:"(»ß/a)¬≤ = (8œÄG/3)œÅ ‚àí k/a¬≤ + Œõ/3", name:"Friedmann Equation", choices:["Friedmann Equation","Schwarzschild Metric","Raychaudhuri Equation","de Sitter Solution"],
     explain:"Governs the expansion of the universe. Relates the expansion rate to energy density, curvature, and dark energy.",
     vars:"a = scale factor, »ß = its time derivative, œÅ = energy density, k = curvature, Œõ = cosmological constant",
     practice:"In a flat universe (k=0) with only matter, how does a(t) grow?", practiceA:"a(t) ‚àù t^(2/3) ‚Äî decelerating expansion. Add Œõ and it accelerates!",
     physicist:"Hawking", quote:"üåå The universe doesn't allow perfection. But it does allow Friedmann equations!", correct:0},
    {eq:"œÅ ‚àÇv/‚àÇt + œÅ(v¬∑‚àá)v = ‚àí‚àáp + Œº‚àá¬≤v + f", name:"Navier-Stokes Equations", choices:["Euler Equations","Navier-Stokes Equations","Bernoulli's Equation","Stokes' Law"],
     explain:"Describes fluid motion. One of the Millennium Prize Problems ‚Äî smooth solutions in 3D are still unproven!",
     vars:"œÅ = density, v = velocity, p = pressure, Œº = viscosity, f = external forces",
     practice:"What makes Navier-Stokes a Millennium Prize Problem?", practiceA:"Nobody has proven whether smooth solutions always exist in 3D ‚Äî $1M prize from Clay Institute!",
     physicist:"Euler", quote:"üß† Mathematics reveals its secrets only to those who approach with pure love!", correct:1},
    {eq:"Œ∂(s) = Œ£ 1/nÀ¢ = Œ† (1 ‚àí p‚ÅªÀ¢)‚Åª¬π", name:"Euler Product (Riemann Zeta)", choices:["Euler Product (Riemann Zeta)","Dirichlet L-function","Dedekind Zeta","Ramanujan Tau"],
     explain:"Connects the sum over all integers to a product over all primes ‚Äî the bridge between analysis and number theory!",
     vars:"Œ∂(s) = Riemann zeta function, n = positive integers, p = prime numbers, s = complex variable",
     practice:"What does this equation say about primes?", practiceA:"Primes completely determine Œ∂(s)! The distribution of primes is encoded in the zeta function's zeros.",
     physicist:"Euler", quote:"üß† Mathematicians have tried in vain to discover some order in the sequence of prime numbers‚Ä¶ the mystery remains.", correct:0},
    {eq:"d¬≤x·µò/dœÑ¬≤ + Œì·µò·µ•œÉ (dx·µõ/dœÑ)(dx·µ†/dœÑ) = 0", name:"Geodesic Equation", choices:["Euler-Lagrange Equation","Geodesic Equation","Hamilton's Equation","Jacobi Equation"],
     explain:"The path of a freely falling object through curved spacetime. Gravity isn't a force ‚Äî it's geometry!",
     vars:"x·µò = spacetime coordinates, œÑ = proper time, Œì·µò·µ•œÉ = Christoffel symbols (encode curvature)",
     practice:"What path does this equation describe in flat spacetime?", practiceA:"A straight line! Œì = 0 in flat space, so d¬≤x/dœÑ¬≤ = 0 ‚Üí constant velocity. Newton's first law!",
     physicist:"Einstein", quote:"üòú Falling is just following geometry. Don't fight it!", correct:1},
  ];

  const wrongMsgs = [
    "Hmm, even Einstein got things wrong sometimes. Try again! ü§î",
    "Not quite! The universe is tricky. Give it another shot! üåÄ",
    "Close but no cigar! Feynman would say: try again, that's science! üî¨",
    "The math says no‚Ä¶ but your determination says yes! Try again! üí™",
    "Wrong universe! Try a parallel one (another answer) üåå",
  ];

  const dayOfYear = Math.floor((Date.now() - new Date(new Date().getFullYear(),0,0)) / 86400000);
  const eq = eqs[dayOfYear % eqs.length];
  let streak = parseInt(localStorage.getItem('peotd-streak') || '0');
  let lastDay = parseInt(localStorage.getItem('peotd-lastday') || '-1');
  if (lastDay !== dayOfYear) { /* new day, keep streak but allow playing */ }
  const alreadyCorrect = (lastDay === dayOfYear && localStorage.getItem('peotd-done') === '1');

  function updateStreak() {
    const el = document.getElementById('peotd-streak');
    if (streak > 0) {
      const fire = streak >= 7 ? 'üî•üî•üî•' : streak >= 4 ? 'üî•üî•' : 'üî•';
      el.style.display = 'block';
      el.innerHTML = `<span style="background:linear-gradient(135deg,rgba(198,118,0,0.2),rgba(42,122,111,0.15));padding:6px 16px;border-radius:99px;font-weight:700;">${fire} ${streak}-day streak!</span>`;
    }
  }
  updateStreak();

  // Shuffle choices but track correct index
  const correctAnswer = eq.choices[eq.correct];
  let shuffled = [...eq.choices];
  // Simple deterministic shuffle based on day
  for (let i = shuffled.length - 1; i > 0; i--) {
    const j = (dayOfYear * 7 + i * 13) % (i + 1);
    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
  }
  const correctIdx = shuffled.indexOf(correctAnswer);

  const el = document.getElementById('peotd-content');

  function renderStep1() {
    el.innerHTML = `
      <div style="text-align:center;margin-bottom:20px;">
        <div style="font-size:0.9rem;color:var(--text-dim);margin-bottom:10px;">üî¨ What is this equation?</div>
        <div style="background:var(--bg-alt);border:1px solid var(--card-border);border-radius:12px;padding:24px;margin:12px 0;font-size:1.3rem;font-weight:600;color:var(--accent2);line-height:1.8;overflow-x:auto;">${eq.eq}</div>
      </div>
      <div id="peotd-choices" style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
        ${shuffled.map((c,i) => `<button class="peotd-btn" data-idx="${i}" style="background:var(--card);border:2px solid var(--card-border);color:var(--text);font-family:'JetBrains Mono',monospace;font-size:0.95rem;padding:14px 12px;border-radius:10px;cursor:pointer;transition:all 0.2s;line-height:1.4;text-align:center;" onmouseover="this.style.borderColor='var(--accent1)';this.style.transform='translateY(-1px)'" onmouseout="if(!this.classList.contains('chosen'))this.style.borderColor='var(--card-border)';this.style.transform=''">${c}</button>`).join('')}
      </div>
      <div id="peotd-feedback" style="text-align:center;margin-top:14px;font-size:1rem;min-height:28px;"></div>
    `;
    document.querySelectorAll('.peotd-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        const idx = parseInt(this.dataset.idx);
        if (idx === correctIdx) {
          handleCorrect(this);
        } else {
          handleWrong(this);
        }
      });
    });
  }

  function handleWrong(btn) {
    btn.style.borderColor = '#b33a3a';
    btn.style.background = 'rgba(239,68,68,0.15)';
    btn.classList.add('chosen');
    btn.style.pointerEvents = 'none';
    const fb = document.getElementById('peotd-feedback');
    fb.innerHTML = `<span style="color:#b33a3a;">${wrongMsgs[Math.floor(Math.random()*wrongMsgs.length)]}</span>`;
    streak = 0;
    localStorage.setItem('peotd-streak', '0');
    updateStreak();
  }

  function handleCorrect(btn) {
    btn.style.borderColor = 'var(--green)';
    btn.style.background = 'rgba(45,125,70,0.15)';
    btn.classList.add('chosen');
    document.querySelectorAll('.peotd-btn').forEach(b => b.style.pointerEvents = 'none');

    // Streak
    if (lastDay !== dayOfYear) {
      streak++;
      localStorage.setItem('peotd-streak', String(streak));
      localStorage.setItem('peotd-lastday', String(dayOfYear));
      localStorage.setItem('peotd-done', '1');
    }
    updateStreak();

    // Confetti!
    if (typeof confetti === 'function') {
      confetti({particleCount:150, spread:80, origin:{y:0.7}});
      setTimeout(() => confetti({particleCount:80, spread:100, origin:{y:0.5}}), 300);
      setTimeout(() => confetti({particleCount:60, spread:120, origin:{y:0.6}, colors:['#1e3a5f','#b8860b','#2a7a6f','#2d7d46']}), 600);
    }

    // Physicist popup
    const fb = document.getElementById('peotd-feedback');
    fb.innerHTML = `
      <div style="animation:peotdBounce 0.5s ease-out;margin:16px 0;">
        <div style="font-size:2.5rem;margin-bottom:6px;">üéâ</div>
        <div style="background:linear-gradient(135deg,rgba(45,125,70,0.15),rgba(30,58,95,0.1));border:1px solid rgba(45,125,70,0.3);border-radius:12px;padding:16px 20px;display:inline-block;max-width:400px;">
          <div style="font-weight:700;color:var(--green);font-size:1.1rem;margin-bottom:4px;">‚úÖ Correct! ‚Äî ${eq.name}</div>
          <div style="color:var(--text);font-size:0.95rem;font-style:italic;">${eq.quote}</div>
          <div style="color:var(--text-dim);font-size:0.85rem;margin-top:4px;">‚Äî ${eq.physicist}</div>
        </div>
      </div>
    `;

    // Reveal step 2 after a beat
    setTimeout(renderStep2, 1200);
  }

  function renderStep2() {
    const s2 = document.createElement('div');
    s2.style.cssText = 'margin-top:20px;animation:peotdFadeIn 0.6s ease-out;';
    s2.innerHTML = `
      <div style="background:var(--bg-alt);border:1px solid var(--card-border);border-radius:12px;padding:20px;">
        <h3 style="font-size:1.15rem;color:var(--accent2);margin-bottom:12px;">üìñ ${eq.name}</h3>
        <p style="font-size:1rem;line-height:1.7;margin-bottom:12px;color:var(--text);">${eq.explain}</p>
        <div style="font-size:0.95rem;color:var(--text-dim);margin-bottom:16px;"><strong style="color:var(--text);">Variables:</strong> ${eq.vars}</div>
        <div style="border-top:1px solid var(--card-border);padding-top:14px;">
          <div style="font-size:1rem;font-weight:600;color:var(--text);margin-bottom:10px;">üß™ Practice Problem</div>
          <p style="font-size:1rem;color:var(--text);margin-bottom:12px;">${eq.practice}</p>
          <button onclick="this.nextElementSibling.style.display=this.nextElementSibling.style.display==='block'?'none':'block';this.textContent=this.nextElementSibling.style.display==='block'?'Hide Answer ‚ñ≤':'Show Answer ‚ñº'" style="background:linear-gradient(135deg,var(--accent1),var(--accent2));border:none;color:#fff;font-family:'JetBrains Mono',monospace;font-size:0.9rem;padding:7px 18px;border-radius:8px;cursor:pointer;font-weight:600;">Show Answer ‚ñº</button>
          <div style="display:none;margin-top:12px;background:rgba(45,125,70,0.08);border:1px solid rgba(45,125,70,0.2);border-radius:8px;padding:14px;font-size:1rem;line-height:1.7;color:var(--green);">‚úÖ ${eq.practiceA}</div>
        </div>
      </div>
    `;
    el.appendChild(s2);
  }

  // If already completed today, show the full result
  if (alreadyCorrect) {
    el.innerHTML = `
      <div style="text-align:center;margin-bottom:16px;">
        <div style="background:var(--bg-alt);border:1px solid var(--card-border);border-radius:12px;padding:24px;margin:12px 0;font-size:1.3rem;font-weight:600;color:var(--accent2);line-height:1.8;overflow-x:auto;">${eq.eq}</div>
        <div style="margin:12px 0;font-size:1.1rem;color:var(--green);font-weight:600;">‚úÖ ${eq.name} ‚Äî Already nailed it today!</div>
        <div style="font-style:italic;color:var(--text-dim);font-size:0.95rem;">${eq.quote} ‚Äî ${eq.physicist}</div>
      </div>
      <div style="background:var(--bg-alt);border:1px solid var(--card-border);border-radius:12px;padding:20px;">
        <h3 style="font-size:1.15rem;color:var(--accent2);margin-bottom:12px;">üìñ ${eq.name}</h3>
        <p style="font-size:1rem;line-height:1.7;margin-bottom:12px;color:var(--text);">${eq.explain}</p>
        <div style="font-size:0.95rem;color:var(--text-dim);margin-bottom:16px;"><strong style="color:var(--text);">Variables:</strong> ${eq.vars}</div>
        <div style="border-top:1px solid var(--card-border);padding-top:14px;">
          <div style="font-size:1rem;font-weight:600;color:var(--text);margin-bottom:10px;">üß™ Practice Problem</div>
          <p style="font-size:1rem;color:var(--text);margin-bottom:12px;">${eq.practice}</p>
          <button onclick="this.nextElementSibling.style.display=this.nextElementSibling.style.display==='block'?'none':'block';this.textContent=this.nextElementSibling.style.display==='block'?'Hide Answer ‚ñ≤':'Show Answer ‚ñº'" style="background:linear-gradient(135deg,var(--accent1),var(--accent2));border:none;color:#fff;font-family:'JetBrains Mono',monospace;font-size:0.9rem;padding:7px 18px;border-radius:8px;cursor:pointer;font-weight:600;">Show Answer ‚ñº</button>
          <div style="display:none;margin-top:12px;background:rgba(45,125,70,0.08);border:1px solid rgba(45,125,70,0.2);border-radius:8px;padding:14px;font-size:1rem;line-height:1.7;color:var(--green);">‚úÖ ${eq.practiceA}</div>
        </div>
      </div>
    `;
  } else {
    renderStep1();
  }
})();
</script>

<style>
/* ‚îÄ‚îÄ Physics EOTD animations ‚îÄ‚îÄ */
@keyframes peotdBounce { 0%{transform:scale(0.5);opacity:0} 50%{transform:scale(1.05)} 100%{transform:scale(1);opacity:1} }
@keyframes peotdFadeIn { from{opacity:0;transform:translateY(12px)} to{opacity:1;transform:translateY(0)} }
@media (max-width: 640px) { #peotd-choices { grid-template-columns: 1fr !important; } }

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
/* MATH QOTD STYLES                              */
/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
@keyframes mqotdBounce { 0%{transform:scale(0.5);opacity:0} 50%{transform:scale(1.05)} 100%{transform:scale(1);opacity:1} }
@keyframes mqotdSlideIn { from{opacity:0;transform:translateY(16px)} to{opacity:1;transform:translateY(0)} }

.mqotd-cat-pill {
  background:rgba(184,134,11,0.2); color:var(--accent2); padding:4px 14px;
  border-radius:99px; font-size:0.85rem; font-weight:600;
}
.mqotd-eq-box {
  background:var(--bg-alt); border:1px solid var(--card-border); border-radius:12px;
  padding:24px; margin:12px 0; font-size:1.3rem; font-weight:600;
  color:var(--accent2); line-height:1.8; overflow-x:auto;
}
.mqotd-grid {
  display:grid; grid-template-columns:1fr 1fr; gap:10px;
}
.mqotd-btn {
  background:var(--card); border:2px solid var(--card-border); color:var(--text);
  font-family:'JetBrains Mono',monospace; font-size:0.95rem; padding:14px 12px;
  border-radius:10px; cursor:pointer; transition:all 0.2s; line-height:1.4; text-align:center;
}
.mqotd-btn:hover {
  border-color:var(--accent1); transform:translateY(-1px);
}

/* Explanation panel */
.mqotd-explain {
  background:var(--bg-alt); border:1px solid var(--card-border); border-radius:12px; padding:20px;
}
.mqotd-geo-callout {
  background:rgba(30,58,95,0.08); border:1px solid rgba(30,58,95,0.2);
  border-left:3px solid var(--accent1); border-radius:8px; padding:14px 16px; margin:14px 0;
}

/* Variables grid */
.mqotd-var-section { margin:16px 0; }
.mqotd-var-grid { display:grid; grid-template-columns:1fr; gap:8px; }
.mqotd-var {
  display:grid; grid-template-columns:auto 1fr; gap:12px; align-items:start;
  background:rgba(184,134,11,0.05); border:1px solid rgba(184,134,11,0.15);
  border-radius:8px; padding:10px 14px;
}
.mqotd-var-sym {
  font-weight:700; color:var(--accent2); white-space:nowrap; font-size:0.95rem;
}
.mqotd-var-mean {
  color:var(--text-dim); font-size:0.9rem; line-height:1.5;
}

/* Connections */
.mqotd-conn-section { margin:16px 0; }
.mqotd-conn {
  border-left:3px solid var(--accent3); padding:6px 12px; margin-bottom:6px;
  font-size:0.95rem; color:var(--text); line-height:1.5;
}

/* Practice steps */
.mqotd-practice {
  border-top:1px solid var(--card-border); padding-top:16px; margin-top:16px;
}
.mqotd-step {
  border-left:3px solid var(--accent1); padding:8px 14px; margin-bottom:8px;
  font-size:0.95rem; color:var(--text); line-height:1.5; border-radius:0 6px 6px 0;
  background:rgba(30,58,95,0.05);
}
.mqotd-step-num {
  color:var(--accent1); font-weight:600; margin-right:6px;
}
.mqotd-action-btn {
  background:linear-gradient(135deg,var(--accent1),var(--accent2)); border:none;
  color:#fff; font-family:'JetBrains Mono',monospace; font-size:0.9rem;
  padding:8px 18px; border-radius:8px; cursor:pointer; font-weight:600;
  transition:transform 0.15s,box-shadow 0.15s;
}
.mqotd-action-btn:hover {
  transform:translateY(-1px); box-shadow:0 4px 15px rgba(30,58,95,0.3);
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
/* CLAUDE FLOATING CHAT WIDGET                   */
/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
#claude-float {
  position:fixed; bottom:16px; right:16px; z-index:9999;
  width:360px;
  background:rgba(255,255,255,0.97); border:1px solid var(--accent1);
  border-radius:12px; box-shadow:0 8px 32px rgba(0,0,0,0.12);
  backdrop-filter:blur(12px);
  display:flex; flex-direction:column;
  transition:height 0.3s ease, width 0.3s ease;
  overflow:hidden;
}
#claude-float-header {
  display:flex; justify-content:space-between; align-items:center;
  padding:10px 16px; cursor:pointer; user-select:none;
  background:rgba(30,58,95,0.12); border-bottom:1px solid var(--card-border);
  font-size:0.95rem; font-weight:600; color:var(--text);
  flex-shrink:0;
}
#claude-float-header:hover { background:rgba(30,58,95,0.2); }
#claude-float-toggle {
  font-size:0.8rem; color:var(--text-dim); transition:transform 0.3s;
}
#claude-float-body {
  padding:12px 14px; overflow:hidden;
  max-height:420px; transition:max-height 0.3s ease, padding 0.3s ease;
}
#claude-float.collapsed #claude-float-body {
  max-height:0; padding-top:0; padding-bottom:0;
}
#claude-float.collapsed #claude-float-toggle {
  transform:rotate(-90deg);
}

.claude-key-section { padding:4px 0; }
.claude-messages {
  max-height:280px; overflow-y:auto; padding:6px 0; margin-bottom:8px;
  display:flex; flex-direction:column; gap:8px;
}
.claude-msg {
  padding:8px 12px; border-radius:10px; font-size:0.85rem; line-height:1.5;
  max-width:88%; word-wrap:break-word;
}
.claude-msg-user {
  background:rgba(30,58,95,0.15); border:1px solid rgba(30,58,95,0.25);
  color:var(--text); align-self:flex-end; border-bottom-right-radius:3px;
}
.claude-msg-assistant {
  background:rgba(184,134,11,0.1); border:1px solid rgba(184,134,11,0.2);
  color:var(--text); align-self:flex-start; border-bottom-left-radius:3px;
}
.claude-input-bar {
  display:flex; gap:8px;
}
.claude-small-btn {
  background:transparent; border:1px solid var(--card-border); color:var(--text-dim);
  font-family:'JetBrains Mono',monospace; font-size:0.7rem; padding:3px 8px;
  border-radius:6px; cursor:pointer; transition:border-color 0.2s;
}
.claude-small-btn:hover { border-color:var(--accent1); }
.claude-typing { color:var(--text-dim); animation:mqotdSlideIn 0.3s ease-out; }

/* ‚îÄ‚îÄ Mobile ‚îÄ‚îÄ */
@media (max-width: 640px) {
  .mqotd-grid { grid-template-columns:1fr; }
  .mqotd-var { grid-template-columns:1fr; }
  .claude-msg { max-width:95%; }
  #claude-float { width:calc(100vw - 24px); right:12px; bottom:12px; }
}
</style>

<!-- Big Picture -->
<div class="footer">
  <div style="font-size:0.72rem;color:var(--text-dim);">Riner Research Hub ¬∑ Built by Barron üê± ¬∑ <a href="../index.html">Back to Hub</a></div>
</div>
</div>
<script>
function toggle(header) { header.parentElement.classList.toggle('collapsed'); }
</script>
</body>
</html>