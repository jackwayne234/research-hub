<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lesson 08 -- Inequalities &amp; Absolute Value</title>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  :root {
    --bg: #1e2128;
    --card: #262a33;
    --border: #333a48;
    --text: #d4cfc4;
    --text-dim: #8a8578;
    --accent: #6366f1;
    --green: #22c55e;
    --pink: #ec4899;
    --orange: #f59e0b;
    --radius: 8px;
  }

  html { font-size: 16px; }

  body {
    font-family: 'JetBrains Mono', monospace;
    background: var(--bg);
    color: var(--text);
    line-height: 1.6;
    min-height: 100vh;
    padding: 1.5rem;
    max-width: 900px;
    margin: 0 auto;
  }

  /* ── Progress Bar ── */
  .progress-bar {
    display: flex;
    gap: 4px;
    margin-bottom: 2rem;
    height: 6px;
    border-radius: 3px;
    overflow: hidden;
  }
  .progress-bar .seg {
    flex: 1;
    background: var(--border);
    border-radius: 3px;
    transition: background 0.4s ease;
  }
  .progress-bar .seg.done { background: var(--accent); }

  /* ── Header ── */
  h1 {
    font-size: 1.4rem;
    font-weight: 600;
    margin-bottom: 0.25rem;
    color: var(--text);
  }
  .subtitle {
    font-size: 0.8rem;
    color: var(--text-dim);
    margin-bottom: 1.5rem;
  }

  /* ── Collapsible Cards ── */
  details {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    margin-bottom: 1rem;
    transition: border-color 0.3s;
  }
  details[open] { border-color: var(--accent); }
  details[open] summary { border-bottom: 1px solid var(--border); }

  summary {
    padding: 1rem 1.25rem;
    cursor: pointer;
    font-weight: 600;
    font-size: 1rem;
    list-style: none;
    display: flex;
    align-items: center;
    gap: 0.75rem;
    user-select: none;
  }
  summary::-webkit-details-marker { display: none; }
  summary::before {
    content: '';
    display: inline-block;
    width: 8px; height: 8px;
    border-right: 2px solid var(--accent);
    border-bottom: 2px solid var(--accent);
    transform: rotate(-45deg);
    transition: transform 0.25s;
    flex-shrink: 0;
  }
  details[open] summary::before { transform: rotate(45deg); }

  .section-body {
    padding: 1.25rem;
  }

  /* ── Typography ── */
  h2 { font-size: 1.1rem; font-weight: 600; margin-bottom: 1rem; color: var(--accent); }
  h3 { font-size: 0.95rem; font-weight: 600; margin: 1.25rem 0 0.5rem; color: var(--text); }
  p { margin-bottom: 0.75rem; font-size: 0.85rem; }
  .dim { color: var(--text-dim); }
  .accent { color: var(--accent); }
  .green { color: var(--green); }
  .pink { color: var(--pink); }
  .orange { color: var(--orange); }

  /* ── Math Display ── */
  .math-block {
    background: rgba(99,102,241,0.08);
    border: 1px solid rgba(99,102,241,0.2);
    border-radius: var(--radius);
    padding: 0.75rem 1rem;
    margin: 0.75rem 0;
    font-size: 0.9rem;
    text-align: center;
    line-height: 1.8;
  }

  /* ── Concept Box ── */
  .concept-box {
    background: rgba(34,197,94,0.06);
    border: 1px solid rgba(34,197,94,0.2);
    border-radius: var(--radius);
    padding: 0.75rem 1rem;
    margin: 0.75rem 0;
    font-size: 0.85rem;
  }
  .concept-box.warn {
    background: rgba(245,158,11,0.06);
    border-color: rgba(245,158,11,0.2);
  }
  .concept-box.info {
    background: rgba(99,102,241,0.06);
    border-color: rgba(99,102,241,0.2);
  }
  .concept-box.pink-box {
    background: rgba(236,72,153,0.06);
    border-color: rgba(236,72,153,0.2);
  }
  .concept-label {
    font-weight: 600;
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: 0.35rem;
  }

  /* ── SVG Number Lines ── */
  .nl-container {
    margin: 1rem 0;
    text-align: center;
    overflow-x: auto;
  }
  .nl-container svg {
    max-width: 100%;
  }

  /* ── Interactive Areas ── */
  .interactive-area {
    background: rgba(99,102,241,0.04);
    border: 1px dashed var(--border);
    border-radius: var(--radius);
    padding: 1rem;
    margin: 1rem 0;
  }
  .interactive-label {
    font-size: 0.7rem;
    color: var(--accent);
    text-transform: uppercase;
    letter-spacing: 0.08em;
    margin-bottom: 0.75rem;
    font-weight: 600;
  }

  /* ── Buttons ── */
  .btn {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.75rem;
    padding: 0.4rem 0.85rem;
    border-radius: 4px;
    border: 1px solid var(--border);
    background: var(--card);
    color: var(--text);
    cursor: pointer;
    transition: all 0.2s;
    white-space: nowrap;
  }
  .btn:hover { border-color: var(--accent); background: rgba(99,102,241,0.1); }
  .btn.active { background: var(--accent); color: #fff; border-color: var(--accent); }
  .btn.correct { background: var(--green); color: #fff; border-color: var(--green); }
  .btn.wrong { background: var(--pink); color: #fff; border-color: var(--pink); }
  .btn-row { display: flex; flex-wrap: wrap; gap: 0.5rem; margin: 0.75rem 0; }

  .btn-primary {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.8rem;
    padding: 0.5rem 1.2rem;
    border-radius: 4px;
    border: none;
    background: var(--accent);
    color: #fff;
    cursor: pointer;
    transition: all 0.2s;
  }
  .btn-primary:hover { opacity: 0.85; }
  .btn-primary:disabled { opacity: 0.4; cursor: not-allowed; }

  /* ── Input ── */
  .math-input {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.85rem;
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: 4px;
    padding: 0.4rem 0.6rem;
    color: var(--text);
    width: 80px;
    text-align: center;
    outline: none;
    transition: border-color 0.2s;
  }
  .math-input:focus { border-color: var(--accent); }
  .math-input.correct { border-color: var(--green); background: rgba(34,197,94,0.08); }
  .math-input.wrong { border-color: var(--pink); background: rgba(236,72,153,0.08); }

  /* ── Feedback ── */
  .feedback {
    font-size: 0.8rem;
    padding: 0.5rem 0.75rem;
    border-radius: 4px;
    margin-top: 0.5rem;
    display: none;
  }
  .feedback.show { display: block; }
  .feedback.correct { background: rgba(34,197,94,0.1); color: var(--green); }
  .feedback.wrong { background: rgba(236,72,153,0.1); color: var(--pink); }

  /* ── Comparison Side-by-Side ── */
  .compare-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
    margin: 1rem 0;
  }
  .compare-card {
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 0.75rem;
    font-size: 0.82rem;
  }
  .compare-card h4 {
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: 0.5rem;
  }

  /* ── Step tracker ── */
  .step-tracker {
    display: flex;
    flex-direction: column;
    gap: 0.3rem;
    margin: 0.75rem 0;
    font-size: 0.82rem;
  }
  .step-row {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.35rem 0.5rem;
    border-radius: 4px;
    transition: all 0.3s;
  }
  .step-row.active { background: rgba(99,102,241,0.1); }
  .step-row.completed { color: var(--green); }
  .step-row .step-num {
    width: 20px; height: 20px;
    border-radius: 50%;
    background: var(--border);
    display: flex; align-items: center; justify-content: center;
    font-size: 0.65rem;
    font-weight: 600;
    flex-shrink: 0;
  }
  .step-row.completed .step-num { background: var(--green); color: #fff; }
  .step-row.active .step-num { background: var(--accent); color: #fff; }

  /* ── Venn Diagram ── */
  .venn-container {
    text-align: center;
    margin: 1rem 0;
  }

  /* ── Quiz score ── */
  .score-display {
    font-size: 1.2rem;
    font-weight: 700;
    text-align: center;
    padding: 1rem;
    margin: 1rem 0;
    border-radius: var(--radius);
    background: rgba(99,102,241,0.08);
    border: 1px solid rgba(99,102,241,0.2);
  }

  /* ── Responsive ── */
  @media (max-width: 600px) {
    body { padding: 1rem; }
    h1 { font-size: 1.15rem; }
    .compare-grid { grid-template-columns: 1fr; }
    .math-block { font-size: 0.8rem; padding: 0.5rem 0.75rem; }
    .section-body { padding: 1rem; }
  }

  /* ── Animation helpers ── */
  .fade-in { animation: fadeIn 0.4s ease; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(6px); } to { opacity: 1; transform: translateY(0); } }

  .flash-green { animation: flashGreen 0.6s ease; }
  @keyframes flashGreen { 0%,100% { background: initial; } 50% { background: rgba(34,197,94,0.15); } }

  .flash-pink { animation: flashPink 0.6s ease; }
  @keyframes flashPink { 0%,100% { background: initial; } 50% { background: rgba(236,72,153,0.15); } }

  /* ── Draggable / clickable number line pieces ── */
  .nl-interactive { cursor: pointer; }
  .nl-interactive:hover { filter: brightness(1.3); }

  .circle-toggle {
    cursor: pointer;
    transition: all 0.2s;
  }
  .circle-toggle:hover {
    filter: drop-shadow(0 0 4px var(--accent));
  }

  /* ── Memory trick box ── */
  .memory-trick {
    background: rgba(245,158,11,0.08);
    border: 1px solid rgba(245,158,11,0.25);
    border-radius: var(--radius);
    padding: 0.75rem 1rem;
    margin: 0.75rem 0;
    text-align: center;
    font-size: 0.9rem;
  }
  .memory-trick .big { font-size: 1.1rem; font-weight: 700; }

  /* problem navigation */
  .prob-nav {
    display: flex;
    gap: 0.35rem;
    margin-bottom: 0.75rem;
  }
  .prob-dot {
    width: 24px; height: 24px;
    border-radius: 50%;
    border: 1px solid var(--border);
    background: var(--bg);
    color: var(--text-dim);
    font-size: 0.65rem;
    display: flex; align-items: center; justify-content: center;
    cursor: pointer;
    transition: all 0.2s;
    font-family: 'JetBrains Mono', monospace;
  }
  .prob-dot.active { border-color: var(--accent); color: var(--accent); }
  .prob-dot.correct { background: var(--green); color: #fff; border-color: var(--green); }
  .prob-dot.wrong { background: var(--pink); color: #fff; border-color: var(--pink); }

  /* select dropdown */
  .math-select {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.8rem;
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: 4px;
    padding: 0.35rem 0.5rem;
    color: var(--text);
    outline: none;
    cursor: pointer;
  }
  .math-select:focus { border-color: var(--accent); }
</style>
</head>
<body>

<!-- Progress Bar -->
<div class="progress-bar" id="progressBar">
  <div class="seg" data-section="1"></div>
  <div class="seg" data-section="2"></div>
  <div class="seg" data-section="3"></div>
  <div class="seg" data-section="4"></div>
  <div class="seg" data-section="5"></div>
</div>

<h1>Week 5: Inequalities &amp; Absolute Value</h1>
<p class="subtitle">Lesson 08 -- Comparing, graphing, and solving with distance</p>

<!-- ══════════════════════════════════════════════════════════ -->
<!-- SECTION 1: Solving Linear Inequalities                    -->
<!-- ══════════════════════════════════════════════════════════ -->
<details id="section1" open>
  <summary>1. Solving Linear Inequalities</summary>
  <div class="section-body">

    <h2>Equations vs. Inequalities</h2>
    <p>Solving an inequality uses the <span class="accent">exact same algebra</span> as solving an equation -- add, subtract, multiply, divide both sides -- with <strong>one critical exception</strong>.</p>

    <div class="compare-grid">
      <div class="compare-card">
        <h4 class="green">Equation</h4>
        <div style="font-size:0.85rem; line-height:1.8;">
          2x + 3 = 11<br>
          2x = 8<br>
          x = 4
        </div>
        <p class="dim" style="margin-top:0.5rem; font-size:0.75rem;">One exact answer</p>
      </div>
      <div class="compare-card">
        <h4 class="accent">Inequality</h4>
        <div style="font-size:0.85rem; line-height:1.8;">
          2x + 3 &lt; 11<br>
          2x &lt; 8<br>
          x &lt; 4
        </div>
        <p class="dim" style="margin-top:0.5rem; font-size:0.75rem;">A range of answers</p>
      </div>
    </div>

    <div class="concept-box warn">
      <div class="concept-label orange">Critical Rule</div>
      <p style="margin:0;">When you <strong>multiply or divide both sides by a negative number</strong>, the inequality sign <strong>flips direction</strong>.</p>
      <div class="math-block" style="margin-top:0.5rem;">
        -3x &gt; 12 &rarr; divide by -3 &rarr; x <span class="pink">&lt;</span> -4
      </div>
    </div>

    <h3>Why Does the Sign Flip?</h3>
    <p>Watch this animated demo. We start with a true statement and multiply both sides by -1.</p>

    <div class="interactive-area" id="flipDemo">
      <div class="interactive-label">Animated Demo</div>
      <div class="nl-container" id="flipNL"></div>
      <div style="text-align:center; margin-top:0.75rem;">
        <div id="flipText" style="font-size:0.9rem; margin-bottom:0.5rem; min-height:1.6em;">
          Start: <span class="green">-2 &lt; 3</span> &mdash; True!
        </div>
        <button class="btn-primary" id="flipBtn" onclick="runFlipDemo()">Multiply Both Sides by -1</button>
      </div>
    </div>

    <h3>Interactive Step-by-Step Solver</h3>
    <p class="dim">Solve each inequality by choosing the correct operation at each step.</p>

    <div class="interactive-area" id="ineqSolver">
      <div class="interactive-label">Step-by-Step Solver</div>
      <div class="prob-nav" id="s1ProbNav"></div>
      <div id="s1Problem" class="math-block" style="font-size:1rem;"></div>
      <div class="step-tracker" id="s1Steps"></div>
      <div id="s1Actions" class="btn-row"></div>
      <div class="nl-container" id="s1NL"></div>
      <div id="s1Feedback" class="feedback"></div>
    </div>

  </div>
</details>

<!-- ══════════════════════════════════════════════════════════ -->
<!-- SECTION 2: Graphing on Number Lines                       -->
<!-- ══════════════════════════════════════════════════════════ -->
<details id="section2">
  <summary>2. Graphing on Number Lines</summary>
  <div class="section-body">

    <h2>Open vs. Closed Circles</h2>
    <p>The type of circle at the endpoint tells you whether that value is <strong>included</strong> in the solution.</p>

    <div class="compare-grid">
      <div class="compare-card">
        <h4 class="pink">Open Circle &mdash; &lt; or &gt;</h4>
        <p style="margin:0; font-size:0.8rem;">The endpoint is <strong>NOT</strong> included.<br>"Strictly less/greater than"</p>
        <div class="nl-container" style="margin-top:0.5rem;">
          <svg viewBox="0 0 300 40" width="260" height="40">
            <line x1="20" y1="20" x2="280" y2="20" stroke="#333a48" stroke-width="2"/>
            <circle cx="150" cy="20" r="6" fill="none" stroke="#ec4899" stroke-width="2"/>
            <line x1="20" y1="20" x2="144" y2="20" stroke="#ec4899" stroke-width="3" stroke-linecap="round"/>
            <polygon points="20,15 10,20 20,25" fill="#ec4899"/>
            <text x="150" y="38" fill="#8a8578" font-size="10" text-anchor="middle" font-family="JetBrains Mono">3</text>
          </svg>
        </div>
        <p class="dim" style="font-size:0.75rem; text-align:center;">x &lt; 3</p>
      </div>
      <div class="compare-card">
        <h4 class="green">Closed Circle &mdash; &le; or &ge;</h4>
        <p style="margin:0; font-size:0.8rem;">The endpoint <strong>IS</strong> included.<br>"Less/greater than or equal to"</p>
        <div class="nl-container" style="margin-top:0.5rem;">
          <svg viewBox="0 0 300 40" width="260" height="40">
            <line x1="20" y1="20" x2="280" y2="20" stroke="#333a48" stroke-width="2"/>
            <circle cx="150" cy="20" r="6" fill="#22c55e" stroke="#22c55e" stroke-width="2"/>
            <line x1="150" y1="20" x2="280" y2="20" stroke="#22c55e" stroke-width="3" stroke-linecap="round"/>
            <polygon points="280,15 290,20 280,25" fill="#22c55e"/>
            <text x="150" y="38" fill="#8a8578" font-size="10" text-anchor="middle" font-family="JetBrains Mono">3</text>
          </svg>
        </div>
        <p class="dim" style="font-size:0.75rem; text-align:center;">x &ge; 3</p>
      </div>
    </div>

    <h3>Build the Graph</h3>
    <p class="dim">Read the inequality, then click the endpoint to toggle open/closed and click left or right of it to set the shading direction.</p>

    <div class="interactive-area" id="graphBuilder">
      <div class="interactive-label">Graph Builder</div>
      <div class="prob-nav" id="s2ProbNav"></div>
      <div id="s2Problem" class="math-block" style="font-size:1rem;"></div>
      <div class="nl-container" id="s2NL"></div>
      <p id="s2Hint" class="dim" style="font-size:0.75rem; text-align:center;">Click the dot to toggle open/closed. Click left or right to shade.</p>
      <div style="text-align:center; margin-top:0.5rem;">
        <button class="btn-primary" id="s2Check" onclick="checkGraph()">Check My Graph</button>
      </div>
      <div id="s2Feedback" class="feedback"></div>
    </div>

  </div>
</details>

<!-- ══════════════════════════════════════════════════════════ -->
<!-- SECTION 3: Compound Inequalities                          -->
<!-- ══════════════════════════════════════════════════════════ -->
<details id="section3">
  <summary>3. Compound Inequalities</summary>
  <div class="section-body">

    <h2>AND vs. OR</h2>
    <p>Compound inequalities combine two conditions. The key is whether <strong>both</strong> must be true or <strong>either</strong> can be true.</p>

    <div class="compare-grid">
      <div class="compare-card">
        <h4 class="green">AND (Intersection)</h4>
        <p style="margin:0; font-size:0.8rem;">Both conditions must be true at the same time. Result: the <strong>overlap</strong>.</p>
        <div class="math-block">x &gt; -2 <span class="green">AND</span> x &lt; 5</div>
        <p class="dim" style="font-size:0.75rem;">"Between" notation: -2 &lt; x &lt; 5</p>
      </div>
      <div class="compare-card">
        <h4 class="orange">OR (Union)</h4>
        <p style="margin:0; font-size:0.8rem;">At least one condition must be true. Result: <strong>everything</strong> shaded.</p>
        <div class="math-block">x &lt; -2 <span class="orange">OR</span> x &gt; 5</div>
        <p class="dim" style="font-size:0.75rem;">Two separate regions</p>
      </div>
    </div>

    <h3>Venn Diagram</h3>
    <div class="venn-container">
      <svg viewBox="0 0 400 180" width="380" height="170">
        <!-- AND diagram -->
        <text x="100" y="18" fill="#d4cfc4" font-size="12" text-anchor="middle" font-family="JetBrains Mono" font-weight="600">AND = Intersection</text>
        <circle cx="75" cy="90" r="50" fill="rgba(99,102,241,0.15)" stroke="#6366f1" stroke-width="1.5"/>
        <circle cx="125" cy="90" r="50" fill="rgba(34,197,94,0.15)" stroke="#22c55e" stroke-width="1.5"/>
        <!-- highlight overlap -->
        <clipPath id="clipA"><circle cx="75" cy="90" r="50"/></clipPath>
        <circle cx="125" cy="90" r="50" fill="rgba(245,158,11,0.35)" clip-path="url(#clipA)"/>
        <text x="52" y="95" fill="#6366f1" font-size="10" text-anchor="middle" font-family="JetBrains Mono">A</text>
        <text x="148" y="95" fill="#22c55e" font-size="10" text-anchor="middle" font-family="JetBrains Mono">B</text>
        <text x="100" y="95" fill="#f59e0b" font-size="9" text-anchor="middle" font-family="JetBrains Mono" font-weight="600">A&amp;B</text>
        <text x="100" y="160" fill="#8a8578" font-size="9" text-anchor="middle" font-family="JetBrains Mono">Only the overlap</text>

        <!-- OR diagram -->
        <text x="300" y="18" fill="#d4cfc4" font-size="12" text-anchor="middle" font-family="JetBrains Mono" font-weight="600">OR = Union</text>
        <circle cx="275" cy="90" r="50" fill="rgba(99,102,241,0.3)" stroke="#6366f1" stroke-width="1.5"/>
        <circle cx="325" cy="90" r="50" fill="rgba(34,197,94,0.3)" stroke="#22c55e" stroke-width="1.5"/>
        <text x="252" y="95" fill="#6366f1" font-size="10" text-anchor="middle" font-family="JetBrains Mono">A</text>
        <text x="348" y="95" fill="#22c55e" font-size="10" text-anchor="middle" font-family="JetBrains Mono">B</text>
        <text x="300" y="95" fill="#d4cfc4" font-size="9" text-anchor="middle" font-family="JetBrains Mono" font-weight="600">A|B</text>
        <text x="300" y="160" fill="#8a8578" font-size="9" text-anchor="middle" font-family="JetBrains Mono">Everything included</text>
      </svg>
    </div>

    <h3>Interactive: AND vs. OR on the Number Line</h3>
    <p class="dim">Two inequality regions are shown. Toggle between AND and OR to see the result.</p>

    <div class="interactive-area" id="compoundDemo">
      <div class="interactive-label">Compound Inequality Visualizer</div>
      <div class="prob-nav" id="s3ProbNav"></div>
      <div id="s3Problem" class="math-block" style="font-size:0.95rem;"></div>
      <div class="btn-row" style="justify-content:center;">
        <button class="btn" id="s3AndBtn" onclick="setCompoundMode('and')">AND (Intersection)</button>
        <button class="btn" id="s3OrBtn" onclick="setCompoundMode('or')">OR (Union)</button>
      </div>
      <div class="nl-container" id="s3NL"></div>
      <div id="s3Result" style="text-align:center; font-size:0.85rem; margin-top:0.5rem;"></div>
    </div>

    <h3>Practice</h3>
    <div class="interactive-area" id="compoundPractice">
      <div class="interactive-label">Compound Inequality Problems</div>
      <div class="prob-nav" id="s3PracNav"></div>
      <div id="s3PracProblem" class="math-block" style="font-size:0.95rem;"></div>
      <p id="s3PracQ" style="text-align:center; font-size:0.85rem;"></p>
      <div class="btn-row" style="justify-content:center;" id="s3PracBtns"></div>
      <div id="s3PracFeedback" class="feedback"></div>
    </div>

  </div>
</details>

<!-- ══════════════════════════════════════════════════════════ -->
<!-- SECTION 4: Absolute Value Equations & Inequalities        -->
<!-- ══════════════════════════════════════════════════════════ -->
<details id="section4">
  <summary>4. Absolute Value Equations &amp; Inequalities</summary>
  <div class="section-body">

    <h2>What IS Absolute Value?</h2>
    <p>Absolute value = the <strong>distance</strong> from zero on the number line. Distance is always non-negative.</p>

    <div class="math-block">
      |5| = 5 &nbsp;&nbsp;&nbsp; |-5| = 5 &nbsp;&nbsp;&nbsp; |0| = 0
    </div>

    <div class="nl-container">
      <svg viewBox="0 0 500 60" width="480" height="60">
        <line x1="20" y1="30" x2="480" y2="30" stroke="#333a48" stroke-width="2"/>
        <!-- ticks -->
        <line x1="50" y1="25" x2="50" y2="35" stroke="#555" stroke-width="1.5"/>
        <text x="50" y="50" fill="#8a8578" font-size="10" text-anchor="middle" font-family="JetBrains Mono">-5</text>
        <line x1="250" y1="22" x2="250" y2="38" stroke="#6366f1" stroke-width="2"/>
        <text x="250" y="50" fill="#6366f1" font-size="10" text-anchor="middle" font-family="JetBrains Mono" font-weight="600">0</text>
        <line x1="450" y1="25" x2="450" y2="35" stroke="#555" stroke-width="1.5"/>
        <text x="450" y="50" fill="#8a8578" font-size="10" text-anchor="middle" font-family="JetBrains Mono">5</text>
        <!-- arrows showing distance -->
        <line x1="50" y1="14" x2="250" y2="14" stroke="#ec4899" stroke-width="1.5" stroke-dasharray="4,3"/>
        <text x="150" y="11" fill="#ec4899" font-size="9" text-anchor="middle" font-family="JetBrains Mono">distance = 5</text>
        <line x1="250" y1="14" x2="450" y2="14" stroke="#22c55e" stroke-width="1.5" stroke-dasharray="4,3"/>
        <text x="350" y="11" fill="#22c55e" font-size="9" text-anchor="middle" font-family="JetBrains Mono">distance = 5</text>
      </svg>
    </div>

    <h3>Absolute Value Equations</h3>
    <p>When |expression| = k, there are <strong>two</strong> solutions: the expression could equal k or -k.</p>

    <div class="concept-box info">
      <div class="concept-label accent">The Split Rule</div>
      <div class="math-block" style="margin:0.5rem 0;">
        |x - a| = b &nbsp;&rarr;&nbsp; x - a = b &nbsp; OR &nbsp; x - a = -b
      </div>
      <p style="margin:0; font-size:0.8rem;">Two points equidistant from <em>a</em> on the number line.</p>
    </div>

    <h3>Interactive: See the Two Solutions</h3>
    <div class="interactive-area" id="absEqDemo">
      <div class="interactive-label">Absolute Value Equation Visualizer</div>
      <p style="font-size:0.85rem; text-align:center; margin-bottom:0.5rem;">
        |x - <input type="number" id="absA" class="math-input" value="2" style="width:50px;" min="-8" max="8">| =
        <input type="number" id="absB" class="math-input" value="3" style="width:50px;" min="0" max="10">
      </p>
      <div style="text-align:center; margin-bottom:0.5rem;">
        <button class="btn-primary" onclick="updateAbsViz()">Show Solutions</button>
      </div>
      <div class="nl-container" id="absEqNL"></div>
      <div id="absEqResult" style="text-align:center; font-size:0.85rem;"></div>
    </div>

    <h3>Absolute Value Inequalities</h3>
    <p>The type of inequality determines whether you get an AND or OR result.</p>

    <div class="compare-grid">
      <div class="compare-card">
        <h4 class="green">|x| &lt; k &rarr; AND (between)</h4>
        <div class="math-block">|x| &lt; 3 &rarr; -3 &lt; x &lt; 3</div>
        <p class="dim" style="font-size:0.75rem;">Within distance k of zero</p>
      </div>
      <div class="compare-card">
        <h4 class="orange">|x| &gt; k &rarr; OR (outside)</h4>
        <div class="math-block">|x| &gt; 3 &rarr; x &lt; -3 OR x &gt; 3</div>
        <p class="dim" style="font-size:0.75rem;">More than distance k from zero</p>
      </div>
    </div>

    <div class="memory-trick">
      <div class="concept-label orange">Memory Trick</div>
      <div class="big" style="margin:0.5rem 0;">
        Less th<span class="green">AND</span> &nbsp;&nbsp;|&nbsp;&nbsp; Great<span class="orange">OR</span>
      </div>
      <p class="dim" style="margin:0; font-size:0.75rem;">&lt; gives AND (between) &nbsp;&mdash;&nbsp; &gt; gives OR (outside)</p>
    </div>

    <h3>Practice</h3>
    <div class="interactive-area" id="absPractice">
      <div class="interactive-label">Absolute Value Problems</div>
      <div class="prob-nav" id="s4ProbNav"></div>
      <div id="s4Problem" class="math-block" style="font-size:0.95rem;"></div>
      <div id="s4Input" style="text-align:center; margin:0.75rem 0;"></div>
      <div style="text-align:center;">
        <button class="btn-primary" onclick="checkAbsProblem()">Check Answer</button>
      </div>
      <div id="s4Feedback" class="feedback"></div>
    </div>

  </div>
</details>

<!-- ══════════════════════════════════════════════════════════ -->
<!-- SECTION 5: Quick Quiz                                     -->
<!-- ══════════════════════════════════════════════════════════ -->
<details id="section5">
  <summary>5. Quick Quiz (10 Questions)</summary>
  <div class="section-body">

    <h2>Mixed Review</h2>
    <p class="dim">Test everything from this lesson. Each question is worth 1 point.</p>

    <div class="score-display" id="quizScore">Score: 0 / 10</div>

    <div class="prob-nav" id="quizNav"></div>
    <div id="quizArea">
      <div id="quizQuestion" class="math-block" style="font-size:0.95rem;"></div>
      <div id="quizChoices" class="btn-row" style="justify-content:center; margin-top:1rem;"></div>
      <div id="quizFeedback" class="feedback"></div>
      <div style="text-align:center; margin-top:0.75rem;">
        <button class="btn-primary" id="quizNext" onclick="nextQuizQ()" style="display:none;">Next Question</button>
      </div>
    </div>

    <div id="quizFinal" style="display:none; text-align:center; padding:2rem 0;">
      <div id="quizFinalScore" class="score-display" style="font-size:1.5rem;"></div>
      <p id="quizFinalMsg" style="margin-top:0.75rem;"></p>
      <button class="btn-primary" onclick="restartQuiz()" style="margin-top:1rem;">Retake Quiz</button>
    </div>

  </div>
</details>

<!-- ══════════════════════════════════════════════════════════ -->
<!-- JavaScript                                                -->
<!-- ══════════════════════════════════════════════════════════ -->
<script>
/* ───────────────────────────────────────────────
   Utility: Draw a number line as SVG
   ─────────────────────────────────────────────── */
function drawNumberLine(containerId, options = {}) {
  const {
    min = -10, max = 10, width = 520, height = 55,
    highlights = [], // [{from, to, color, open_left, open_right}]
    points = [],     // [{value, color, open, label}]
    arrowLeft = false, arrowRight = false
  } = options;

  const pad = 30;
  const lineY = 25;
  const usable = width - 2 * pad;

  function xPos(val) {
    return pad + ((val - min) / (max - min)) * usable;
  }

  let svg = `<svg viewBox="0 0 ${width} ${height}" width="${Math.min(width, 500)}" height="${height}">`;

  // highlights (shaded regions)
  highlights.forEach(h => {
    const x1 = h.from === -Infinity ? 0 : xPos(h.from);
    const x2 = h.to === Infinity ? width : xPos(h.to);
    svg += `<rect x="${x1}" y="${lineY - 8}" width="${x2 - x1}" height="16" fill="${h.color || 'rgba(99,102,241,0.25)'}" rx="2"/>`;
    // arrows at infinity
    if (h.from === -Infinity) {
      svg += `<polygon points="${pad - 5},${lineY - 5} ${pad - 15},${lineY} ${pad - 5},${lineY + 5}" fill="${h.color || 'rgba(99,102,241,0.5)'}"/>`;
    }
    if (h.to === Infinity) {
      svg += `<polygon points="${width - pad + 5},${lineY - 5} ${width - pad + 15},${lineY} ${width - pad + 5},${lineY + 5}" fill="${h.color || 'rgba(99,102,241,0.5)'}"/>`;
    }
  });

  // base line
  svg += `<line x1="${pad - 10}" y1="${lineY}" x2="${width - pad + 10}" y2="${lineY}" stroke="#555" stroke-width="2"/>`;
  // end arrows
  svg += `<polygon points="${pad - 10},${lineY - 4} ${pad - 18},${lineY} ${pad - 10},${lineY + 4}" fill="#555"/>`;
  svg += `<polygon points="${width - pad + 10},${lineY - 4} ${width - pad + 18},${lineY} ${width - pad + 10},${lineY + 4}" fill="#555"/>`;

  // ticks
  for (let v = min; v <= max; v++) {
    const x = xPos(v);
    const isMajor = v % 5 === 0 || v === 0;
    const tickH = isMajor ? 8 : 4;
    svg += `<line x1="${x}" y1="${lineY - tickH}" x2="${x}" y2="${lineY + tickH}" stroke="${v === 0 ? '#6366f1' : '#555'}" stroke-width="${isMajor ? 1.5 : 1}"/>`;
    if (isMajor || (max - min <= 14)) {
      svg += `<text x="${x}" y="${lineY + tickH + 12}" fill="${v === 0 ? '#6366f1' : '#8a8578'}" font-size="9" text-anchor="middle" font-family="JetBrains Mono">${v}</text>`;
    }
  }

  // points
  points.forEach(pt => {
    const x = xPos(pt.value);
    if (pt.open) {
      svg += `<circle cx="${x}" cy="${lineY}" r="5" fill="#262a33" stroke="${pt.color || '#6366f1'}" stroke-width="2"/>`;
    } else {
      svg += `<circle cx="${x}" cy="${lineY}" r="5" fill="${pt.color || '#6366f1'}" stroke="${pt.color || '#6366f1'}" stroke-width="2"/>`;
    }
    if (pt.label) {
      svg += `<text x="${x}" y="${lineY - 10}" fill="${pt.color || '#6366f1'}" font-size="9" text-anchor="middle" font-family="JetBrains Mono" font-weight="600">${pt.label}</text>`;
    }
  });

  svg += '</svg>';
  document.getElementById(containerId).innerHTML = svg;
}

/* ───────────────────────────────────────────────
   Progress Tracking
   ─────────────────────────────────────────────── */
const sectionComplete = { 1: false, 2: false, 3: false, 4: false, 5: false };

function markSectionDone(n) {
  sectionComplete[n] = true;
  const seg = document.querySelector(`.progress-bar .seg[data-section="${n}"]`);
  if (seg) seg.classList.add('done');
}

function checkSectionProgress(section, completed, total) {
  if (completed >= total) markSectionDone(section);
}

/* ───────────────────────────────────────────────
   SECTION 1: Flip Demo
   ─────────────────────────────────────────────── */
let flipState = 0;

function initFlipDemo() {
  flipState = 0;
  drawFlipNL();
}

function drawFlipNL() {
  const container = 'flipNL';
  const w = 460, h = 55, pad = 40, lineY = 25;
  const usable = w - 2 * pad;
  function xPos(val) { return pad + ((val - (-5)) / 10) * usable; }

  let svg = `<svg viewBox="0 0 ${w} ${h}" width="${Math.min(w, 440)}" height="${h}">`;
  svg += `<line x1="${pad - 10}" y1="${lineY}" x2="${w - pad + 10}" y2="${lineY}" stroke="#555" stroke-width="2"/>`;
  svg += `<polygon points="${pad - 10},${lineY - 4} ${pad - 18},${lineY} ${pad - 10},${lineY + 4}" fill="#555"/>`;
  svg += `<polygon points="${w - pad + 10},${lineY - 4} ${w - pad + 18},${lineY} ${w - pad + 10},${lineY + 4}" fill="#555"/>`;

  for (let v = -5; v <= 5; v++) {
    const x = xPos(v);
    svg += `<line x1="${x}" y1="${lineY - 5}" x2="${x}" y2="${lineY + 5}" stroke="${v === 0 ? '#6366f1' : '#555'}" stroke-width="1.5"/>`;
    svg += `<text x="${x}" y="${lineY + 18}" fill="${v === 0 ? '#6366f1' : '#8a8578'}" font-size="9" text-anchor="middle" font-family="JetBrains Mono">${v}</text>`;
  }

  if (flipState === 0) {
    // show -2 and 3
    const x1 = xPos(-2), x2 = xPos(3);
    svg += `<circle cx="${x1}" cy="${lineY}" r="6" fill="#ec4899" stroke="#ec4899" stroke-width="2"/>`;
    svg += `<text x="${x1}" y="${lineY - 10}" fill="#ec4899" font-size="10" text-anchor="middle" font-family="JetBrains Mono" font-weight="600">-2</text>`;
    svg += `<circle cx="${x2}" cy="${lineY}" r="6" fill="#22c55e" stroke="#22c55e" stroke-width="2"/>`;
    svg += `<text x="${x2}" y="${lineY - 10}" fill="#22c55e" font-size="10" text-anchor="middle" font-family="JetBrains Mono" font-weight="600">3</text>`;
    // arrow from -2 to 3
    svg += `<line x1="${x1 + 8}" y1="${lineY - 16}" x2="${x2 - 8}" y2="${lineY - 16}" stroke="#f59e0b" stroke-width="1.5" marker-end="url(#arrowY)"/>`;
    svg += `<defs><marker id="arrowY" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto"><path d="M0,0 L6,3 L0,6" fill="#f59e0b"/></marker></defs>`;
    svg += `<text x="${(x1 + x2) / 2}" y="${lineY - 20}" fill="#f59e0b" font-size="8" text-anchor="middle" font-family="JetBrains Mono">-2 is left of 3</text>`;
  } else {
    // show 2 and -3 (after multiply by -1)
    const x1 = xPos(2), x2 = xPos(-3);
    svg += `<circle cx="${x1}" cy="${lineY}" r="6" fill="#ec4899" stroke="#ec4899" stroke-width="2"/>`;
    svg += `<text x="${x1}" y="${lineY - 10}" fill="#ec4899" font-size="10" text-anchor="middle" font-family="JetBrains Mono" font-weight="600">2</text>`;
    svg += `<circle cx="${x2}" cy="${lineY}" r="6" fill="#22c55e" stroke="#22c55e" stroke-width="2"/>`;
    svg += `<text x="${x2}" y="${lineY - 10}" fill="#22c55e" font-size="10" text-anchor="middle" font-family="JetBrains Mono" font-weight="600">-3</text>`;
    // arrow from -3 to 2 showing 2 is right now
    svg += `<line x1="${x2 + 8}" y1="${lineY - 16}" x2="${x1 - 8}" y2="${lineY - 16}" stroke="#f59e0b" stroke-width="1.5" marker-end="url(#arrowY2)"/>`;
    svg += `<defs><marker id="arrowY2" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto"><path d="M0,0 L6,3 L0,6" fill="#f59e0b"/></marker></defs>`;
    svg += `<text x="${(x1 + x2) / 2}" y="${lineY - 20}" fill="#f59e0b" font-size="8" text-anchor="middle" font-family="JetBrains Mono">2 is RIGHT of -3!</text>`;
  }

  svg += '</svg>';
  document.getElementById(container).innerHTML = svg;
}

function runFlipDemo() {
  const btn = document.getElementById('flipBtn');
  const txt = document.getElementById('flipText');
  if (flipState === 0) {
    flipState = 1;
    txt.innerHTML = 'Multiply by -1: (-1)(-2) = <span class="pink">2</span>, (-1)(3) = <span class="green">-3</span><br>Now <span class="pink">2</span> <span class="orange">&gt;</span> <span class="green">-3</span> -- The sign <strong>flipped!</strong>';
    btn.textContent = 'Reset';
    drawFlipNL();
  } else {
    flipState = 0;
    txt.innerHTML = 'Start: <span class="green">-2 &lt; 3</span> -- True!';
    btn.textContent = 'Multiply Both Sides by -1';
    drawFlipNL();
  }
}

/* ───────────────────────────────────────────────
   SECTION 1: Step-by-Step Solver
   ─────────────────────────────────────────────── */
const s1Problems = [
  {
    display: '2x + 5 < 13',
    steps: [
      { instruction: 'Subtract 5 from both sides', choices: ['Subtract 5', 'Add 5', 'Divide by 2'], correct: 0, result: '2x < 8' },
      { instruction: 'Divide both sides by 2', choices: ['Divide by 2', 'Multiply by 2', 'Subtract 2'], correct: 0, result: 'x < 4' }
    ],
    answer: { op: '<', val: 4 }
  },
  {
    display: '-3x + 6 > 15',
    steps: [
      { instruction: 'Subtract 6 from both sides', choices: ['Subtract 6', 'Add 6', 'Divide by -3'], correct: 0, result: '-3x > 9' },
      { instruction: 'Divide by -3 (flip the sign!)', choices: ['x > -3', 'x < -3', 'x = -3'], correct: 1, result: 'x < -3' }
    ],
    answer: { op: '<', val: -3 }
  },
  {
    display: '4x - 7 >= 9',
    steps: [
      { instruction: 'Add 7 to both sides', choices: ['Add 7', 'Subtract 7', 'Divide by 4'], correct: 0, result: '4x >= 16' },
      { instruction: 'Divide both sides by 4', choices: ['x >= 4', 'x <= 4', 'x > 4'], correct: 0, result: 'x >= 4' }
    ],
    answer: { op: '>=', val: 4 }
  },
  {
    display: '-2x - 1 <= 7',
    steps: [
      { instruction: 'Add 1 to both sides', choices: ['Add 1', 'Subtract 1', 'Multiply by -2'], correct: 0, result: '-2x <= 8' },
      { instruction: 'Divide by -2 (flip the sign!)', choices: ['x <= -4', 'x >= -4', 'x > -4'], correct: 1, result: 'x >= -4' }
    ],
    answer: { op: '>=', val: -4 }
  },
  {
    display: '5 - x > 2',
    steps: [
      { instruction: 'Subtract 5 from both sides', choices: ['Subtract 5', 'Add 5', 'Multiply by -1'], correct: 0, result: '-x > -3' },
      { instruction: 'Multiply by -1 (flip the sign!)', choices: ['x > 3', 'x < 3', 'x = 3'], correct: 1, result: 'x < 3' }
    ],
    answer: { op: '<', val: 3 }
  }
];

let s1Current = 0;
let s1Step = 0;
let s1Completed = new Set();

function initS1() {
  const nav = document.getElementById('s1ProbNav');
  nav.innerHTML = '';
  for (let i = 0; i < s1Problems.length; i++) {
    const dot = document.createElement('div');
    dot.className = 'prob-dot' + (i === 0 ? ' active' : '');
    dot.textContent = i + 1;
    dot.onclick = () => loadS1Problem(i);
    nav.appendChild(dot);
  }
  loadS1Problem(0);
}

function loadS1Problem(idx) {
  s1Current = idx;
  s1Step = 0;
  document.getElementById('s1Problem').textContent = s1Problems[idx].display;
  document.getElementById('s1Feedback').className = 'feedback';
  document.getElementById('s1Feedback').textContent = '';

  // update nav
  document.querySelectorAll('#s1ProbNav .prob-dot').forEach((d, i) => {
    d.className = 'prob-dot' + (i === idx ? ' active' : '') + (s1Completed.has(i) ? ' correct' : '');
  });

  // build step tracker
  const stepsDiv = document.getElementById('s1Steps');
  stepsDiv.innerHTML = '';
  s1Problems[idx].steps.forEach((step, i) => {
    const row = document.createElement('div');
    row.className = 'step-row' + (i === 0 ? ' active' : '');
    row.id = `s1Step${i}`;
    row.innerHTML = `<div class="step-num">${i + 1}</div><span>${step.instruction}</span>`;
    stepsDiv.appendChild(row);
  });

  showS1Actions();

  // clear number line
  document.getElementById('s1NL').innerHTML = '';
}

function showS1Actions() {
  const prob = s1Problems[s1Current];
  if (s1Step >= prob.steps.length) {
    // done
    document.getElementById('s1Actions').innerHTML = '';
    showS1Result();
    return;
  }
  const step = prob.steps[s1Step];
  const div = document.getElementById('s1Actions');
  div.innerHTML = '';
  step.choices.forEach((ch, i) => {
    const btn = document.createElement('button');
    btn.className = 'btn';
    btn.textContent = ch;
    btn.onclick = () => handleS1Choice(i);
    div.appendChild(btn);
  });
}

function handleS1Choice(choiceIdx) {
  const prob = s1Problems[s1Current];
  const step = prob.steps[s1Step];
  const fb = document.getElementById('s1Feedback');
  const btns = document.querySelectorAll('#s1Actions .btn');

  if (choiceIdx === step.correct) {
    btns[choiceIdx].classList.add('correct');
    fb.textContent = 'Correct! ' + step.result;
    fb.className = 'feedback correct show';

    // update step tracker
    document.getElementById(`s1Step${s1Step}`).className = 'step-row completed';
    s1Step++;
    if (s1Step < prob.steps.length) {
      document.getElementById(`s1Step${s1Step}`).className = 'step-row active';
    }

    // update displayed expression
    document.getElementById('s1Problem').textContent = step.result;

    setTimeout(() => {
      fb.className = 'feedback';
      showS1Actions();
    }, 1200);
  } else {
    btns[choiceIdx].classList.add('wrong');
    fb.textContent = 'Not quite. Try again!';
    fb.className = 'feedback wrong show';
    setTimeout(() => { btns[choiceIdx].classList.remove('wrong'); }, 800);
  }
}

function showS1Result() {
  const prob = s1Problems[s1Current];
  const ans = prob.answer;
  const fb = document.getElementById('s1Feedback');
  fb.textContent = 'Solved! The solution is x ' + ans.op + ' ' + ans.val;
  fb.className = 'feedback correct show';
  s1Completed.add(s1Current);
  document.querySelectorAll('#s1ProbNav .prob-dot')[s1Current].className = 'prob-dot correct';

  // draw number line
  const open = ans.op === '<' || ans.op === '>';
  const goRight = ans.op === '>' || ans.op === '>=';
  drawNumberLine('s1NL', {
    min: ans.val - 6, max: ans.val + 6,
    highlights: [{
      from: goRight ? ans.val : -Infinity,
      to: goRight ? Infinity : ans.val,
      color: 'rgba(99,102,241,0.25)'
    }],
    points: [{ value: ans.val, color: '#6366f1', open: open }]
  });

  checkSectionProgress(1, s1Completed.size, s1Problems.length);
}

/* ───────────────────────────────────────────────
   SECTION 2: Graph Builder
   ─────────────────────────────────────────────── */
const s2Problems = [
  { display: 'x > 2', val: 2, open: true, dir: 'right' },
  { display: 'x <= -1', val: -1, open: false, dir: 'left' },
  { display: 'x >= 0', val: 0, open: false, dir: 'right' },
  { display: 'x < 4', val: 4, open: true, dir: 'left' },
  { display: 'x <= 3', val: 3, open: false, dir: 'left' }
];

let s2Current = 0;
let s2UserOpen = true;   // user's chosen circle type
let s2UserDir = null;    // 'left' or 'right'
let s2Completed = new Set();

function initS2() {
  const nav = document.getElementById('s2ProbNav');
  nav.innerHTML = '';
  for (let i = 0; i < s2Problems.length; i++) {
    const dot = document.createElement('div');
    dot.className = 'prob-dot' + (i === 0 ? ' active' : '');
    dot.textContent = i + 1;
    dot.onclick = () => loadS2Problem(i);
    nav.appendChild(dot);
  }
  loadS2Problem(0);
}

function loadS2Problem(idx) {
  s2Current = idx;
  s2UserOpen = true;
  s2UserDir = null;
  document.getElementById('s2Problem').textContent = s2Problems[idx].display;
  document.getElementById('s2Feedback').className = 'feedback';
  document.getElementById('s2Hint').style.display = '';

  document.querySelectorAll('#s2ProbNav .prob-dot').forEach((d, i) => {
    d.className = 'prob-dot' + (i === idx ? ' active' : '') + (s2Completed.has(i) ? ' correct' : '');
  });

  drawS2NL();
}

function drawS2NL() {
  const prob = s2Problems[s2Current];
  const v = prob.val;
  const min = v - 6, max = v + 6;
  const w = 520, h = 55, pad = 30, lineY = 25;
  const usable = w - 2 * pad;
  function xPos(val) { return pad + ((val - min) / (max - min)) * usable; }

  let svg = `<svg viewBox="0 0 ${w} ${h}" width="${Math.min(w, 500)}" height="${h}" style="cursor:pointer;">`;

  // shading if user has picked direction
  if (s2UserDir) {
    const cx = xPos(v);
    if (s2UserDir === 'left') {
      svg += `<rect x="0" y="${lineY - 8}" width="${cx}" height="16" fill="rgba(99,102,241,0.2)" rx="2"/>`;
      svg += `<polygon points="${pad - 5},${lineY - 5} ${pad - 15},${lineY} ${pad - 5},${lineY + 5}" fill="rgba(99,102,241,0.4)"/>`;
    } else {
      svg += `<rect x="${cx}" y="${lineY - 8}" width="${w - cx}" height="16" fill="rgba(99,102,241,0.2)" rx="2"/>`;
      svg += `<polygon points="${w - pad + 5},${lineY - 5} ${w - pad + 15},${lineY} ${w - pad + 5},${lineY + 5}" fill="rgba(99,102,241,0.4)"/>`;
    }
  }

  // base line
  svg += `<line x1="${pad - 10}" y1="${lineY}" x2="${w - pad + 10}" y2="${lineY}" stroke="#555" stroke-width="2"/>`;
  svg += `<polygon points="${pad - 10},${lineY - 4} ${pad - 18},${lineY} ${pad - 10},${lineY + 4}" fill="#555"/>`;
  svg += `<polygon points="${w - pad + 10},${lineY - 4} ${w - pad + 18},${lineY} ${w - pad + 10},${lineY + 4}" fill="#555"/>`;

  // ticks
  for (let val = min; val <= max; val++) {
    const x = xPos(val);
    svg += `<line x1="${x}" y1="${lineY - 5}" x2="${x}" y2="${lineY + 5}" stroke="${val === 0 ? '#6366f1' : '#555'}" stroke-width="1.5"/>`;
    svg += `<text x="${x}" y="${lineY + 18}" fill="${val === 0 ? '#6366f1' : '#8a8578'}" font-size="9" text-anchor="middle" font-family="JetBrains Mono">${val}</text>`;
  }

  // clickable dot
  const cx = xPos(v);
  if (s2UserOpen) {
    svg += `<circle cx="${cx}" cy="${lineY}" r="7" fill="#262a33" stroke="#6366f1" stroke-width="2.5" class="circle-toggle" onclick="toggleS2Circle(event)"/>`;
  } else {
    svg += `<circle cx="${cx}" cy="${lineY}" r="7" fill="#6366f1" stroke="#6366f1" stroke-width="2.5" class="circle-toggle" onclick="toggleS2Circle(event)"/>`;
  }

  // clickable left and right zones
  svg += `<rect x="0" y="0" width="${cx - 10}" height="${h}" fill="transparent" onclick="setS2Dir('left')" style="cursor:pointer;"/>`;
  svg += `<rect x="${cx + 10}" y="0" width="${w - cx - 10}" height="${h}" fill="transparent" onclick="setS2Dir('right')" style="cursor:pointer;"/>`;

  // label
  const typeLabel = s2UserOpen ? 'open' : 'closed';
  svg += `<text x="${cx}" y="${lineY - 12}" fill="#6366f1" font-size="8" text-anchor="middle" font-family="JetBrains Mono">${typeLabel}</text>`;

  svg += '</svg>';
  document.getElementById('s2NL').innerHTML = svg;
}

function toggleS2Circle(e) {
  e.stopPropagation();
  s2UserOpen = !s2UserOpen;
  drawS2NL();
}

function setS2Dir(dir) {
  s2UserDir = dir;
  drawS2NL();
}

function checkGraph() {
  const prob = s2Problems[s2Current];
  const fb = document.getElementById('s2Feedback');

  if (!s2UserDir) {
    fb.textContent = 'Click left or right of the dot to shade a direction first.';
    fb.className = 'feedback wrong show';
    return;
  }

  const circleOk = s2UserOpen === prob.open;
  const dirOk = s2UserDir === prob.dir;

  if (circleOk && dirOk) {
    fb.textContent = 'Perfect! That graph is correct.';
    fb.className = 'feedback correct show';
    s2Completed.add(s2Current);
    document.querySelectorAll('#s2ProbNav .prob-dot')[s2Current].className = 'prob-dot correct';
    document.getElementById('s2Hint').style.display = 'none';
    checkSectionProgress(2, s2Completed.size, s2Problems.length);

    // auto-advance after a delay
    if (s2Current < s2Problems.length - 1) {
      setTimeout(() => loadS2Problem(s2Current + 1), 1500);
    }
  } else {
    let msg = 'Not quite. ';
    if (!circleOk) msg += prob.open ? 'The circle should be open (< or > means not included). ' : 'The circle should be closed (the endpoint IS included). ';
    if (!dirOk) msg += prob.dir === 'right' ? 'Shade to the right (values greater than the endpoint).' : 'Shade to the left (values less than the endpoint).';
    fb.textContent = msg;
    fb.className = 'feedback wrong show';
  }
}

/* ───────────────────────────────────────────────
   SECTION 3: Compound Inequality Visualizer
   ─────────────────────────────────────────────── */
const s3Demos = [
  { a: { op: '>', val: -2 }, b: { op: '<', val: 5 }, display: 'x > -2 AND/OR x < 5' },
  { a: { op: '<', val: -1 }, b: { op: '>', val: 3 }, display: 'x < -1 AND/OR x > 3' },
  { a: { op: '>=', val: 0 }, b: { op: '<=', val: 4 }, display: 'x >= 0 AND/OR x <= 4' },
  { a: { op: '<=', val: -3 }, b: { op: '>=', val: 2 }, display: 'x <= -3 AND/OR x >= 2' }
];

let s3Current = 0;
let s3Mode = 'and';

function initS3() {
  const nav = document.getElementById('s3ProbNav');
  nav.innerHTML = '';
  for (let i = 0; i < s3Demos.length; i++) {
    const dot = document.createElement('div');
    dot.className = 'prob-dot' + (i === 0 ? ' active' : '');
    dot.textContent = i + 1;
    dot.onclick = () => { s3Current = i; loadS3Demo(); };
    nav.appendChild(dot);
  }
  loadS3Demo();
}

function loadS3Demo() {
  document.getElementById('s3Problem').textContent = s3Demos[s3Current].display;
  document.querySelectorAll('#s3ProbNav .prob-dot').forEach((d, i) => {
    d.className = 'prob-dot' + (i === s3Current ? ' active' : '');
  });
  setCompoundMode(s3Mode);
}

function setCompoundMode(mode) {
  s3Mode = mode;
  document.getElementById('s3AndBtn').className = 'btn' + (mode === 'and' ? ' active' : '');
  document.getElementById('s3OrBtn').className = 'btn' + (mode === 'or' ? ' active' : '');
  drawCompoundNL();
}

function ineqRegion(ineq) {
  // Returns {from, to, openLeft, openRight}
  const v = ineq.val;
  const op = ineq.op;
  if (op === '<' || op === '<=') return { from: -Infinity, to: v, openLeft: false, openRight: op === '<' };
  return { from: v, to: Infinity, openLeft: op === '>', openRight: false };
}

function drawCompoundNL() {
  const demo = s3Demos[s3Current];
  const regA = ineqRegion(demo.a);
  const regB = ineqRegion(demo.b);

  // determine result region
  let highlights = [];
  let points = [];
  let resultText = '';
  const colorA = 'rgba(99,102,241,0.2)';
  const colorB = 'rgba(34,197,94,0.2)';
  const colorResult = 'rgba(245,158,11,0.3)';

  if (s3Mode === 'and') {
    // intersection
    const from = Math.max(regA.from, regB.from);
    const to = Math.min(regA.to, regB.to);
    if (from < to) {
      highlights.push({ from, to, color: colorResult });
      const openL = (from === regA.from ? regA.openLeft : regB.openLeft) || (from === regB.from ? regB.openLeft : regA.openLeft);
      const openR = (to === regA.to ? regA.openRight : regB.openRight) || (to === regB.to ? regB.openRight : regA.openRight);
      if (from !== -Infinity) points.push({ value: from, color: '#f59e0b', open: from === regA.from ? (regA.openLeft || false) : (regB.openLeft || false) });
      if (to !== Infinity) points.push({ value: to, color: '#f59e0b', open: to === regA.to ? (regA.openRight || false) : (regB.openRight || false) });

      if (from === -Infinity) resultText = `x ${regA.to === to ? demo.a.op : demo.b.op} ${to}`;
      else if (to === Infinity) resultText = `x ${regA.from === from ? demo.a.op : demo.b.op} ${from}`;
      else resultText = `${from} < x < ${to} (between)`;
    } else {
      resultText = 'No solution (empty set)';
    }
  } else {
    // union
    highlights.push({ from: regA.from, to: regA.to, color: colorA });
    highlights.push({ from: regB.from, to: regB.to, color: colorB });
    if (regA.from !== -Infinity) points.push({ value: regA.from, color: '#6366f1', open: regA.openLeft || false });
    if (regA.to !== Infinity) points.push({ value: regA.to, color: '#6366f1', open: regA.openRight || false });
    if (regB.from !== -Infinity) points.push({ value: regB.from, color: '#22c55e', open: regB.openLeft || false });
    if (regB.to !== Infinity) points.push({ value: regB.to, color: '#22c55e', open: regB.openRight || false });

    // check if union covers everything
    if ((regA.from === -Infinity && regB.to === Infinity) || (regB.from === -Infinity && regA.to === Infinity)) {
      const gap = Math.max(regA.from, regB.from) - Math.min(regA.to, regB.to);
      if (gap <= 0) resultText = 'All real numbers';
      else resultText = `x ${demo.a.op.replace('=','')} ${demo.a.val} OR x ${demo.b.op.replace('=','')} ${demo.b.val}`;
    } else {
      resultText = `x ${demo.a.op} ${demo.a.val} OR x ${demo.b.op} ${demo.b.val}`;
    }
  }

  const allVals = [demo.a.val, demo.b.val];
  const center = (Math.min(...allVals) + Math.max(...allVals)) / 2;
  const span = Math.max(Math.max(...allVals) - Math.min(...allVals), 4);

  drawNumberLine('s3NL', {
    min: Math.floor(center - span - 3),
    max: Math.ceil(center + span + 3),
    highlights, points
  });

  document.getElementById('s3Result').innerHTML = `<span class="${s3Mode === 'and' ? 'green' : 'orange'}">${s3Mode.toUpperCase()}</span>: ${resultText}`;
}

/* Section 3 Practice */
const s3PracProblems = [
  { q: 'x > 1 AND x < 6. What type of result?', choices: ['A bounded segment (between)', 'Two rays going outward', 'All real numbers', 'Empty set'], correct: 0, explain: 'AND = intersection, so you get the overlap: 1 < x < 6' },
  { q: 'x < -2 OR x > 4. What type of result?', choices: ['A bounded segment', 'Two rays going outward', 'All real numbers', 'Empty set'], correct: 1, explain: 'OR = union, so you get two separate rays' },
  { q: 'x > 3 AND x > 7. Simplified result?', choices: ['x > 3', 'x > 7', '3 < x < 7', 'No solution'], correct: 1, explain: 'AND means both must be true. If x > 7, then x > 3 is automatically true too. So x > 7.' },
  { q: 'x < 1 AND x > 5. What happens?', choices: ['1 < x < 5', 'x < 1 or x > 5', 'All real numbers', 'No solution'], correct: 3, explain: 'No number is both less than 1 AND greater than 5.' }
];

let s3PracCurrent = 0;
let s3PracCompleted = new Set();

function initS3Practice() {
  const nav = document.getElementById('s3PracNav');
  nav.innerHTML = '';
  for (let i = 0; i < s3PracProblems.length; i++) {
    const dot = document.createElement('div');
    dot.className = 'prob-dot' + (i === 0 ? ' active' : '');
    dot.textContent = i + 1;
    dot.onclick = () => loadS3Prac(i);
    nav.appendChild(dot);
  }
  loadS3Prac(0);
}

function loadS3Prac(idx) {
  s3PracCurrent = idx;
  const prob = s3PracProblems[idx];
  document.getElementById('s3PracProblem').textContent = prob.q;
  document.getElementById('s3PracQ').textContent = '';
  document.getElementById('s3PracFeedback').className = 'feedback';

  document.querySelectorAll('#s3PracNav .prob-dot').forEach((d, i) => {
    d.className = 'prob-dot' + (i === idx ? ' active' : '') + (s3PracCompleted.has(i) ? ' correct' : '');
  });

  const btns = document.getElementById('s3PracBtns');
  btns.innerHTML = '';
  prob.choices.forEach((ch, i) => {
    const btn = document.createElement('button');
    btn.className = 'btn';
    btn.textContent = ch;
    btn.onclick = () => checkS3Prac(i);
    btns.appendChild(btn);
  });
}

function checkS3Prac(idx) {
  const prob = s3PracProblems[s3PracCurrent];
  const fb = document.getElementById('s3PracFeedback');
  const btns = document.querySelectorAll('#s3PracBtns .btn');

  if (idx === prob.correct) {
    btns[idx].classList.add('correct');
    fb.textContent = 'Correct! ' + prob.explain;
    fb.className = 'feedback correct show';
    s3PracCompleted.add(s3PracCurrent);
    document.querySelectorAll('#s3PracNav .prob-dot')[s3PracCurrent].className = 'prob-dot correct';
    checkSectionProgress(3, s3PracCompleted.size, s3PracProblems.length);

    if (s3PracCurrent < s3PracProblems.length - 1) {
      setTimeout(() => loadS3Prac(s3PracCurrent + 1), 2000);
    }
  } else {
    btns[idx].classList.add('wrong');
    fb.textContent = 'Not quite. ' + prob.explain;
    fb.className = 'feedback wrong show';
    setTimeout(() => { btns[idx].classList.remove('wrong'); }, 1000);
  }
}

/* ───────────────────────────────────────────────
   SECTION 4: Absolute Value Visualizer
   ─────────────────────────────────────────────── */
function updateAbsViz() {
  const a = parseInt(document.getElementById('absA').value) || 0;
  const b = parseInt(document.getElementById('absB').value) || 0;

  if (b < 0) {
    document.getElementById('absEqResult').innerHTML = '<span class="pink">No solution: absolute value cannot equal a negative number.</span>';
    document.getElementById('absEqNL').innerHTML = '';
    return;
  }

  const sol1 = a + b;
  const sol2 = a - b;

  const minV = Math.min(sol1, sol2) - 3;
  const maxV = Math.max(sol1, sol2) + 3;

  drawNumberLine('absEqNL', {
    min: minV, max: maxV,
    highlights: [
      { from: a - 0.1, to: a + 0.1, color: 'rgba(99,102,241,0.4)' }
    ],
    points: [
      { value: a, color: '#6366f1', open: false, label: 'center=' + a },
      { value: sol1, color: '#22c55e', open: false, label: 'x=' + sol1 },
      { value: sol2, color: '#ec4899', open: false, label: 'x=' + sol2 }
    ]
  });

  document.getElementById('absEqResult').innerHTML =
    `|x - ${a}| = ${b}<br>` +
    `x - ${a} = ${b} &rarr; <span class="green">x = ${sol1}</span><br>` +
    `x - ${a} = -${b} &rarr; <span class="pink">x = ${sol2}</span><br>` +
    `<span class="dim">Both are distance ${b} from ${a}</span>`;
}

/* Section 4 Practice */
const s4Problems = [
  { display: '|x| = 7', type: 'eq', answers: [7, -7], hint: 'Two values: x = 7 and x = ?' },
  { display: '|x - 3| = 5', type: 'eq', answers: [8, -2], hint: 'x - 3 = 5 or x - 3 = -5' },
  { display: '|x| < 4: is this AND or OR?', type: 'choice', choices: ['AND (between)', 'OR (outside)'], correct: 0, explain: 'Less thAND! |x| < 4 means -4 < x < 4' },
  { display: '|x| > 2: is this AND or OR?', type: 'choice', choices: ['AND (between)', 'OR (outside)'], correct: 1, explain: 'GreatOR! |x| > 2 means x < -2 OR x > 2' },
  { display: '|x + 1| = 4. Find both solutions.', type: 'eq', answers: [3, -5], hint: 'x + 1 = 4 or x + 1 = -4' }
];

let s4Current = 0;
let s4Completed = new Set();

function initS4() {
  const nav = document.getElementById('s4ProbNav');
  nav.innerHTML = '';
  for (let i = 0; i < s4Problems.length; i++) {
    const dot = document.createElement('div');
    dot.className = 'prob-dot' + (i === 0 ? ' active' : '');
    dot.textContent = i + 1;
    dot.onclick = () => loadS4Problem(i);
    nav.appendChild(dot);
  }
  loadS4Problem(0);
}

function loadS4Problem(idx) {
  s4Current = idx;
  const prob = s4Problems[idx];
  document.getElementById('s4Problem').textContent = prob.display;
  document.getElementById('s4Feedback').className = 'feedback';

  document.querySelectorAll('#s4ProbNav .prob-dot').forEach((d, i) => {
    d.className = 'prob-dot' + (i === idx ? ' active' : '') + (s4Completed.has(i) ? ' correct' : '');
  });

  const inputDiv = document.getElementById('s4Input');
  inputDiv.innerHTML = '';

  if (prob.type === 'eq') {
    inputDiv.innerHTML = `
      <span style="font-size:0.85rem;">x = </span>
      <input type="number" class="math-input" id="s4Ans1" style="width:60px;">
      <span style="font-size:0.85rem;"> or x = </span>
      <input type="number" class="math-input" id="s4Ans2" style="width:60px;">
      <p class="dim" style="font-size:0.75rem; margin-top:0.5rem;">${prob.hint}</p>
    `;
  } else {
    prob.choices.forEach((ch, i) => {
      const btn = document.createElement('button');
      btn.className = 'btn';
      btn.textContent = ch;
      btn.style.marginRight = '0.5rem';
      btn.onclick = () => checkS4Choice(i);
      inputDiv.appendChild(btn);
    });
  }
}

function checkS4Choice(idx) {
  const prob = s4Problems[s4Current];
  const fb = document.getElementById('s4Feedback');
  const btns = document.querySelectorAll('#s4Input .btn');

  if (idx === prob.correct) {
    btns[idx].classList.add('correct');
    fb.textContent = 'Correct! ' + prob.explain;
    fb.className = 'feedback correct show';
    s4Completed.add(s4Current);
    document.querySelectorAll('#s4ProbNav .prob-dot')[s4Current].className = 'prob-dot correct';
    checkSectionProgress(4, s4Completed.size, s4Problems.length);
    if (s4Current < s4Problems.length - 1) setTimeout(() => loadS4Problem(s4Current + 1), 1800);
  } else {
    btns[idx].classList.add('wrong');
    fb.textContent = 'Not quite. ' + prob.explain;
    fb.className = 'feedback wrong show';
    setTimeout(() => btns[idx].classList.remove('wrong'), 1000);
  }
}

function checkAbsProblem() {
  const prob = s4Problems[s4Current];
  const fb = document.getElementById('s4Feedback');

  if (prob.type === 'choice') {
    fb.textContent = 'Use the buttons above to answer.';
    fb.className = 'feedback wrong show';
    return;
  }

  const a1 = parseInt(document.getElementById('s4Ans1').value);
  const a2 = parseInt(document.getElementById('s4Ans2').value);

  if (isNaN(a1) || isNaN(a2)) {
    fb.textContent = 'Enter both solutions.';
    fb.className = 'feedback wrong show';
    return;
  }

  const userSet = new Set([a1, a2]);
  const ansSet = new Set(prob.answers);

  if (userSet.size === ansSet.size && [...userSet].every(v => ansSet.has(v))) {
    fb.textContent = `Correct! x = ${prob.answers[0]} or x = ${prob.answers[1]}`;
    fb.className = 'feedback correct show';
    document.getElementById('s4Ans1').classList.add('correct');
    document.getElementById('s4Ans2').classList.add('correct');
    s4Completed.add(s4Current);
    document.querySelectorAll('#s4ProbNav .prob-dot')[s4Current].className = 'prob-dot correct';
    checkSectionProgress(4, s4Completed.size, s4Problems.length);
    if (s4Current < s4Problems.length - 1) setTimeout(() => loadS4Problem(s4Current + 1), 1800);
  } else {
    fb.textContent = `Not quite. Hint: ${prob.hint}`;
    fb.className = 'feedback wrong show';
    document.getElementById('s4Ans1').classList.add('wrong');
    document.getElementById('s4Ans2').classList.add('wrong');
    setTimeout(() => {
      document.getElementById('s4Ans1').classList.remove('wrong');
      document.getElementById('s4Ans2').classList.remove('wrong');
    }, 1000);
  }
}

/* ───────────────────────────────────────────────
   SECTION 5: Quick Quiz
   ─────────────────────────────────────────────── */
const quizQuestions = [
  {
    q: 'Solve: 3x - 4 > 11',
    choices: ['x > 5', 'x < 5', 'x > 15', 'x < 15'],
    correct: 0
  },
  {
    q: 'Solve: -2x >= 10',
    choices: ['x >= -5', 'x <= -5', 'x >= 5', 'x <= 5'],
    correct: 1
  },
  {
    q: 'x < 3 is graphed with what type of circle at 3?',
    choices: ['Open circle', 'Closed circle', 'No circle', 'Arrow'],
    correct: 0
  },
  {
    q: 'x >= -1 is graphed with what type of circle at -1?',
    choices: ['Open circle', 'Closed circle', 'Dashed line', 'No circle'],
    correct: 1
  },
  {
    q: 'x > 2 AND x < 7 means:',
    choices: ['2 < x < 7', 'x < 2 or x > 7', 'All real numbers', 'No solution'],
    correct: 0
  },
  {
    q: 'x < -3 OR x > 1 means:',
    choices: ['-3 < x < 1', 'Two separate rays', 'All real numbers', 'No solution'],
    correct: 1
  },
  {
    q: '|x| = 6 has how many solutions?',
    choices: ['0', '1', '2', 'Infinite'],
    correct: 2
  },
  {
    q: '|x - 4| = 2: the solutions are:',
    choices: ['x = 2, x = 6', 'x = 2, x = -6', 'x = -2, x = 6', 'x = 4'],
    correct: 0
  },
  {
    q: '|x| < 5 gives what type of compound inequality?',
    choices: ['AND (between)', 'OR (outside)', 'Single ray', 'No solution'],
    correct: 0
  },
  {
    q: '|x| > 3 gives what type of compound inequality?',
    choices: ['AND (between)', 'OR (outside)', 'Single point', 'All reals'],
    correct: 1
  }
];

let quizCurrent = 0;
let quizScore = 0;
let quizAnswered = new Array(quizQuestions.length).fill(null);

function initQuiz() {
  const nav = document.getElementById('quizNav');
  nav.innerHTML = '';
  for (let i = 0; i < quizQuestions.length; i++) {
    const dot = document.createElement('div');
    dot.className = 'prob-dot' + (i === 0 ? ' active' : '');
    dot.textContent = i + 1;
    nav.appendChild(dot);
  }
  loadQuizQ(0);
}

function loadQuizQ(idx) {
  quizCurrent = idx;
  const q = quizQuestions[idx];
  document.getElementById('quizQuestion').textContent = q.q;
  document.getElementById('quizFeedback').className = 'feedback';
  document.getElementById('quizNext').style.display = 'none';

  document.querySelectorAll('#quizNav .prob-dot').forEach((d, i) => {
    let cls = 'prob-dot';
    if (i === idx) cls += ' active';
    if (quizAnswered[i] === true) cls += ' correct';
    else if (quizAnswered[i] === false) cls += ' wrong';
    d.className = cls;
  });

  const choicesDiv = document.getElementById('quizChoices');
  choicesDiv.innerHTML = '';

  if (quizAnswered[idx] !== null) {
    // already answered, show result
    q.choices.forEach((ch, i) => {
      const btn = document.createElement('button');
      btn.className = 'btn' + (i === q.correct ? ' correct' : '') + (quizAnswered[idx] === false && i !== q.correct ? '' : '');
      btn.textContent = ch;
      btn.disabled = true;
      choicesDiv.appendChild(btn);
    });
    document.getElementById('quizNext').style.display = idx < quizQuestions.length - 1 ? '' : 'none';
    return;
  }

  q.choices.forEach((ch, i) => {
    const btn = document.createElement('button');
    btn.className = 'btn';
    btn.textContent = ch;
    btn.onclick = () => handleQuizAnswer(i);
    choicesDiv.appendChild(btn);
  });
}

function handleQuizAnswer(idx) {
  const q = quizQuestions[quizCurrent];
  const fb = document.getElementById('quizFeedback');
  const btns = document.querySelectorAll('#quizChoices .btn');

  // disable all buttons
  btns.forEach(b => b.disabled = true);

  if (idx === q.correct) {
    btns[idx].classList.add('correct');
    fb.textContent = 'Correct!';
    fb.className = 'feedback correct show';
    quizScore++;
    quizAnswered[quizCurrent] = true;
  } else {
    btns[idx].classList.add('wrong');
    btns[q.correct].classList.add('correct');
    fb.textContent = 'Incorrect. The answer is: ' + q.choices[q.correct];
    fb.className = 'feedback wrong show';
    quizAnswered[quizCurrent] = false;
  }

  document.getElementById('quizScore').textContent = `Score: ${quizScore} / 10`;

  document.querySelectorAll('#quizNav .prob-dot').forEach((d, i) => {
    let cls = 'prob-dot';
    if (i === quizCurrent) cls += ' active';
    if (quizAnswered[i] === true) cls += ' correct';
    else if (quizAnswered[i] === false) cls += ' wrong';
    d.className = cls;
  });

  if (quizCurrent < quizQuestions.length - 1) {
    document.getElementById('quizNext').style.display = '';
  } else {
    // quiz done
    setTimeout(showQuizFinal, 1000);
  }
}

function nextQuizQ() {
  if (quizCurrent < quizQuestions.length - 1) {
    loadQuizQ(quizCurrent + 1);
  }
}

function showQuizFinal() {
  document.getElementById('quizArea').style.display = 'none';
  const final = document.getElementById('quizFinal');
  final.style.display = '';
  document.getElementById('quizFinalScore').textContent = `${quizScore} / 10`;

  let msg = '';
  if (quizScore === 10) msg = 'Perfect score! You have mastered inequalities and absolute value.';
  else if (quizScore >= 8) msg = 'Excellent work! You have a strong grasp of this material.';
  else if (quizScore >= 6) msg = 'Good job! Review the sections you missed and try again.';
  else msg = 'Keep practicing! Go back through the sections and try the interactive exercises.';

  document.getElementById('quizFinalMsg').textContent = msg;
  markSectionDone(5);
}

function restartQuiz() {
  quizCurrent = 0;
  quizScore = 0;
  quizAnswered = new Array(quizQuestions.length).fill(null);
  document.getElementById('quizScore').textContent = 'Score: 0 / 10';
  document.getElementById('quizArea').style.display = '';
  document.getElementById('quizFinal').style.display = 'none';
  initQuiz();
}

/* ───────────────────────────────────────────────
   Initialize everything
   ─────────────────────────────────────────────── */
document.addEventListener('DOMContentLoaded', () => {
  initFlipDemo();
  initS1();
  initS2();
  initS3();
  initS3Practice();
  updateAbsViz();
  initS4();
  initQuiz();
});
</script>

</body>
</html>
