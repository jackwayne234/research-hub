<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lesson 20: Review &amp; Exam Prep</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,300;0,400;0,500;0,600;0,700;1,400&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{--bg:#1e2128;--bg-card:#262a33;--bg-card-hover:#2c313c;--bg-input:#1a1d24;--border:#363b47;--text:#e2e4e9;--text-dim:#9ca3af;--text-bright:#fff;--indigo:#6366f1;--indigo-dim:rgba(99,102,241,.15);--green:#22c55e;--green-dim:rgba(34,197,94,.15);--pink:#ec4899;--pink-dim:rgba(236,72,153,.15);--amber:#f59e0b;--amber-dim:rgba(245,158,11,.15);--radius:10px;--transition:0.3s cubic-bezier(.4,0,.2,1);--spring:cubic-bezier(.34,1.56,.64,1)}
html{scroll-behavior:smooth}
body{font-family:'JetBrains Mono',monospace;background:var(--bg);color:var(--text);line-height:1.7;min-height:100vh;padding:0}
.top-bar{position:sticky;top:0;z-index:100;background:rgba(30,33,40,.95);backdrop-filter:blur(12px);border-bottom:1px solid var(--border);padding:16px 24px}
.top-bar h1{font-size:1.1rem;font-weight:600;color:var(--text-bright);margin-bottom:10px;letter-spacing:-.02em}
.top-bar h1 span{color:var(--indigo)}
.progress-track{width:100%;height:6px;background:var(--border);border-radius:3px;overflow:hidden}
.progress-fill{height:100%;width:0%;background:linear-gradient(90deg,var(--indigo),#818cf8);border-radius:3px;transition:width .5s ease}
.progress-label{font-size:.7rem;color:var(--text-dim);margin-top:6px;text-align:right}
.content{max-width:900px;margin:0 auto;padding:24px}
.section-card{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);margin-bottom:20px;overflow:hidden;transition:border-color var(--transition)}
.section-card.completed{border-color:var(--green)}
.section-header{display:flex;align-items:center;justify-content:space-between;padding:18px 22px;cursor:pointer;user-select:none;transition:background var(--transition)}
.section-header:hover{background:var(--bg-card-hover)}
.section-header h2{font-size:.95rem;font-weight:600;color:var(--text-bright);display:flex;align-items:center;gap:10px}
.section-num{display:inline-flex;align-items:center;justify-content:center;width:28px;height:28px;border-radius:50%;background:var(--indigo-dim);color:var(--indigo);font-size:.75rem;font-weight:700;flex-shrink:0}
.chevron{width:20px;height:20px;color:var(--text-dim);transition:transform .35s var(--spring);flex-shrink:0}
.section-card.open .chevron{transform:rotate(180deg)}
.section-body{max-height:0;overflow:hidden;transition:max-height .6s cubic-bezier(.4,0,.2,1)}
.section-card.open .section-body{max-height:200000px}
.section-inner{padding:0 22px 22px}
.concept-text{font-size:.82rem;color:var(--text);margin-bottom:16px;line-height:1.8}
.concept-text strong{color:var(--text-bright)}
.formula-box{background:var(--indigo-dim);border:1px solid rgba(99,102,241,.3);border-radius:var(--radius);padding:14px 18px;margin:12px 0;font-size:.9rem;color:var(--indigo);font-weight:600}
.formula-box.green{background:var(--green-dim);border-color:rgba(34,197,94,.3);color:var(--green)}
.formula-box.pink{background:var(--pink-dim);border-color:rgba(236,72,153,.3);color:var(--pink)}
.formula-box.amber{background:var(--amber-dim);border-color:rgba(245,158,11,.3);color:var(--amber)}
.formula-box.large{font-size:1.05rem;padding:18px 22px;text-align:center}
.key-point{background:var(--amber-dim);border-left:3px solid var(--amber);border-radius:0 var(--radius) var(--radius) 0;padding:12px 16px;margin:14px 0;font-size:.78rem;color:var(--amber)}
.formula-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin:12px 0}
.formula-grid .formula-box{margin:0}
.formula-table{width:100%;border-collapse:collapse;font-size:.76rem;margin:14px 0}
.formula-table th{background:var(--indigo-dim);color:var(--indigo);padding:8px 12px;text-align:left;border:1px solid rgba(99,102,241,.2);font-weight:600}
.formula-table td{padding:8px 12px;border:1px solid var(--border);color:var(--text);vertical-align:top}
.formula-table tr:nth-child(even) td{background:rgba(255,255,255,.02)}
.formula-table td:first-child{color:var(--text-bright);font-weight:500}
.section-divider{border:none;border-top:1px solid var(--border);margin:20px 0}
.subsection-title{font-size:.82rem;font-weight:700;color:var(--text-bright);margin:18px 0 10px;letter-spacing:-.01em}
.subsection-title.indigo{color:var(--indigo)}
.subsection-title.green{color:var(--green)}
.subsection-title.pink{color:var(--pink)}
.subsection-title.amber{color:var(--amber)}
/* Tabs */
.tab-bar{display:flex;gap:4px;flex-wrap:wrap;margin-bottom:0;border-bottom:1px solid var(--border);padding-bottom:0}
.tab-btn{padding:8px 16px;font-size:.72rem;font-weight:600;border:1px solid transparent;border-bottom:none;border-radius:6px 6px 0 0;background:transparent;color:var(--text-dim);cursor:pointer;font-family:'JetBrains Mono',monospace;transition:var(--transition);margin-bottom:-1px}
.tab-btn.active{background:var(--bg-card);border-color:var(--border);border-bottom-color:var(--bg-card);color:var(--text-bright)}
.tab-btn:hover:not(.active){color:var(--text);background:var(--bg-card-hover)}
.tab-panel{display:none;background:var(--bg-card);border:1px solid var(--border);border-top:none;border-radius:0 0 var(--radius) var(--radius);padding:18px;max-height:420px;overflow-y:auto}
.tab-panel.active{display:block}
.tab-panel::-webkit-scrollbar{width:4px}
.tab-panel::-webkit-scrollbar-track{background:transparent}
.tab-panel::-webkit-scrollbar-thumb{background:var(--border);border-radius:2px}
/* Mastery checklist */
.mastery-wrap{background:var(--bg-input);border:1px solid var(--border);border-radius:var(--radius);padding:18px;margin:14px 0}
.mastery-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px}
.mastery-title{font-size:.8rem;font-weight:600;color:var(--text-bright)}
.mastery-pct{font-size:.8rem;font-weight:700;color:var(--green)}
.mastery-bar-track{height:6px;background:var(--border);border-radius:3px;overflow:hidden;margin-bottom:16px}
.mastery-bar-fill{height:100%;background:linear-gradient(90deg,var(--green),#4ade80);border-radius:3px;transition:width .5s ease;width:0%}
.mastery-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.mastery-item{display:flex;align-items:center;gap:10px;padding:8px 12px;background:var(--bg-card);border:1px solid var(--border);border-radius:6px;cursor:pointer;transition:var(--transition)}
.mastery-item:hover{border-color:var(--green);background:var(--bg-card-hover)}
.mastery-item.checked{border-color:var(--green);background:var(--green-dim)}
.mastery-item input[type="checkbox"]{accent-color:var(--green);width:14px;height:14px;cursor:pointer;flex-shrink:0}
.mastery-item label{font-size:.72rem;color:var(--text);cursor:pointer;line-height:1.4}
.mastery-item.checked label{color:var(--green)}
/* Problem generator */
.gen-wrap{background:var(--bg-input);border:1px solid var(--border);border-radius:var(--radius);padding:18px;margin:14px 0}
.gen-problem-display{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);padding:16px;margin:14px 0;min-height:80px;font-size:.82rem;color:var(--text-bright);line-height:1.8}
.gen-solution{background:var(--green-dim);border:1px solid rgba(34,197,94,.3);border-radius:var(--radius);padding:14px;margin-top:10px;font-size:.78rem;color:var(--green);line-height:1.8;display:none}
.gen-solution.visible{display:block}
.gen-tag{display:inline-block;padding:2px 8px;border-radius:4px;font-size:.65rem;font-weight:600;background:var(--indigo-dim);color:var(--indigo);border:1px solid rgba(99,102,241,.3);margin-bottom:8px}
/* Mock exam */
.mock-wrap{background:var(--bg-input);border:1px solid var(--border);border-radius:var(--radius);padding:18px;margin:14px 0}
.mock-timer-display{font-size:2rem;font-weight:700;color:var(--amber);text-align:center;letter-spacing:.05em;margin:12px 0;font-variant-numeric:tabular-nums}
.mock-timer-display.warning{color:var(--pink)}
.mock-status{font-size:.75rem;color:var(--text-dim);text-align:center;margin-bottom:12px}
.mock-q-wrap{display:none}
.mock-q-wrap.active{display:block}
.mock-q{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);padding:14px;margin-bottom:10px}
.mock-q .q-num{font-size:.65rem;color:var(--indigo);font-weight:600;text-transform:uppercase;margin-bottom:6px}
.mock-q .q-text{font-size:.78rem;margin-bottom:10px;line-height:1.7;color:var(--text-bright)}
.mock-q .choices{display:flex;flex-direction:column;gap:6px}
.mock-q .choice-btn{text-align:left;padding:8px 12px;font-size:.74rem;border:1px solid var(--border);border-radius:6px;background:var(--bg);color:var(--text);cursor:pointer;transition:var(--transition);font-family:'JetBrains Mono',monospace;width:100%}
.mock-q .choice-btn:hover:not(.locked){border-color:var(--indigo);background:var(--bg-card-hover)}
.mock-q .choice-btn.selected{border-color:var(--indigo);background:var(--indigo-dim);color:var(--indigo)}
.mock-q .choice-btn.reveal-correct{border-color:var(--green);background:var(--green-dim);color:var(--green)}
.mock-q .choice-btn.reveal-wrong{border-color:var(--pink);background:var(--pink-dim);color:var(--pink)}
.mock-results{display:none;text-align:center;padding:24px}
.mock-results.visible{display:block}
.mock-score-big{font-size:3rem;font-weight:700;color:var(--text-bright);margin-bottom:8px}
.mock-score-big span{color:var(--indigo)}
.mock-score-label{font-size:.82rem;color:var(--text-dim)}
/* Quiz */
.quiz-score{background:var(--indigo-dim);border:1px solid rgba(99,102,241,.3);border-radius:var(--radius);padding:14px 20px;display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}
.quiz-score .score-text{font-size:.85rem;color:var(--text-bright);font-weight:600}
.quiz-q{background:var(--bg-input);border:1px solid var(--border);border-radius:var(--radius);padding:16px;margin-bottom:12px}
.quiz-q .q-num{font-size:.65rem;color:var(--indigo);font-weight:600;text-transform:uppercase;letter-spacing:.06em;margin-bottom:8px}
.quiz-q .q-text{font-size:.78rem;margin-bottom:12px;line-height:1.7}
.quiz-q .choices{display:flex;flex-direction:column;gap:8px}
.quiz-q .choice-btn{text-align:left;padding:10px 14px;font-size:.76rem;border:1px solid var(--border);border-radius:6px;background:var(--bg-card);color:var(--text);cursor:pointer;transition:var(--transition);font-family:'JetBrains Mono',monospace;width:100%}
.quiz-q .choice-btn:hover{border-color:var(--indigo);background:var(--bg-card-hover)}
.quiz-q .choice-btn.selected-correct{border-color:var(--green);background:var(--green-dim);color:var(--green);pointer-events:none}
.quiz-q .choice-btn.selected-wrong{border-color:var(--pink);background:var(--pink-dim);color:var(--pink);pointer-events:none}
.quiz-q .choice-btn.reveal-correct{border-color:var(--green);background:var(--green-dim);color:var(--green);pointer-events:none}
.quiz-q .choice-btn.disabled{pointer-events:none;opacity:.7}
.btn{display:inline-flex;align-items:center;gap:6px;padding:8px 16px;border:1px solid var(--border);border-radius:6px;background:var(--bg-card);color:var(--text);font-family:'JetBrains Mono',monospace;font-size:.72rem;cursor:pointer;transition:var(--transition);user-select:none}
.btn:hover{background:var(--bg-card-hover);border-color:var(--indigo);color:var(--text-bright)}
.btn-primary{background:var(--indigo);border-color:var(--indigo);color:#fff}
.btn-primary:hover{background:#5558e6}
.btn-green{background:var(--green-dim);border-color:rgba(34,197,94,.3);color:var(--green)}
.btn-green:hover{background:rgba(34,197,94,.25)}
.btn-amber{background:var(--amber-dim);border-color:rgba(245,158,11,.3);color:var(--amber)}
.btn-amber:hover{background:rgba(245,158,11,.25)}
.btn-danger{background:var(--pink-dim);border-color:rgba(236,72,153,.3);color:var(--pink)}
.controls-row{display:flex;flex-wrap:wrap;gap:10px;align-items:center;margin:12px 0}
.tip-list{list-style:none;display:flex;flex-direction:column;gap:8px;margin:12px 0}
.tip-list li{display:flex;gap:10px;font-size:.78rem;color:var(--text);line-height:1.7;padding:10px 14px;background:var(--bg-input);border-radius:var(--radius);border:1px solid var(--border)}
.tip-list li .tip-num{flex-shrink:0;width:22px;height:22px;border-radius:50%;background:var(--indigo-dim);color:var(--indigo);font-size:.68rem;font-weight:700;display:flex;align-items:center;justify-content:center}
.tip-list li.green-tip{border-color:rgba(34,197,94,.2)}
.tip-list li.green-tip .tip-num{background:var(--green-dim);color:var(--green)}
.tip-list li.pink-tip{border-color:rgba(236,72,153,.2)}
.tip-list li.pink-tip .tip-num{background:var(--pink-dim);color:var(--pink)}
.tip-list li.amber-tip{border-color:rgba(245,158,11,.2)}
.tip-list li.amber-tip .tip-num{background:var(--amber-dim);color:var(--amber)}
.worked-example{background:var(--bg-input);border:1px solid var(--border);border-radius:var(--radius);padding:16px;margin:12px 0}
.worked-example .we-title{font-size:.75rem;font-weight:700;color:var(--pink);margin-bottom:10px;text-transform:uppercase;letter-spacing:.06em}
.worked-example .we-step{font-size:.78rem;color:var(--text);padding:8px 0;border-bottom:1px solid var(--border);line-height:1.8}
.worked-example .we-step:last-child{border-bottom:none}
.worked-example .we-step strong{color:var(--amber)}
@keyframes springPop{0%{transform:scale(1)}50%{transform:scale(1.06)}100%{transform:scale(1)}}
@keyframes shake{0%,100%{transform:translateX(0)}20%{transform:translateX(-6px)}40%{transform:translateX(6px)}60%{transform:translateX(-4px)}80%{transform:translateX(4px)}}
.pop{animation:springPop .35s var(--spring)}
.shake{animation:shake .4s ease}
@media(max-width:640px){
  .content{padding:16px}
  .section-header{padding:14px 16px}
  .section-inner{padding:0 14px 16px}
  .formula-grid{grid-template-columns:1fr}
  .mastery-grid{grid-template-columns:1fr}
  .tab-btn{padding:6px 10px;font-size:.68rem}
  .formula-table{font-size:.7rem}
  .formula-table th,.formula-table td{padding:6px 8px}
  .mock-timer-display{font-size:1.6rem}
}
</style>
</head>
<body>

<div class="top-bar">
  <h1><span>20</span> Higher Math — Review &amp; Exam Prep</h1>
  <div class="progress-track"><div class="progress-fill" id="progressFill"></div></div>
  <div class="progress-label" id="progressLabel">0 / 5 sections</div>
</div>

<div class="content" id="contentArea">

<!-- ========================================================== -->
<!-- SECTION 1: LINEAR ALGEBRA REVIEW -->
<!-- ========================================================== -->
<div class="section-card open" data-section="1">
  <div class="section-header" onclick="toggleSection(this)">
    <h2><span class="section-num">1</span> Linear Algebra Review (Lessons 1–6)</h2>
    <svg class="chevron" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"/></svg>
  </div>
  <div class="section-body"><div class="section-inner">

    <p class="concept-text">
      Linear algebra forms the backbone of the course. The core objects are <strong>vectors</strong> and <strong>matrices</strong>, and the core activity is solving systems Ax = b. Everything else — transformations, eigenvalues, inner products — builds on that foundation.
    </p>

    <div class="subsection-title indigo">Gaussian Elimination &amp; Row Reduction (Lesson 1)</div>
    <div class="formula-grid">
      <div class="formula-box">Ax = b &nbsp;→&nbsp; [A|b] &nbsp;→&nbsp; RREF</div>
      <div class="formula-box green">Rank(A) + Nullity(A) = n</div>
    </div>
    <div class="key-point">
      Three row ops: swap rows, scale a row, add a multiple of one row to another. These preserve the solution set. The pivot positions in RREF determine rank.
    </div>

    <div class="subsection-title green">Matrix Operations &amp; Determinants (Lessons 2 &amp; 5)</div>
    <table class="formula-table">
      <thead><tr><th>Operation</th><th>Formula / Rule</th></tr></thead>
      <tbody>
        <tr><td>Matrix multiply</td><td>(AB)<sub>ij</sub> = Σ<sub>k</sub> A<sub>ik</sub>B<sub>kj</sub> &nbsp;— not commutative in general</td></tr>
        <tr><td>Transpose</td><td>(AB)<sup>T</sup> = B<sup>T</sup>A<sup>T</sup></td></tr>
        <tr><td>Inverse</td><td>A<sup>-1</sup> exists iff det(A) ≠ 0; &nbsp;(AB)<sup>-1</sup> = B<sup>-1</sup>A<sup>-1</sup></td></tr>
        <tr><td>det 2×2</td><td>det[a b; c d] = ad − bc</td></tr>
        <tr><td>det by cofactors</td><td>det(A) = Σ<sub>j</sub> a<sub>1j</sub>C<sub>1j</sub>, &nbsp;C<sub>ij</sub> = (−1)<sup>i+j</sup>M<sub>ij</sub></td></tr>
        <tr><td>Row op effects</td><td>Swap → det flips sign; scale row by k → det × k; add multiple → det unchanged</td></tr>
      </tbody>
    </table>

    <div class="subsection-title pink">Vector Spaces (Lesson 3)</div>
    <div class="formula-box pink">V is a vector space if it satisfies 10 axioms (closure, commutativity, distributivity, identity, inverses)</div>
    <p class="concept-text">
      Key subsets: <strong>span</strong>{v₁,...,vₙ} = all linear combos; a <strong>basis</strong> is a linearly independent spanning set; <strong>dimension</strong> = number of basis vectors. Null space, column space, and row space are the fundamental subspaces of a matrix.
    </p>

    <div class="subsection-title indigo">Linear Transformations (Lesson 4)</div>
    <div class="formula-grid">
      <div class="formula-box">T(u+v) = T(u)+T(v)</div>
      <div class="formula-box">T(cu) = cT(u)</div>
    </div>
    <p class="concept-text">
      Every linear transformation T: ℝⁿ → ℝᵐ has a standard matrix A where T(x) = Ax. The columns of A are T(e₁), T(e₂), ..., T(eₙ). <strong>Kernel</strong> (null space) and <strong>image</strong> (column space) quantify what gets sent to zero and what gets hit.
    </p>

    <div class="subsection-title amber">Eigenvalues &amp; Eigenvectors (Lesson 5)</div>
    <div class="formula-box amber large">Av = λv &nbsp;⟺&nbsp; (A − λI)v = 0 &nbsp;⟺&nbsp; det(A − λI) = 0</div>
    <div class="formula-grid">
      <div class="formula-box">Characteristic poly: p(λ) = det(A−λI)</div>
      <div class="formula-box green">Diagonalization: A = PDP⁻¹</div>
    </div>
    <div class="key-point">
      A is diagonalizable iff it has n linearly independent eigenvectors. Symmetric matrices always diagonalize with orthogonal P (spectral theorem).
    </div>

    <div class="subsection-title green">Inner Products (Lesson 6)</div>
    <table class="formula-table">
      <thead><tr><th>Concept</th><th>Formula</th></tr></thead>
      <tbody>
        <tr><td>Dot product (ℝⁿ)</td><td>u·v = Σ uᵢvᵢ = |u||v|cos θ</td></tr>
        <tr><td>Norm</td><td>||v|| = √(v·v)</td></tr>
        <tr><td>Orthogonality</td><td>u ⊥ v iff u·v = 0</td></tr>
        <tr><td>Gram–Schmidt</td><td>e₁ = v₁/||v₁||; eₖ = (vₖ − projections)/norm</td></tr>
        <tr><td>Projection</td><td>proj_u v = (v·u/u·u)u</td></tr>
        <tr><td>Least squares</td><td>AᵀAx̂ = Aᵀb (normal equations)</td></tr>
      </tbody>
    </table>

  </div></div>
</div>

<!-- ========================================================== -->
<!-- SECTION 2: DIFFERENTIAL EQUATIONS REVIEW -->
<!-- ========================================================== -->
<div class="section-card" data-section="2">
  <div class="section-header" onclick="toggleSection(this)">
    <h2><span class="section-num">2</span> Differential Equations Review (Lessons 7–12)</h2>
    <svg class="chevron" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"/></svg>
  </div>
  <div class="section-body"><div class="section-inner">

    <p class="concept-text">
      ODEs describe how quantities change. The key skill is identifying the <strong>type</strong> of equation and applying the matching technique. Always verify by substituting your solution back in.
    </p>

    <div class="subsection-title indigo">First-Order ODEs (Lessons 7–8)</div>
    <table class="formula-table">
      <thead><tr><th>Type</th><th>Form</th><th>Method</th></tr></thead>
      <tbody>
        <tr><td>Separable</td><td>dy/dx = g(x)h(y)</td><td>∫ dy/h(y) = ∫ g(x)dx</td></tr>
        <tr><td>Linear</td><td>y' + P(x)y = Q(x)</td><td>Integrating factor μ = e^(∫P dx)</td></tr>
        <tr><td>Exact</td><td>M dx + N dy = 0, M_y = N_x</td><td>Find F: F_x = M, F_y = N; solution F = C</td></tr>
        <tr><td>Bernoulli</td><td>y' + P(x)y = Q(x)yⁿ</td><td>Sub v = y^(1−n), reduces to linear</td></tr>
      </tbody>
    </table>
    <div class="key-point">
      For linear first-order: multiply both sides by μ(x) = e^(∫P dx). The left side becomes (μy)'. Integrate both sides: μy = ∫μQ dx + C.
    </div>

    <div class="subsection-title green">Second-Order ODEs (Lessons 9–10)</div>
    <div class="formula-box large">ay'' + by' + cy = 0 &nbsp;→&nbsp; characteristic: ar² + br + c = 0</div>
    <table class="formula-table">
      <thead><tr><th>Roots</th><th>General Solution</th></tr></thead>
      <tbody>
        <tr><td>Two real roots r₁ ≠ r₂</td><td>y = C₁e^(r₁x) + C₂e^(r₂x)</td></tr>
        <tr><td>Repeated root r</td><td>y = (C₁ + C₂x)e^(rx)</td></tr>
        <tr><td>Complex roots α ± βi</td><td>y = e^(αx)[C₁cos(βx) + C₂sin(βx)]</td></tr>
      </tbody>
    </table>
    <p class="concept-text">
      <strong>Nonhomogeneous</strong> ay'' + by' + cy = g(x): general solution = y_h + y_p. Find y_p by <strong>undetermined coefficients</strong> (guess based on form of g) or <strong>variation of parameters</strong> (always works).
    </p>
    <div class="formula-grid">
      <div class="formula-box pink">Undetermined coeffs: g = e^(αx) → guess Ae^(αx)</div>
      <div class="formula-box pink">g = sin/cos → guess Asin + Bcos</div>
    </div>

    <div class="subsection-title amber">Laplace Transforms (Lesson 11)</div>
    <table class="formula-table">
      <thead><tr><th>f(t)</th><th>L{f}(s)</th></tr></thead>
      <tbody>
        <tr><td>1</td><td>1/s, &nbsp;s &gt; 0</td></tr>
        <tr><td>t^n</td><td>n!/s^(n+1)</td></tr>
        <tr><td>e^(at)</td><td>1/(s−a), &nbsp;s &gt; a</td></tr>
        <tr><td>sin(bt)</td><td>b/(s²+b²)</td></tr>
        <tr><td>cos(bt)</td><td>s/(s²+b²)</td></tr>
        <tr><td>e^(at)f(t)</td><td>F(s−a) (first shifting)</td></tr>
        <tr><td>f'(t)</td><td>sF(s) − f(0)</td></tr>
        <tr><td>f''(t)</td><td>s²F(s) − sf(0) − f'(0)</td></tr>
        <tr><td>u(t−a)f(t−a)</td><td>e^(−as)F(s) (second shifting)</td></tr>
      </tbody>
    </table>
    <div class="key-point">
      Laplace strategy: transform equation → algebraic equation in s → solve for Y(s) → partial fractions → inverse transform. Handles IVPs elegantly.
    </div>

    <div class="subsection-title indigo">Systems of ODEs (Lesson 12)</div>
    <div class="formula-box">x' = Ax &nbsp;→&nbsp; x(t) = e^(At)x(0) &nbsp;or&nbsp; x(t) = PΦ(t)P⁻¹x(0)</div>
    <p class="concept-text">
      For a 2×2 system: find eigenvalues λ₁, λ₂ and eigenvectors v₁, v₂. General solution: <strong>x(t) = C₁e^(λ₁t)v₁ + C₂e^(λ₂t)v₂</strong>. If repeated eigenvalue, need generalized eigenvectors. Phase plane behavior determined by signs and types of eigenvalues.
    </p>
    <table class="formula-table">
      <thead><tr><th>Eigenvalue type</th><th>Phase portrait</th></tr></thead>
      <tbody>
        <tr><td>λ₁ &lt; λ₂ &lt; 0</td><td>Stable node (sink)</td></tr>
        <tr><td>0 &lt; λ₁ &lt; λ₂</td><td>Unstable node (source)</td></tr>
        <tr><td>λ₁ &lt; 0 &lt; λ₂</td><td>Saddle point</td></tr>
        <tr><td>α ± βi, α &lt; 0</td><td>Stable spiral</td></tr>
        <tr><td>±βi (pure imaginary)</td><td>Center (closed orbits)</td></tr>
      </tbody>
    </table>

  </div></div>
</div>

<!-- ========================================================== -->
<!-- SECTION 3: MULTIVARIABLE CALCULUS REVIEW -->
<!-- ========================================================== -->
<div class="section-card" data-section="3">
  <div class="section-header" onclick="toggleSection(this)">
    <h2><span class="section-num">3</span> Multivariable Calculus Review (Lessons 13–16)</h2>
    <svg class="chevron" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"/></svg>
  </div>
  <div class="section-body"><div class="section-inner">

    <p class="concept-text">
      Calculus extends to functions of multiple variables. Derivatives become <strong>partial derivatives</strong> and <strong>gradients</strong>; single integrals become <strong>double and triple integrals</strong>. Coordinate changes simplify many computations dramatically.
    </p>

    <div class="subsection-title indigo">Vectors in 3D &amp; Geometry (Lesson 13)</div>
    <div class="formula-grid">
      <div class="formula-box">a · b = |a||b|cos θ = a₁b₁+a₂b₂+a₃b₃</div>
      <div class="formula-box pink">a × b: |a||b|sin θ, use determinant formula</div>
    </div>
    <table class="formula-table">
      <thead><tr><th>Object</th><th>Equation</th></tr></thead>
      <tbody>
        <tr><td>Line through P, direction d</td><td>r(t) = P + td</td></tr>
        <tr><td>Plane through P, normal n</td><td>n · (r − P) = 0</td></tr>
        <tr><td>Distance: point to plane</td><td>d = |ax₀+by₀+cz₀+d| / √(a²+b²+c²)</td></tr>
      </tbody>
    </table>

    <div class="subsection-title green">Partial Derivatives &amp; Gradient (Lesson 14)</div>
    <div class="formula-box green large">∇f = (∂f/∂x, ∂f/∂y, ∂f/∂z) — points in direction of steepest ascent</div>
    <div class="formula-grid">
      <div class="formula-box">D_u f = ∇f · û (directional derivative)</div>
      <div class="formula-box amber">Chain rule: dz/dt = (∂z/∂x)(dx/dt) + (∂z/∂y)(dy/dt)</div>
    </div>
    <div class="key-point">
      The gradient is perpendicular to level curves/surfaces. Max directional derivative = |∇f|, in direction of ∇f. Level surface F(x,y,z)=C has normal vector ∇F.
    </div>

    <div class="subsection-title pink">Optimization (Lesson 15)</div>
    <div class="formula-box pink">Critical points: ∇f = 0 (set all partials to zero)</div>
    <div class="formula-table" style="margin-top:10px">
      <table class="formula-table">
        <thead><tr><th>Second Derivative Test (2D)</th><th>Result</th></tr></thead>
        <tbody>
          <tr><td>D = f_xx·f_yy − (f_xy)², D &gt; 0, f_xx &gt; 0</td><td>Local minimum</td></tr>
          <tr><td>D &gt; 0, f_xx &lt; 0</td><td>Local maximum</td></tr>
          <tr><td>D &lt; 0</td><td>Saddle point</td></tr>
          <tr><td>D = 0</td><td>Test inconclusive</td></tr>
        </tbody>
      </table>
    </div>
    <p class="concept-text">
      <strong>Lagrange multipliers</strong>: to optimize f(x,y) subject to g(x,y)=k, solve ∇f = λ∇g simultaneously with g=k.
    </p>

    <div class="subsection-title amber">Double &amp; Triple Integrals (Lesson 16)</div>
    <div class="formula-grid">
      <div class="formula-box amber">∬_R f dA = ∫∫ f(x,y) dx dy (Fubini's theorem)</div>
      <div class="formula-box">∭_E f dV = ∫∫∫ f dx dy dz</div>
    </div>
    <table class="formula-table">
      <thead><tr><th>Coordinate system</th><th>Volume element dV</th></tr></thead>
      <tbody>
        <tr><td>Polar (2D)</td><td>r dr dθ &nbsp;(x=rcosθ, y=rsinθ)</td></tr>
        <tr><td>Cylindrical (3D)</td><td>r dr dθ dz &nbsp;(same as polar + z)</td></tr>
        <tr><td>Spherical (3D)</td><td>ρ²sinφ dρ dφ dθ &nbsp;(x=ρsinφcosθ, etc.)</td></tr>
      </tbody>
    </table>
    <div class="formula-box green">Change of variables: ∬_R f dA = ∬_S f(x(u,v), y(u,v)) |J| du dv, &nbsp;J = ∂(x,y)/∂(u,v)</div>
    <div class="key-point">
      Choose coordinates to match the region's symmetry. Circular regions → polar. Cylinders/cones → cylindrical. Spheres → spherical. Always check Jacobian carefully.
    </div>

  </div></div>
</div>

<!-- ========================================================== -->
<!-- SECTION 4: VECTOR CALC & ADVANCED TOPICS REVIEW -->
<!-- ========================================================== -->
<div class="section-card" data-section="4">
  <div class="section-header" onclick="toggleSection(this)">
    <h2><span class="section-num">4</span> Vector Calc &amp; Advanced Topics (Lessons 17–20)</h2>
    <svg class="chevron" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"/></svg>
  </div>
  <div class="section-body"><div class="section-inner">

    <div class="subsection-title indigo">Line &amp; Surface Integrals, Fundamental Theorems (Lesson 17)</div>
    <table class="formula-table">
      <thead><tr><th>Integral</th><th>Formula</th></tr></thead>
      <tbody>
        <tr><td>Line integral (scalar)</td><td>∫_C f ds = ∫_a^b f(r(t))|r'(t)| dt</td></tr>
        <tr><td>Line integral (vector)</td><td>∫_C F·dr = ∫_a^b F(r(t))·r'(t) dt</td></tr>
        <tr><td>Surface integral (scalar)</td><td>∬_S f dS = ∬_D f(r)|r_u × r_v| dA</td></tr>
        <tr><td>Flux integral</td><td>∬_S F·dS = ∬_D F·(r_u × r_v) dA</td></tr>
        <tr><td>div F</td><td>∂P/∂x + ∂Q/∂y + ∂R/∂z</td></tr>
        <tr><td>curl F</td><td>(R_y−Q_z, P_z−R_x, Q_x−P_y) = ∇×F</td></tr>
      </tbody>
    </table>
    <div class="formula-grid">
      <div class="formula-box green">Green's Theorem: ∮_C F·dr = ∬_D (Q_x−P_y) dA</div>
      <div class="formula-box amber">Stokes' Theorem: ∮_C F·dr = ∬_S (curl F)·dS</div>
    </div>
    <div class="formula-box pink large">Divergence Theorem: ∬_S F·dS = ∭_E (div F) dV</div>
    <div class="key-point">
      All three theorems relate an integral over a boundary to an integral over the interior. Conservative field ⟺ curl F = 0 ⟺ F = ∇f ⟺ path-independent line integrals.
    </div>

    <div class="subsection-title pink">Complex Numbers (Lesson 18)</div>
    <div class="formula-grid">
      <div class="formula-box pink">Euler: e^(iθ) = cosθ + i sinθ</div>
      <div class="formula-box">|z| = √(a²+b²), arg(z) = arctan(b/a)</div>
    </div>
    <table class="formula-table">
      <thead><tr><th>Operation</th><th>Polar form advantage</th></tr></thead>
      <tbody>
        <tr><td>Multiply z₁z₂</td><td>|z₁||z₂|, arg = θ₁+θ₂</td></tr>
        <tr><td>De Moivre</td><td>(re^(iθ))^n = r^n e^(inθ)</td></tr>
        <tr><td>nth roots</td><td>z^(1/n) = r^(1/n) e^(i(θ+2πk)/n), k=0..n−1</td></tr>
      </tbody>
    </table>

    <div class="subsection-title amber">Fourier Analysis (Lesson 19)</div>
    <div class="formula-box amber">Fourier series: f(x) = a₀/2 + Σ[aₙcos(nπx/L) + bₙsin(nπx/L)]</div>
    <div class="formula-grid">
      <div class="formula-box">aₙ = (1/L)∫₋_L^L f(x)cos(nπx/L)dx</div>
      <div class="formula-box">bₙ = (1/L)∫₋_L^L f(x)sin(nπx/L)dx</div>
    </div>
    <p class="concept-text">
      <strong>Parseval's theorem</strong>: (1/L)∫|f|² dx = a₀²/2 + Σ(aₙ²+bₙ²). The Fourier transform generalizes to non-periodic functions: F̂(ξ) = ∫f(x)e^(−2πiξx)dx.
    </p>

    <div class="subsection-title green">Probability &amp; Statistics (Lesson 20)</div>
    <table class="formula-table">
      <thead><tr><th>Concept</th><th>Formula</th></tr></thead>
      <tbody>
        <tr><td>E[X] (discrete)</td><td>Σ x P(X=x)</td></tr>
        <tr><td>E[X] (continuous)</td><td>∫ x f(x) dx</td></tr>
        <tr><td>Var(X)</td><td>E[X²] − (E[X])²</td></tr>
        <tr><td>Normal PDF</td><td>(1/σ√(2π))e^(−(x−μ)²/2σ²)</td></tr>
        <tr><td>Binomial P(X=k)</td><td>C(n,k)p^k(1−p)^(n−k)</td></tr>
        <tr><td>Poisson P(X=k)</td><td>λ^k e^(−λ)/k!</td></tr>
        <tr><td>CLT</td><td>X̄ ~ N(μ, σ²/n) for large n</td></tr>
        <tr><td>Bayes' theorem</td><td>P(A|B) = P(B|A)P(A)/P(B)</td></tr>
      </tbody>
    </table>

  </div></div>
</div>

<!-- ========================================================== -->
<!-- SECTION 5: EXAM STRATEGIES & INTERACTIVE TOOLS -->
<!-- ========================================================== -->
<div class="section-card" data-section="5">
  <div class="section-header" onclick="toggleSection(this)">
    <h2><span class="section-num">5</span> Exam Strategies &amp; Interactive Tools</h2>
    <svg class="chevron" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"/></svg>
  </div>
  <div class="section-body"><div class="section-inner">

    <div class="subsection-title amber">Time Management</div>
    <ul class="tip-list">
      <li class="amber-tip"><span class="tip-num">1</span>Read all questions first (2 min). Flag hard ones and do easy ones first — every point counts equally.</li>
      <li class="amber-tip"><span class="tip-num">2</span>Allocate time per point value. On a 2-hour exam with 100 points, budget ~1.2 min/point.</li>
      <li class="amber-tip"><span class="tip-num">3</span>If stuck, write down the setup (formula, integral bounds, matrix) and move on. Partial credit is real.</li>
    </ul>

    <div class="subsection-title pink">Common Mistakes to Avoid</div>
    <ul class="tip-list">
      <li class="pink-tip"><span class="tip-num">!</span>Forgetting the Jacobian when changing variables in integrals (polar: r; spherical: ρ²sinφ).</li>
      <li class="pink-tip"><span class="tip-num">!</span>Sign errors in determinants — always double-check cofactor signs (−1)^(i+j).</li>
      <li class="pink-tip"><span class="tip-num">!</span>Missing constant of integration in indefinite integrals and ODE solutions.</li>
      <li class="pink-tip"><span class="tip-num">!</span>Confusing Stokes vs Divergence theorem — Stokes relates line integral to surface; Divergence relates surface to volume.</li>
      <li class="pink-tip"><span class="tip-num">!</span>Applying undetermined coefficients when the particular guess is already a solution to the homogeneous equation (multiply by x).</li>
    </ul>

    <div class="subsection-title green">Approaching Unfamiliar Problems</div>
    <ul class="tip-list">
      <li class="green-tip"><span class="tip-num">→</span>Identify what type of object is involved: scalar, vector, matrix, function, distribution.</li>
      <li class="green-tip"><span class="tip-num">→</span>Write down every definition and formula you know that involves those objects.</li>
      <li class="green-tip"><span class="tip-num">→</span>Check dimensions/units at each step. Matrix products, integral bounds, and function arguments all have "types."</li>
      <li class="green-tip"><span class="tip-num">→</span>Work a simpler version first (2D instead of 3D, specific values instead of general). Pattern transfer.</li>
    </ul>

    <div class="subsection-title indigo">Worked Multi-Step Example: Combining Topics</div>
    <div class="worked-example">
      <div class="we-title">Example — Find the volume of the region inside x²+y²=4, above z=0, below z=6−x²−y²</div>
      <div class="we-step"><strong>Step 1: Recognize geometry.</strong> Paraboloid z = 6−r² meets cylinder r=2. At r=2: z = 6−4 = 2. Region: 0 ≤ r ≤ 2, 0 ≤ z ≤ 6−r².</div>
      <div class="we-step"><strong>Step 2: Switch to cylindrical.</strong> dV = r dr dθ dz. Limits: θ∈[0,2π], r∈[0,2], z∈[0, 6−r²].</div>
      <div class="we-step"><strong>Step 3: Set up integral.</strong> V = ∫₀^(2π) ∫₀^2 ∫₀^(6−r²) r dz dr dθ</div>
      <div class="we-step"><strong>Step 4: Integrate z first.</strong> ∫₀^(6−r²) dz = 6−r². So V = 2π ∫₀^2 r(6−r²) dr</div>
      <div class="we-step"><strong>Step 5: Integrate r.</strong> ∫₀^2 (6r − r³) dr = [3r² − r⁴/4]₀^2 = 12 − 4 = 8. Thus V = 2π · 8 = <strong>16π</strong>.</div>
    </div>

    <!-- FORMULA REFERENCE CARD -->
    <div class="subsection-title indigo" style="margin-top:24px">Formula Reference Card (Tabbed Cheat Sheet)</div>
    <div class="tab-bar" id="refTabs">
      <button class="tab-btn active" onclick="switchTab('ref','linAlg',this)">Linear Algebra</button>
      <button class="tab-btn" onclick="switchTab('ref','odes',this)">ODEs</button>
      <button class="tab-btn" onclick="switchTab('ref','multiv',this)">Multivariable</button>
      <button class="tab-btn" onclick="switchTab('ref','vcalc',this)">Vector Calc</button>
      <button class="tab-btn" onclick="switchTab('ref','prob',this)">Probability</button>
    </div>
    <div id="ref-linAlg" class="tab-panel active">
      <div class="formula-box" style="margin-bottom:8px">det(A−λI) = 0 → eigenvalues; (A−λI)v = 0 → eigenvectors</div>
      <div class="formula-box green" style="margin-bottom:8px">A = PDP⁻¹ (diagonalization) &nbsp;|&nbsp; A = QRQ^T (symmetric, Q orthogonal)</div>
      <div class="formula-box amber" style="margin-bottom:8px">Rank–Nullity: rank(A) + nullity(A) = n (# columns)</div>
      <div class="formula-box pink" style="margin-bottom:8px">Least squares: AᵀAx̂ = Aᵀb &nbsp;|&nbsp; proj = A(AᵀA)⁻¹Aᵀb</div>
      <div class="formula-box" style="margin-bottom:8px">Gram–Schmidt: u₁=v₁; uₖ = vₖ − Σⱼ(vₖ·uⱼ/uⱼ·uⱼ)uⱼ</div>
      <div class="formula-box green">Cross product: a×b = det[i j k; a₁ a₂ a₃; b₁ b₂ b₃]</div>
    </div>
    <div id="ref-odes" class="tab-panel">
      <div class="formula-box" style="margin-bottom:8px">Linear 1st order: y' + Py = Q → μ=e^(∫P); μy = ∫μQ dx + C</div>
      <div class="formula-box green" style="margin-bottom:8px">2nd order char. roots: r = [−b ± √(b²−4ac)] / 2a</div>
      <div class="formula-box amber" style="margin-bottom:8px">L{y'} = sY − y(0); &nbsp;L{y''} = s²Y − sy(0) − y'(0)</div>
      <div class="formula-box pink" style="margin-bottom:8px">Convolution: L{(f*g)} = F(s)G(s); &nbsp;(f*g)(t) = ∫₀^t f(τ)g(t−τ)dτ</div>
      <div class="formula-box" style="margin-bottom:8px">Systems: x' = Ax → x(t) = C₁e^(λ₁t)v₁ + C₂e^(λ₂t)v₂</div>
      <div class="formula-box green">Wronskian: W = det[y₁ y₂; y₁' y₂'] ≠ 0 iff lin. independent</div>
    </div>
    <div id="ref-multiv" class="tab-panel">
      <div class="formula-box" style="margin-bottom:8px">∇f = (f_x, f_y, f_z) &nbsp;|&nbsp; D_û f = ∇f · û = |∇f|cosθ</div>
      <div class="formula-box green" style="margin-bottom:8px">2nd deriv test: D = f_xx f_yy − f_xy². Min if D>0,f_xx>0; Max if D>0,f_xx&lt;0; Saddle if D&lt;0</div>
      <div class="formula-box amber" style="margin-bottom:8px">Lagrange: ∇f = λ∇g and g(x,y)=k simultaneously</div>
      <div class="formula-box pink" style="margin-bottom:8px">Polar: x=rcosθ, y=rsinθ, dA = r dr dθ</div>
      <div class="formula-box" style="margin-bottom:8px">Spherical: x=ρsinφcosθ, y=ρsinφsinθ, z=ρcosφ, dV=ρ²sinφ dρdφdθ</div>
      <div class="formula-box green">Jacobian: J = ∂(x,y)/∂(u,v) = det[x_u x_v; y_u y_v]</div>
    </div>
    <div id="ref-vcalc" class="tab-panel">
      <div class="formula-box" style="margin-bottom:8px">Line integral: ∫_C F·dr = ∫_a^b F(r(t))·r'(t) dt</div>
      <div class="formula-box green" style="margin-bottom:8px">Green's: ∮_C (P dx+Q dy) = ∬_D (Q_x−P_y) dA</div>
      <div class="formula-box amber" style="margin-bottom:8px">Stokes': ∮_C F·dr = ∬_S (∇×F)·dS</div>
      <div class="formula-box pink" style="margin-bottom:8px">Divergence: ∯_S F·dS = ∭_E (∇·F) dV</div>
      <div class="formula-box" style="margin-bottom:8px">curl F = ∇×F = (R_y−Q_z, P_z−R_x, Q_x−P_y)</div>
      <div class="formula-box green">Conservative: F = ∇f ⟺ curl F = 0 (simply connected domain)</div>
    </div>
    <div id="ref-prob" class="tab-panel">
      <div class="formula-box" style="margin-bottom:8px">E[X] = Σx·P(x) or ∫x·f(x)dx &nbsp;|&nbsp; Var(X) = E[X²]−(E[X])²</div>
      <div class="formula-box green" style="margin-bottom:8px">Normal: f(x) = e^(−(x−μ)²/2σ²) / (σ√(2π))</div>
      <div class="formula-box amber" style="margin-bottom:8px">Binomial: P(X=k) = C(n,k)p^k(1−p)^(n−k), E[X]=np, Var=np(1−p)</div>
      <div class="formula-box pink" style="margin-bottom:8px">Poisson: P(X=k)=λ^k e^(−λ)/k!, E[X]=Var(X)=λ</div>
      <div class="formula-box" style="margin-bottom:8px">Bayes: P(A|B) = P(B|A)P(A) / P(B)</div>
      <div class="formula-box green">CLT: (X̄−μ)/(σ/√n) → N(0,1) as n→∞</div>
    </div>

    <!-- TOPIC MASTERY CHECKLIST -->
    <div class="subsection-title green" style="margin-top:28px">Topic Mastery Self-Assessment</div>
    <div class="mastery-wrap">
      <div class="mastery-header">
        <span class="mastery-title">Mark topics you have mastered</span>
        <span class="mastery-pct" id="masteryPct">0%</span>
      </div>
      <div class="mastery-bar-track"><div class="mastery-bar-fill" id="masteryBarFill"></div></div>
      <div class="mastery-grid" id="masteryGrid">
        <div class="mastery-item" onclick="toggleMastery(this,0)"><input type="checkbox" id="m0"><label for="m0">L01 — Systems &amp; Gaussian Elim.</label></div>
        <div class="mastery-item" onclick="toggleMastery(this,1)"><input type="checkbox" id="m1"><label for="m1">L02 — Matrix Operations</label></div>
        <div class="mastery-item" onclick="toggleMastery(this,2)"><input type="checkbox" id="m2"><label for="m2">L03 — Vector Spaces</label></div>
        <div class="mastery-item" onclick="toggleMastery(this,3)"><input type="checkbox" id="m3"><label for="m3">L04 — Linear Transformations</label></div>
        <div class="mastery-item" onclick="toggleMastery(this,4)"><input type="checkbox" id="m4"><label for="m4">L05 — Eigenvalues &amp; Eigenvectors</label></div>
        <div class="mastery-item" onclick="toggleMastery(this,5)"><input type="checkbox" id="m5"><label for="m5">L06 — Inner Product Spaces</label></div>
        <div class="mastery-item" onclick="toggleMastery(this,6)"><input type="checkbox" id="m6"><label for="m6">L07 — First-Order ODEs</label></div>
        <div class="mastery-item" onclick="toggleMastery(this,7)"><input type="checkbox" id="m7"><label for="m7">L08 — ODE Applications</label></div>
        <div class="mastery-item" onclick="toggleMastery(this,8)"><input type="checkbox" id="m8"><label for="m8">L09 — Second-Order ODEs</label></div>
        <div class="mastery-item" onclick="toggleMastery(this,9)"><input type="checkbox" id="m9"><label for="m9">L10 — Nonhomogeneous ODEs</label></div>
        <div class="mastery-item" onclick="toggleMastery(this,10)"><input type="checkbox" id="m10"><label for="m10">L11 — Laplace Transforms</label></div>
        <div class="mastery-item" onclick="toggleMastery(this,11)"><input type="checkbox" id="m11"><label for="m11">L12 — Systems of ODEs</label></div>
        <div class="mastery-item" onclick="toggleMastery(this,12)"><input type="checkbox" id="m12"><label for="m12">L13 — Vectors &amp; 3D Geometry</label></div>
        <div class="mastery-item" onclick="toggleMastery(this,13)"><input type="checkbox" id="m13"><label for="m13">L14 — Partial Derivatives</label></div>
        <div class="mastery-item" onclick="toggleMastery(this,14)"><input type="checkbox" id="m14"><label for="m14">L15 — Optimization</label></div>
        <div class="mastery-item" onclick="toggleMastery(this,15)"><input type="checkbox" id="m15"><label for="m15">L16 — Multiple Integrals</label></div>
        <div class="mastery-item" onclick="toggleMastery(this,16)"><input type="checkbox" id="m16"><label for="m16">L17 — Vector Calculus</label></div>
        <div class="mastery-item" onclick="toggleMastery(this,17)"><input type="checkbox" id="m17"><label for="m17">L18 — Complex Analysis</label></div>
        <div class="mastery-item" onclick="toggleMastery(this,18)"><input type="checkbox" id="m18"><label for="m18">L19 — Fourier Analysis</label></div>
      </div>
    </div>

    <!-- PROBLEM GENERATOR -->
    <div class="subsection-title pink" style="margin-top:28px">Mixed Practice Problem Generator</div>
    <div class="gen-wrap">
      <p class="concept-text" style="margin-bottom:10px">Generate a random problem from any topic area. Work it out, then reveal the solution.</p>
      <div class="controls-row">
        <button class="btn btn-primary" onclick="generateProblem()">Generate Problem</button>
        <button class="btn btn-green" id="revealSolBtn" onclick="revealSolution()" style="display:none">Reveal Solution</button>
        <span id="genTopicTag" class="gen-tag" style="display:none"></span>
      </div>
      <div class="gen-problem-display" id="genProblemDisplay" style="color:var(--text-dim);font-style:italic">Click "Generate Problem" to receive a random practice question.</div>
      <div class="gen-solution" id="genSolution"></div>
    </div>

    <!-- TIMED MOCK EXAM -->
    <div class="subsection-title amber" style="margin-top:28px">Timed Mock Exam (20 minutes, 10 questions)</div>
    <div class="mock-wrap">
      <div id="mockStart">
        <p class="concept-text">Simulate real exam conditions. 10 randomized questions, 20-minute timer. Submit all at once for your score.</p>
        <div class="controls-row" style="justify-content:center;margin-top:16px">
          <button class="btn btn-amber" onclick="startMockExam()">Start Mock Exam</button>
        </div>
      </div>
      <div id="mockRunning" style="display:none">
        <div class="mock-timer-display" id="mockTimer">20:00</div>
        <div class="mock-status" id="mockStatus">Time remaining — answer all 10 questions then submit</div>
        <div class="mock-q-wrap active" id="mockQWrap"></div>
        <div class="controls-row" style="justify-content:center;margin-top:16px">
          <button class="btn btn-primary" onclick="submitMockExam()">Submit Exam</button>
          <button class="btn btn-danger" onclick="abandonMockExam()">Abandon</button>
        </div>
      </div>
      <div class="mock-results" id="mockResults">
        <div class="mock-score-big" id="mockScoreBig"><span id="mockScoreNum">0</span>/10</div>
        <div class="mock-score-label" id="mockScoreLabel">questions correct</div>
        <div style="margin-top:20px" id="mockReviewWrap"></div>
        <div class="controls-row" style="justify-content:center;margin-top:16px">
          <button class="btn btn-amber" onclick="resetMockExam()">Try Again</button>
        </div>
      </div>
    </div>

  </div></div>
</div>

<!-- ========================================================== -->
<!-- COMPREHENSIVE QUIZ (20 Questions) -->
<!-- ========================================================== -->
<div class="section-card" id="quizSection">
  <div class="section-header" onclick="toggleSection(this)">
    <h2><span class="section-num" style="background:var(--amber-dim);color:var(--amber)">Q</span> Comprehensive Final Quiz — 20 Questions</h2>
    <svg class="chevron" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"/></svg>
  </div>
  <div class="section-body"><div class="section-inner">
    <div class="quiz-score">
      <span class="score-text">Score: <span id="quizScore">0</span> / 20</span>
      <span style="font-size:.72rem;color:var(--text-dim)">Covering all Higher Math topics</span>
    </div>

    <!-- Q1 -->
    <div class="quiz-q" id="qq1">
      <div class="q-num">Question 1 — Linear Algebra</div>
      <div class="q-text">Which row operation changes the value of a determinant?</div>
      <div class="choices">
        <button class="choice-btn" onclick="checkMC(this,'qq1',false)">A. Adding a multiple of one row to another</button>
        <button class="choice-btn" onclick="checkMC(this,'qq1',true)">B. Swapping two rows</button>
        <button class="choice-btn" onclick="checkMC(this,'qq1',false)">C. Both A and B change the determinant</button>
        <button class="choice-btn" onclick="checkMC(this,'qq1',false)">D. Neither changes the determinant</button>
      </div>
    </div>

    <!-- Q2 -->
    <div class="quiz-q" id="qq2">
      <div class="q-num">Question 2 — Eigenvalues</div>
      <div class="q-text">For the matrix A = [3 1; 0 3], what is the correct characterization of its eigenvalues?</div>
      <div class="choices">
        <button class="choice-btn" onclick="checkMC(this,'qq2',false)">A. Two distinct real eigenvalues: 0 and 3</button>
        <button class="choice-btn" onclick="checkMC(this,'qq2',true)">B. A repeated eigenvalue λ = 3 (algebraic multiplicity 2)</button>
        <button class="choice-btn" onclick="checkMC(this,'qq2',false)">C. Complex conjugate eigenvalues 3 ± i</button>
        <button class="choice-btn" onclick="checkMC(this,'qq2',false)">D. Eigenvalues 1 and 9</button>
      </div>
    </div>

    <!-- Q3 -->
    <div class="quiz-q" id="qq3">
      <div class="q-num">Question 3 — Vector Spaces</div>
      <div class="q-text">The rank-nullity theorem states that for an m×n matrix A: rank(A) + nullity(A) = ?</div>
      <div class="choices">
        <button class="choice-btn" onclick="checkMC(this,'qq3',false)">A. m (number of rows)</button>
        <button class="choice-btn" onclick="checkMC(this,'qq3',true)">B. n (number of columns)</button>
        <button class="choice-btn" onclick="checkMC(this,'qq3',false)">C. m + n</button>
        <button class="choice-btn" onclick="checkMC(this,'qq3',false)">D. m − n</button>
      </div>
    </div>

    <!-- Q4 -->
    <div class="quiz-q" id="qq4">
      <div class="q-num">Question 4 — First-Order ODEs</div>
      <div class="q-text">The ODE dy/dx = 2xy is best solved by which method?</div>
      <div class="choices">
        <button class="choice-btn" onclick="checkMC(this,'qq4',true)">A. Separation of variables: dy/y = 2x dx</button>
        <button class="choice-btn" onclick="checkMC(this,'qq4',false)">B. Undetermined coefficients</button>
        <button class="choice-btn" onclick="checkMC(this,'qq4',false)">C. Characteristic equation</button>
        <button class="choice-btn" onclick="checkMC(this,'qq4',false)">D. Laplace transform (since no initial conditions)</button>
      </div>
    </div>

    <!-- Q5 -->
    <div class="quiz-q" id="qq5">
      <div class="q-num">Question 5 — Second-Order ODEs</div>
      <div class="q-text">The characteristic equation r² + 4r + 5 = 0 has roots r = −2 ± i. The general solution to y'' + 4y' + 5y = 0 is:</div>
      <div class="choices">
        <button class="choice-btn" onclick="checkMC(this,'qq5',false)">A. y = C₁e^(−2x) + C₂e^(x)</button>
        <button class="choice-btn" onclick="checkMC(this,'qq5',true)">B. y = e^(−2x)(C₁cos x + C₂sin x)</button>
        <button class="choice-btn" onclick="checkMC(this,'qq5',false)">C. y = (C₁ + C₂x)e^(−2x)</button>
        <button class="choice-btn" onclick="checkMC(this,'qq5',false)">D. y = C₁cos(2x) + C₂sin(2x)</button>
      </div>
    </div>

    <!-- Q6 -->
    <div class="quiz-q" id="qq6">
      <div class="q-num">Question 6 — Laplace Transforms</div>
      <div class="q-text">Using Laplace transforms, L{e^(3t)sin(2t)} = ?</div>
      <div class="choices">
        <button class="choice-btn" onclick="checkMC(this,'qq6',false)">A. 2 / (s² + 4)</button>
        <button class="choice-btn" onclick="checkMC(this,'qq6',false)">B. (s−3) / ((s−3)² + 4)</button>
        <button class="choice-btn" onclick="checkMC(this,'qq6',true)">C. 2 / ((s−3)² + 4)</button>
        <button class="choice-btn" onclick="checkMC(this,'qq6',false)">D. 2 / ((s+3)² + 4)</button>
      </div>
    </div>

    <!-- Q7 -->
    <div class="quiz-q" id="qq7">
      <div class="q-num">Question 7 — Partial Derivatives</div>
      <div class="q-text">For f(x,y) = x³y² − 3xy, what is ∂²f/∂y∂x (i.e., differentiate with respect to x first, then y)?</div>
      <div class="choices">
        <button class="choice-btn" onclick="checkMC(this,'qq7',false)">A. 6x²y</button>
        <button class="choice-btn" onclick="checkMC(this,'qq7',true)">B. 6x²y − 3</button>
        <button class="choice-btn" onclick="checkMC(this,'qq7',false)">C. 3x²y² − 3y</button>
        <button class="choice-btn" onclick="checkMC(this,'qq7',false)">D. 2x³y − 3x</button>
      </div>
    </div>

    <!-- Q8 -->
    <div class="quiz-q" id="qq8">
      <div class="q-num">Question 8 — Optimization</div>
      <div class="q-text">At a critical point (a,b) of f(x,y), the discriminant D = f_xx f_yy − (f_xy)² = −5. The point is a:</div>
      <div class="choices">
        <button class="choice-btn" onclick="checkMC(this,'qq8',false)">A. Local minimum</button>
        <button class="choice-btn" onclick="checkMC(this,'qq8',false)">B. Local maximum</button>
        <button class="choice-btn" onclick="checkMC(this,'qq8',true)">C. Saddle point</button>
        <button class="choice-btn" onclick="checkMC(this,'qq8',false)">D. Cannot be determined</button>
      </div>
    </div>

    <!-- Q9 -->
    <div class="quiz-q" id="qq9">
      <div class="q-num">Question 9 — Multiple Integrals</div>
      <div class="q-text">The integral ∫₀^1 ∫₀^(√(1−x²)) dy dx evaluates to:</div>
      <div class="choices">
        <button class="choice-btn" onclick="checkMC(this,'qq9',false)">A. 1</button>
        <button class="choice-btn" onclick="checkMC(this,'qq9',true)">B. π/4</button>
        <button class="choice-btn" onclick="checkMC(this,'qq9',false)">C. π/2</button>
        <button class="choice-btn" onclick="checkMC(this,'qq9',false)">D. 1/2</button>
      </div>
    </div>

    <!-- Q10 -->
    <div class="quiz-q" id="qq10">
      <div class="q-num">Question 10 — Vector Calculus</div>
      <div class="q-text">Which of the following is true about a conservative vector field F on a simply connected domain?</div>
      <div class="choices">
        <button class="choice-btn" onclick="checkMC(this,'qq10',false)">A. div F = 0 everywhere</button>
        <button class="choice-btn" onclick="checkMC(this,'qq10',true)">B. curl F = 0 and F = ∇f for some scalar f</button>
        <button class="choice-btn" onclick="checkMC(this,'qq10',false)">C. F is always a constant vector</button>
        <button class="choice-btn" onclick="checkMC(this,'qq10',false)">D. The flux through every closed surface is zero</button>
      </div>
    </div>

    <!-- Q11 -->
    <div class="quiz-q" id="qq11">
      <div class="q-num">Question 11 — Green's / Stokes' / Divergence Theorems</div>
      <div class="q-text">The Divergence Theorem relates a flux integral over a closed surface S to:</div>
      <div class="choices">
        <button class="choice-btn" onclick="checkMC(this,'qq11',false)">A. A line integral over the boundary curve of S</button>
        <button class="choice-btn" onclick="checkMC(this,'qq11',true)">B. A volume integral of div F over the enclosed region E</button>
        <button class="choice-btn" onclick="checkMC(this,'qq11',false)">C. A surface integral of curl F over any surface bounded by S</button>
        <button class="choice-btn" onclick="checkMC(this,'qq11',false)">D. A double integral of the Jacobian over a parameter domain</button>
      </div>
    </div>

    <!-- Q12 -->
    <div class="quiz-q" id="qq12">
      <div class="q-num">Question 12 — Complex Numbers</div>
      <div class="q-text">Using De Moivre's theorem, (1+i)^8 = ?</div>
      <div class="choices">
        <button class="choice-btn" onclick="checkMC(this,'qq12',false)">A. 8i</button>
        <button class="choice-btn" onclick="checkMC(this,'qq12',true)">B. 16</button>
        <button class="choice-btn" onclick="checkMC(this,'qq12',false)">C. 8 + 8i</button>
        <button class="choice-btn" onclick="checkMC(this,'qq12',false)">D. −16</button>
      </div>
    </div>

    <!-- Q13 -->
    <div class="quiz-q" id="qq13">
      <div class="q-num">Question 13 — Systems of ODEs</div>
      <div class="q-text">A 2×2 linear system x' = Ax has eigenvalues λ₁ = −1, λ₂ = −3. The equilibrium at the origin is a:</div>
      <div class="choices">
        <button class="choice-btn" onclick="checkMC(this,'qq13',true)">A. Stable node (sink) — both eigenvalues negative</button>
        <button class="choice-btn" onclick="checkMC(this,'qq13',false)">B. Unstable node (source)</button>
        <button class="choice-btn" onclick="checkMC(this,'qq13',false)">C. Saddle point</button>
        <button class="choice-btn" onclick="checkMC(this,'qq13',false)">D. Center (neutrally stable)</button>
      </div>
    </div>

    <!-- Q14 -->
    <div class="quiz-q" id="qq14">
      <div class="q-num">Question 14 — Inner Products / Gram-Schmidt</div>
      <div class="q-text">Given v₁ = (1,0) and v₂ = (1,1), the second Gram-Schmidt vector u₂ (before normalization) is:</div>
      <div class="choices">
        <button class="choice-btn" onclick="checkMC(this,'qq14',false)">A. (1,1)</button>
        <button class="choice-btn" onclick="checkMC(this,'qq14',true)">B. (0,1)</button>
        <button class="choice-btn" onclick="checkMC(this,'qq14',false)">C. (1,0)</button>
        <button class="choice-btn" onclick="checkMC(this,'qq14',false)">D. (1/√2, 1/√2)</button>
      </div>
    </div>

    <!-- Q15 -->
    <div class="quiz-q" id="qq15">
      <div class="q-num">Question 15 — Fourier Series</div>
      <div class="q-text">The Fourier series of an odd function f(x) on [−L, L] contains:</div>
      <div class="choices">
        <button class="choice-btn" onclick="checkMC(this,'qq15',false)">A. Only cosine terms (aₙ terms)</button>
        <button class="choice-btn" onclick="checkMC(this,'qq15',true)">B. Only sine terms (bₙ terms)</button>
        <button class="choice-btn" onclick="checkMC(this,'qq15',false)">C. Both sine and cosine terms</button>
        <button class="choice-btn" onclick="checkMC(this,'qq15',false)">D. Only the constant term a₀/2</button>
      </div>
    </div>

    <!-- Q16 -->
    <div class="quiz-q" id="qq16">
      <div class="q-num">Question 16 — Probability</div>
      <div class="q-text">A random variable X ~ Poisson(λ=4). What is P(X = 2)?</div>
      <div class="choices">
        <button class="choice-btn" onclick="checkMC(this,'qq16',false)">A. 4e^(−4)</button>
        <button class="choice-btn" onclick="checkMC(this,'qq16',true)">B. 8e^(−4)</button>
        <button class="choice-btn" onclick="checkMC(this,'qq16',false)">C. 16e^(−4)</button>
        <button class="choice-btn" onclick="checkMC(this,'qq16',false)">D. e^(−4)/2</button>
      </div>
    </div>

    <!-- Q17 -->
    <div class="quiz-q" id="qq17">
      <div class="q-num">Question 17 — Multivariable / Coordinate Change</div>
      <div class="q-text">Converting ∭_E dV to spherical coordinates over the unit ball (x²+y²+z²≤1) gives:</div>
      <div class="choices">
        <button class="choice-btn" onclick="checkMC(this,'qq17',false)">A. ∫₀^(2π)∫₀^π∫₀^1 dρ dφ dθ</button>
        <button class="choice-btn" onclick="checkMC(this,'qq17',true)">B. ∫₀^(2π)∫₀^π∫₀^1 ρ²sinφ dρ dφ dθ</button>
        <button class="choice-btn" onclick="checkMC(this,'qq17',false)">C. ∫₀^(2π)∫₀^π∫₀^1 ρ sinφ dρ dφ dθ</button>
        <button class="choice-btn" onclick="checkMC(this,'qq17',false)">D. ∫₀^(2π)∫₀^(π/2)∫₀^1 ρ²sinφ dρ dφ dθ</button>
      </div>
    </div>

    <!-- Q18 -->
    <div class="quiz-q" id="qq18">
      <div class="q-num">Question 18 — Nonhomogeneous ODEs</div>
      <div class="q-text">For y'' − y = e^x, the particular solution guess using undetermined coefficients fails initially because e^x solves the homogeneous equation. The correct guess is:</div>
      <div class="choices">
        <button class="choice-btn" onclick="checkMC(this,'qq18',false)">A. Ae^x</button>
        <button class="choice-btn" onclick="checkMC(this,'qq18',true)">B. Axe^x</button>
        <button class="choice-btn" onclick="checkMC(this,'qq18',false)">C. Ax²e^x</button>
        <button class="choice-btn" onclick="checkMC(this,'qq18',false)">D. A + Be^x</button>
      </div>
    </div>

    <!-- Q19 -->
    <div class="quiz-q" id="qq19">
      <div class="q-num">Question 19 — Gradient &amp; Directional Derivative</div>
      <div class="q-text">The gradient ∇f at a point is perpendicular to the level curve passing through that point. Additionally, the maximum rate of change of f equals:</div>
      <div class="choices">
        <button class="choice-btn" onclick="checkMC(this,'qq19',false)">A. 1 (always)</button>
        <button class="choice-btn" onclick="checkMC(this,'qq19',true)">B. |∇f| (the magnitude of the gradient)</button>
        <button class="choice-btn" onclick="checkMC(this,'qq19',false)">C. ∇f · ∇f (dot product with itself)</button>
        <button class="choice-btn" onclick="checkMC(this,'qq19',false)">D. The Laplacian ∇²f</button>
      </div>
    </div>

    <!-- Q20 -->
    <div class="quiz-q" id="qq20">
      <div class="q-num">Question 20 — Multi-Topic (Comprehensive)</div>
      <div class="q-text">A system x' = Ax where A is a 2×2 real symmetric matrix with eigenvalues λ₁ = 2, λ₂ = −1 and orthogonal eigenvectors v₁, v₂. The long-term behavior of solutions (as t→∞) starting away from the v₂ axis is:</div>
      <div class="choices">
        <button class="choice-btn" onclick="checkMC(this,'qq20',false)">A. Decay to zero along both eigendirections</button>
        <button class="choice-btn" onclick="checkMC(this,'qq20',true)">B. Growth to infinity along the v₁ direction (saddle point)</button>
        <button class="choice-btn" onclick="checkMC(this,'qq20',false)">C. Stable oscillations around the origin</button>
        <button class="choice-btn" onclick="checkMC(this,'qq20',false)">D. Convergence to a nonzero equilibrium</button>
      </div>
    </div>

  </div></div>
</div>

</div><!-- end .content -->

<script>
// ============================================================
// SECTION TOGGLE + PROGRESS
// ============================================================
const TOTAL_SECTIONS = 5;
const completedSections = new Set();

function toggleSection(header) {
  const card = header.closest('.section-card');
  const isOpen = card.classList.contains('open');
  card.classList.toggle('open', !isOpen);
  const sNum = parseInt(card.dataset.section);
  if (!isOpen && sNum) {
    completedSections.add(sNum);
    card.classList.add('completed');
    updateProgress();
  }
}

function updateProgress() {
  const pct = Math.round((completedSections.size / TOTAL_SECTIONS) * 100);
  document.getElementById('progressFill').style.width = pct + '%';
  document.getElementById('progressLabel').textContent = completedSections.size + ' / ' + TOTAL_SECTIONS + ' sections';
}

// ============================================================
// QUIZ
// ============================================================
let quizScore = 0;

function checkMC(btn, qId, isCorrect) {
  const container = document.getElementById(qId);
  if (!container) return;
  const allBtns = container.querySelectorAll('.choice-btn');
  allBtns.forEach(b => b.classList.add('disabled'));
  if (isCorrect) {
    btn.classList.add('selected-correct');
    btn.classList.remove('disabled');
    quizScore++;
    document.getElementById('quizScore').textContent = quizScore;
    btn.classList.add('pop');
    setTimeout(() => btn.classList.remove('pop'), 400);
  } else {
    btn.classList.add('selected-wrong');
    btn.classList.add('shake');
    setTimeout(() => btn.classList.remove('shake'), 500);
    allBtns.forEach(b => {
      if (b.getAttribute('onclick') && b.getAttribute('onclick').includes('true')) {
        b.classList.add('reveal-correct');
        b.classList.remove('disabled');
      }
    });
  }
}

// ============================================================
// TABS
// ============================================================
function switchTab(group, panelId, btn) {
  const allBtns = btn.closest('.tab-bar').querySelectorAll('.tab-btn');
  allBtns.forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  const prefixes = ['ref'];
  const allPanels = document.querySelectorAll('[id^="' + group + '-"]');
  allPanels.forEach(p => p.classList.remove('active'));
  const target = document.getElementById(group + '-' + panelId);
  if (target) target.classList.add('active');
}

// ============================================================
// MASTERY CHECKLIST
// ============================================================
const TOTAL_LESSONS = 19;

function toggleMastery(item, idx) {
  const cb = item.querySelector('input[type="checkbox"]');
  cb.checked = !cb.checked;
  item.classList.toggle('checked', cb.checked);
  updateMastery();
}

function updateMastery() {
  const checked = document.querySelectorAll('#masteryGrid .mastery-item.checked').length;
  const pct = Math.round((checked / TOTAL_LESSONS) * 100);
  document.getElementById('masteryPct').textContent = pct + '%';
  document.getElementById('masteryBarFill').style.width = pct + '%';
}

// ============================================================
// PROBLEM GENERATOR
// ============================================================
const problems = [
  {
    topic: 'Linear Algebra',
    q: 'Find the eigenvalues of A = [2 1; 1 2].',
    sol: 'Characteristic equation: det(A−λI) = (2−λ)²−1 = λ²−4λ+3 = (λ−1)(λ−3) = 0. Eigenvalues: λ₁ = 1, λ₂ = 3. Eigenvectors: for λ=1: v₁=(1,−1); for λ=3: v₂=(1,1).'
  },
  {
    topic: 'Linear Algebra',
    q: 'Is the set {(1,0,1),(0,1,1),(1,1,0)} a basis for ℝ³?',
    sol: 'Form matrix with these as rows, compute determinant: det = 1(0−1)−0+1(1) = −1+1 = ... Full expansion: 1(1·0−1·1) − 0 + 1(0·1−1·1) = −1 + (−1) = −2 ≠ 0. Since det ≠ 0, vectors are linearly independent and span ℝ³. YES, this is a basis.'
  },
  {
    topic: 'ODEs',
    q: 'Solve the IVP: y\' − 2y = 0, y(0) = 3.',
    sol: 'Separable (or linear with P=−2, Q=0). Integrating factor μ = e^(−2x). Or directly: dy/y = 2dx → ln|y| = 2x + C → y = Ae^(2x). Apply IC: 3 = Ae^0 = A. Solution: y = 3e^(2x).'
  },
  {
    topic: 'ODEs',
    q: 'Find the general solution to y\'\' − 5y\' + 6y = 0.',
    sol: 'Characteristic equation: r² − 5r + 6 = 0 → (r−2)(r−3) = 0. Roots r₁=2, r₂=3 (real, distinct). General solution: y = C₁e^(2x) + C₂e^(3x).'
  },
  {
    topic: 'Laplace Transforms',
    q: 'Use Laplace transforms to solve y\' + 3y = 6, y(0) = 0.',
    sol: 'Transform: sY − 0 + 3Y = 6/s → Y(s−3+s·0)... sY + 3Y = 6/s → Y(s+3) = 6/s → Y = 6/(s(s+3)). Partial fractions: 6/(s(s+3)) = 2/s − 2/(s+3). Inverse transform: y(t) = 2 − 2e^(−3t).'
  },
  {
    topic: 'Multivariable Calculus',
    q: 'Find the gradient of f(x,y) = x²y + sin(xy) at the point (π, 0).',
    sol: 'f_x = 2xy + y·cos(xy). f_y = x² + x·cos(xy). At (π,0): f_x = 0 + 0·cos(0) = 0. f_y = π² + π·cos(0) = π² + π. Gradient: ∇f(π,0) = (0, π²+π).'
  },
  {
    topic: 'Multivariable Calculus',
    q: 'Evaluate ∬_D x dA where D is the region 0≤x≤1, 0≤y≤x.',
    sol: '∫₀^1 ∫₀^x x dy dx = ∫₀^1 x·[y]₀^x dx = ∫₀^1 x² dx = [x³/3]₀^1 = 1/3.'
  },
  {
    topic: 'Optimization',
    q: 'Find and classify critical points of f(x,y) = x² + y² − 2x − 4y + 1.',
    sol: 'f_x = 2x−2 = 0 → x=1. f_y = 2y−4 = 0 → y=2. Critical point: (1,2). Second derivatives: f_xx=2, f_yy=2, f_xy=0. D = 4−0 = 4 > 0, f_xx > 0 → local (global) minimum. f(1,2) = 1+4−2−8+1 = −4.'
  },
  {
    topic: 'Vector Calculus',
    q: 'Compute curl F for F = (y, −x, 0).',
    sol: 'curl F = ∇×F = (∂F₃/∂y − ∂F₂/∂z, ∂F₁/∂z − ∂F₃/∂x, ∂F₂/∂x − ∂F₁/∂y) = (0−0, 0−0, −1−1) = (0, 0, −2). Since curl F ≠ 0, F is not conservative.'
  },
  {
    topic: 'Vector Calculus',
    q: 'Using Green\'s theorem, compute ∮_C y dx − x dy around the unit circle (counterclockwise).',
    sol: 'P = y, Q = −x. Q_x − P_y = −1 − 1 = −2. Green\'s: ∮ = ∬_D (−2) dA = −2·Area(unit disk) = −2π.'
  },
  {
    topic: 'Complex Numbers',
    q: 'Find all cube roots of 8.',
    sol: '8 = 8e^(i·0). Cube roots: 2e^(i·2πk/3) for k=0,1,2. k=0: 2e^0 = 2. k=1: 2e^(2πi/3) = 2(−1/2 + i√3/2) = −1+i√3. k=2: 2e^(4πi/3) = 2(−1/2 − i√3/2) = −1−i√3.'
  },
  {
    topic: 'Probability',
    q: 'X~N(μ=10, σ²=4). What is P(X > 14)?',
    sol: 'Standardize: Z = (X−10)/2. P(X>14) = P(Z > (14−10)/2) = P(Z>2) ≈ 1−Φ(2) ≈ 1−0.9772 = 0.0228. About 2.28% of observations exceed 14.'
  },
  {
    topic: 'Fourier Series',
    q: 'For f(x) = x on [−π, π], is the Fourier series a sine series, cosine series, or both?',
    sol: 'f(x) = x is an odd function (f(−x) = −x = −f(x)). Therefore a₀ = 0 and all aₙ = 0. The Fourier series contains only sine terms: f(x) = Σ bₙsin(nx). Specifically bₙ = (2/π)·(−1)^(n+1)/n, giving f(x) = 2Σ (−1)^(n+1)/n · sin(nx).'
  },
  {
    topic: 'Linear Algebra',
    q: 'For the matrix A = [1 2; 3 4], compute A⁻¹.',
    sol: 'det(A) = 4−6 = −2. A⁻¹ = (1/det)·[d −b; −c a] = (1/−2)·[4 −2; −3 1] = [−2 1; 3/2 −1/2].'
  },
  {
    topic: 'ODEs',
    q: 'Solve y\' + (1/x)y = x², x > 0.',
    sol: 'Linear ODE: P=1/x, Q=x². Integrating factor: μ = e^(∫1/x dx) = e^(ln x) = x. Multiply: (xy)\' = x·x² = x³. Integrate: xy = x⁴/4 + C. Solution: y = x³/4 + C/x.'
  }
];

let currentProblem = null;

function generateProblem() {
  const idx = Math.floor(Math.random() * problems.length);
  currentProblem = problems[idx];
  document.getElementById('genProblemDisplay').textContent = currentProblem.q;
  document.getElementById('genSolution').textContent = '';
  document.getElementById('genSolution').classList.remove('visible');
  document.getElementById('genTopicTag').textContent = currentProblem.topic;
  document.getElementById('genTopicTag').style.display = 'inline-block';
  document.getElementById('revealSolBtn').style.display = 'inline-flex';
}

function revealSolution() {
  if (!currentProblem) return;
  document.getElementById('genSolution').textContent = currentProblem.sol;
  document.getElementById('genSolution').classList.add('visible');
}

// ============================================================
// MOCK EXAM
// ============================================================
const mockPool = [
  { q: 'What is det([1 2; 3 4])?', choices: ['−2', '−10', '2', '10'], ans: 0 },
  { q: 'The integrating factor for y\' + 2y = e^x is:', choices: ['e^x', 'e^(2x)', 'e^(−x)', '2e^x'], ans: 1 },
  { q: 'Eigenvalues of [0 1; −2 −3]:', choices: ['1, 2', '−1, −2', '0, −3', '1, −2'], ans: 1 },
  { q: 'L{cos(3t)} =', choices: ['3/(s²+9)', 's/(s²+9)', '1/(s²+9)', 's/(s²+3)'], ans: 1 },
  { q: '∂/∂x [x²y³] =', choices: ['2xy³', '3x²y²', '2x + 3y', 'x²y³'], ans: 0 },
  { q: 'The gradient of f = xy points in which direction at (1,1)?', choices: ['(1,0)', '(0,1)', '(1,1)', '(−1,−1)'], ans: 2 },
  { q: 'Convert ∬ over x²+y²≤4. Area in polar coordinates:', choices: ['∫₀^(2π)∫₀^2 dr dθ', '∫₀^(2π)∫₀^2 r dr dθ', '∫₀^π∫₀^4 r dr dθ', '∫₀^(2π)∫₀^4 dr dθ'], ans: 1 },
  { q: 'curl(∇f) for any scalar f equals:', choices: ['∇f', '∇²f', '0 (zero vector)', '1'], ans: 2 },
  { q: 'For X~Binomial(n=10, p=0.5), E[X] =', choices: ['5', '2.5', '10', '0.5'], ans: 0 },
  { q: 'The Fourier coefficient b₁ for f(x)=x on [−π,π] is:', choices: ['0', '2', '−2', 'π'], ans: 1 },
  { q: 'Rank of a 3×4 matrix is at most:', choices: ['4', '3', '7', '12'], ans: 1 },
  { q: 'The general solution to y\'\' + y = 0 is:', choices: ['C₁e^x + C₂e^(−x)', 'C₁sin x + C₂cos x', '(C₁+C₂x)e^x', 'C₁x + C₂'], ans: 1 },
  { q: 'Stokes\' theorem relates a line integral over C to:', choices: ['A volume integral', 'A surface integral of curl F', 'A surface integral of div F', 'Another line integral'], ans: 1 },
  { q: '|1+i| =', choices: ['1', '√2', '2', 'i'], ans: 1 },
  { q: 'For P(A|B) = P(B|A)P(A)/P(B) — this is:', choices: ['Chebyshev\'s inequality', 'Law of large numbers', 'Bayes\' theorem', 'CLT'], ans: 2 },
  { q: 'A linear transformation T: ℝ² → ℝ³ can have a matrix that is:', choices: ['2×3', '3×2', '2×2', '3×3'], ans: 1 },
  { q: 'The second-order DE r² + 4 = 0 gives roots r =', choices: ['±2', '±2i', '−4', '±4i'], ans: 1 },
  { q: 'At a saddle point of f(x,y), the discriminant D = f_xx f_yy − f_xy² is:', choices: ['> 0', '= 0', '< 0', 'Any value'], ans: 2 },
  { q: 'Spherical coordinate volume element dV is:', choices: ['dρ dφ dθ', 'ρ sinφ dρ dφ dθ', 'ρ² sinφ dρ dφ dθ', 'ρ² dρ dφ dθ'], ans: 2 },
  { q: 'For the Poisson distribution with λ=2, Var(X) =', choices: ['4', '2', '√2', '1'], ans: 1 }
];

let mockQuestions = [];
let mockTimerInterval = null;
let mockSecondsLeft = 0;

function shuffle(arr) {
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

function startMockExam() {
  mockQuestions = shuffle([...mockPool]).slice(0, 10);
  mockSecondsLeft = 20 * 60;
  document.getElementById('mockStart').style.display = 'none';
  document.getElementById('mockRunning').style.display = 'block';
  document.getElementById('mockResults').classList.remove('visible');
  renderMockQuestions();
  mockTimerInterval = setInterval(tickMockTimer, 1000);
  updateMockTimer();
}

function renderMockQuestions() {
  const wrap = document.getElementById('mockQWrap');
  wrap.innerHTML = '';
  mockQuestions.forEach((q, qi) => {
    const div = document.createElement('div');
    div.className = 'mock-q';
    div.id = 'mq' + qi;
    div.innerHTML = `<div class="q-num">Question ${qi+1}</div>
      <div class="q-text">${q.q}</div>
      <div class="choices">${q.choices.map((c,ci)=>`<button class="choice-btn" data-qi="${qi}" data-ci="${ci}" onclick="selectMockChoice(this,${qi},${ci})">${String.fromCharCode(65+ci)}. ${c}</button>`).join('')}</div>`;
    wrap.appendChild(div);
  });
}

function selectMockChoice(btn, qi, ci) {
  const qDiv = document.getElementById('mq'+qi);
  qDiv.querySelectorAll('.choice-btn').forEach(b => b.classList.remove('selected'));
  btn.classList.add('selected');
  mockQuestions[qi]._selected = ci;
}

function tickMockTimer() {
  mockSecondsLeft--;
  updateMockTimer();
  if (mockSecondsLeft <= 0) {
    clearInterval(mockTimerInterval);
    submitMockExam();
  }
}

function updateMockTimer() {
  const m = Math.floor(mockSecondsLeft / 60);
  const s = mockSecondsLeft % 60;
  const disp = String(m).padStart(2,'0') + ':' + String(s).padStart(2,'0');
  const el = document.getElementById('mockTimer');
  el.textContent = disp;
  el.classList.toggle('warning', mockSecondsLeft < 120);
}

function submitMockExam() {
  clearInterval(mockTimerInterval);
  let correct = 0;
  let reviewHTML = '';
  mockQuestions.forEach((q, qi) => {
    const sel = q._selected;
    const isCorrect = sel === q.ans;
    if (isCorrect) correct++;
    const qDiv = document.getElementById('mq'+qi);
    if (qDiv) {
      qDiv.querySelectorAll('.choice-btn').forEach((b, ci) => {
        b.classList.add('locked');
        if (ci === q.ans) b.classList.add('reveal-correct');
        else if (ci === sel && !isCorrect) b.classList.add('reveal-wrong');
        b.onclick = null;
      });
    }
    reviewHTML += `<div style="font-size:.72rem;margin-bottom:6px;color:${isCorrect?'var(--green)':'var(--pink)'}">Q${qi+1}: ${isCorrect?'Correct':'Wrong — correct: '+q.choices[q.ans]}</div>`;
  });
  document.getElementById('mockRunning').style.display = 'none';
  document.getElementById('mockResults').classList.add('visible');
  document.getElementById('mockScoreNum').textContent = correct;
  const label = correct <= 4 ? 'Keep studying — review the formula sheets!' : correct <= 7 ? 'Good progress — focus on missed topics.' : 'Excellent — you are exam ready!';
  document.getElementById('mockScoreLabel').textContent = label;
  document.getElementById('mockReviewWrap').innerHTML = reviewHTML;
}

function abandonMockExam() {
  clearInterval(mockTimerInterval);
  document.getElementById('mockRunning').style.display = 'none';
  document.getElementById('mockStart').style.display = 'block';
  mockQuestions = [];
}

function resetMockExam() {
  document.getElementById('mockResults').classList.remove('visible');
  document.getElementById('mockStart').style.display = 'block';
  mockQuestions = [];
}
</script>
</body>
</html>
