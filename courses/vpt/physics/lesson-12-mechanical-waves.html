<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Week 12: Mechanical Waves</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,300;0,400;0,500;0,600;0,700;1,400&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{--bg:#1e2128;--bg-card:#262a33;--bg-card-hover:#2c313c;--bg-input:#1a1d24;--border:#363b47;--text:#e2e4e9;--text-dim:#9ca3af;--text-bright:#fff;--indigo:#6366f1;--indigo-dim:rgba(99,102,241,.15);--green:#22c55e;--green-dim:rgba(34,197,94,.15);--pink:#ec4899;--pink-dim:rgba(236,72,153,.15);--amber:#f59e0b;--amber-dim:rgba(245,158,11,.15);--radius:10px;--transition:0.3s cubic-bezier(.4,0,.2,1)}
html{scroll-behavior:smooth}
body{font-family:'JetBrains Mono',monospace;background:var(--bg);color:var(--text);line-height:1.7;min-height:100vh;padding:0}
.top-bar{position:sticky;top:0;z-index:100;background:rgba(30,33,40,.92);backdrop-filter:blur(12px);border-bottom:1px solid var(--border);padding:16px 24px}
.top-bar h1{font-size:1.1rem;font-weight:600;color:var(--text-bright);margin-bottom:10px;letter-spacing:-.02em}
.top-bar h1 span{color:var(--indigo)}
.progress-track{width:100%;height:6px;background:var(--border);border-radius:3px;overflow:hidden}
.progress-fill{height:100%;width:0%;background:linear-gradient(90deg,var(--indigo),#818cf8);border-radius:3px;transition:width .5s ease}
.progress-label{font-size:.7rem;color:var(--text-dim);margin-top:6px;text-align:right}
.content{max-width:900px;margin:0 auto;padding:24px}
.section-card{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);margin-bottom:20px;overflow:hidden;transition:border-color var(--transition)}
.section-card.completed{border-color:var(--green)}
.section-header{display:flex;align-items:center;justify-content:space-between;padding:18px 22px;cursor:pointer;user-select:none;transition:background var(--transition)}
.section-header:hover{background:var(--bg-card-hover)}
.section-header h2{font-size:.95rem;font-weight:600;color:var(--text-bright);display:flex;align-items:center;gap:10px}
.section-num{display:inline-flex;align-items:center;justify-content:center;width:28px;height:28px;border-radius:50%;background:var(--indigo-dim);color:var(--indigo);font-size:.75rem;font-weight:700;flex-shrink:0}
.chevron{width:20px;height:20px;color:var(--text-dim);transition:transform .4s cubic-bezier(.34,1.56,.64,1);flex-shrink:0}
.section-card.open .chevron{transform:rotate(180deg)}
.section-body{max-height:0;overflow:hidden;transition:max-height .5s cubic-bezier(.4,0,.2,1)}
.section-card.open .section-body{max-height:80000px}
.section-inner{padding:0 22px 22px}
.concept-text{font-size:.82rem;color:var(--text);margin-bottom:16px;line-height:1.8}
.concept-text strong{color:var(--text-bright)}
.formula-box{background:var(--indigo-dim);border:1px solid rgba(99,102,241,.3);border-radius:var(--radius);padding:16px 20px;margin:16px 0;text-align:center;font-size:1rem;color:var(--indigo);font-weight:600}
.formula-box.large{font-size:1.15rem;padding:20px 24px}
.formula-box.green{background:var(--green-dim);border-color:rgba(34,197,94,.3);color:var(--green)}
.formula-box.pink{background:var(--pink-dim);border-color:rgba(236,72,153,.3);color:var(--pink)}
.formula-box.amber{background:var(--amber-dim);border-color:rgba(245,158,11,.3);color:var(--amber)}
.key-point{background:var(--amber-dim);border-left:3px solid var(--amber);border-radius:0 var(--radius) var(--radius) 0;padding:12px 16px;margin:14px 0;font-size:.78rem;color:var(--amber)}
.interactive-area{background:var(--bg-input);border:1px solid var(--border);border-radius:var(--radius);padding:16px;margin:16px 0;position:relative}
.interactive-label{font-size:.7rem;color:var(--indigo);text-transform:uppercase;letter-spacing:.08em;margin-bottom:12px;font-weight:600}
.readout{display:flex;flex-wrap:wrap;gap:12px;margin-top:12px}
.readout-item{background:var(--bg-card);border:1px solid var(--border);border-radius:6px;padding:8px 14px;font-size:.75rem}
.readout-item .label{color:var(--text-dim);font-size:.65rem}
.readout-item .value{color:var(--text-bright);font-weight:600}
.readout-item .value.green{color:var(--green)}
.readout-item .value.pink{color:var(--pink)}
.readout-item .value.amber{color:var(--amber)}
.readout-item .value.indigo{color:var(--indigo)}
svg text{font-family:'JetBrains Mono',monospace}
.practice-block{margin-top:20px;border-top:1px solid var(--border);padding-top:16px}
.practice-title{font-size:.8rem;font-weight:600;color:var(--amber);margin-bottom:14px}
.problem{background:var(--bg-input);border:1px solid var(--border);border-radius:var(--radius);padding:14px 16px;margin-bottom:12px}
.problem p{font-size:.78rem;margin-bottom:10px;line-height:1.7}
.problem-input-row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
.problem input[type="text"],.problem input[type="number"]{background:var(--bg-card);border:1px solid var(--border);border-radius:6px;padding:8px 12px;color:var(--text-bright);font-family:'JetBrains Mono',monospace;font-size:.78rem;width:120px;outline:none;transition:border-color var(--transition)}
.problem input:focus{border-color:var(--indigo)}
.btn{display:inline-flex;align-items:center;gap:6px;padding:8px 16px;border:1px solid var(--border);border-radius:6px;background:var(--bg-card);color:var(--text);font-family:'JetBrains Mono',monospace;font-size:.72rem;cursor:pointer;transition:var(--transition);user-select:none}
.btn:hover{background:var(--bg-card-hover);border-color:var(--indigo);color:var(--text-bright)}
.btn-primary{background:var(--indigo);border-color:var(--indigo);color:#fff}
.btn-primary:hover{background:#5558e6}
.btn-sm{padding:6px 12px;font-size:.68rem}
.feedback{font-size:.75rem;margin-top:8px;padding:8px 12px;border-radius:6px;display:none}
.feedback.correct{display:block;background:var(--green-dim);color:var(--green);border:1px solid rgba(34,197,94,.3)}
.feedback.incorrect{display:block;background:var(--pink-dim);color:var(--pink);border:1px solid rgba(236,72,153,.3)}
.slider-row{display:flex;align-items:center;gap:12px;margin:8px 0}
.slider-row label{font-size:.7rem;color:var(--text-dim);min-width:110px;flex-shrink:0}
.slider-row input[type="range"]{flex:1}
.slider-row .slider-val{font-size:.75rem;color:var(--text-bright);font-weight:600;min-width:60px;text-align:right}
input[type="range"]{-webkit-appearance:none;width:100%;height:6px;background:var(--border);border-radius:3px;outline:none;margin:10px 0}
input[type="range"]::-webkit-slider-thumb{-webkit-appearance:none;width:18px;height:18px;border-radius:50%;background:var(--indigo);cursor:pointer;border:2px solid var(--text-bright)}
.controls-row{display:flex;flex-wrap:wrap;gap:12px;align-items:center;margin:12px 0}
.scenario-tabs{display:flex;gap:8px;flex-wrap:wrap;margin:12px 0}
.scenario-tab{padding:6px 14px;font-size:.7rem;border:1px solid var(--border);border-radius:6px;background:var(--bg-card);color:var(--text-dim);cursor:pointer;transition:var(--transition);font-family:'JetBrains Mono',monospace}
.scenario-tab:hover{border-color:var(--indigo)}
.scenario-tab.active{border-color:var(--indigo);background:var(--indigo-dim);color:var(--indigo)}
.mc-choices{display:flex;flex-direction:column;gap:8px;margin-top:8px}
.mc-btn{text-align:left;padding:8px 12px;font-size:.74rem;border:1px solid var(--border);border-radius:6px;background:var(--bg-card);color:var(--text);cursor:pointer;transition:var(--transition);font-family:'JetBrains Mono',monospace}
.mc-btn:hover{border-color:var(--indigo);background:var(--bg-card-hover)}
.mc-btn.correct{border-color:var(--green);background:var(--green-dim);color:var(--green);pointer-events:none}
.mc-btn.wrong{border-color:var(--pink);background:var(--pink-dim);color:var(--pink);pointer-events:none}
.mc-btn.disabled{pointer-events:none;opacity:.6}
.sub-label{font-size:.7rem;color:var(--text-dim);margin:10px 0 4px}
.navy-context{background:rgba(99,102,241,.08);border:1px solid rgba(99,102,241,.2);border-radius:var(--radius);padding:12px 16px;margin:14px 0;font-size:.76rem;color:var(--text-dim)}
.navy-context strong{color:var(--indigo)}
.quiz-score{background:var(--indigo-dim);border:1px solid rgba(99,102,241,.3);border-radius:var(--radius);padding:14px 20px;display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}
.quiz-score .score-text{font-size:.85rem;color:var(--text-bright);font-weight:600}
.quiz-q{background:var(--bg-input);border:1px solid var(--border);border-radius:var(--radius);padding:16px;margin-bottom:12px}
.quiz-q .q-num{font-size:.65rem;color:var(--indigo);font-weight:600;text-transform:uppercase;letter-spacing:.06em;margin-bottom:8px}
.quiz-q .q-text{font-size:.78rem;margin-bottom:12px;line-height:1.7}
.quiz-q .choices{display:flex;flex-direction:column;gap:8px}
.quiz-q .choice-btn{text-align:left;padding:10px 14px;font-size:.76rem;border:1px solid var(--border);border-radius:6px;background:var(--bg-card);color:var(--text);cursor:pointer;transition:var(--transition);font-family:'JetBrains Mono',monospace;width:100%}
.quiz-q .choice-btn:hover{border-color:var(--indigo);background:var(--bg-card-hover)}
.quiz-q .choice-btn.selected-correct{border-color:var(--green);background:var(--green-dim);color:var(--green)}
.quiz-q .choice-btn.selected-wrong{border-color:var(--pink);background:var(--pink-dim);color:var(--pink)}
.quiz-q .choice-btn.reveal-correct{border-color:var(--green);background:var(--green-dim);color:var(--green)}
.quiz-q .choice-btn.disabled{pointer-events:none;opacity:.7}
@keyframes popCorrect{0%{transform:scale(1)}50%{transform:scale(1.05)}100%{transform:scale(1)}}
@keyframes shakeWrong{0%,100%{transform:translateX(0)}20%,60%{transform:translateX(-6px)}40%,80%{transform:translateX(6px)}}
.pop{animation:popCorrect .35s cubic-bezier(.34,1.56,.64,1)}
.shake{animation:shakeWrong .4s ease}
@media(max-width:640px){.content{padding:16px}.section-header{padding:14px 16px}.section-inner{padding:0 16px 16px}.slider-row label{min-width:80px}.readout{gap:8px}.readout-item{padding:6px 10px;font-size:.7rem}}
</style>
</head>
<body>

<div class="top-bar">
  <h1><span>12</span> Mechanical Waves</h1>
  <div class="progress-track"><div class="progress-fill" id="progressFill"></div></div>
  <div class="progress-label" id="progressLabel">0 / 7 sections</div>
</div>

<div class="content" id="contentArea">

<!-- ============================================================ -->
<!-- SECTION 1: WAVE BASICS -->
<!-- ============================================================ -->
<div class="section-card open" data-section="1">
  <div class="section-header" onclick="toggleSection(this)">
    <h2><span class="section-num">1</span> Wave Basics</h2>
    <svg class="chevron" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"/></svg>
  </div>
  <div class="section-body"><div class="section-inner">

    <p class="concept-text">
      A <strong>mechanical wave</strong> is a disturbance that propagates through a medium, transferring energy without transferring matter. There are two fundamental types:
    </p>
    <p class="concept-text">
      <strong>Transverse waves</strong> -- the particles of the medium oscillate perpendicular to the direction of wave travel. Examples: waves on a string, water surface waves (approximately). <strong>Longitudinal waves</strong> -- the particles oscillate parallel to the direction of travel. Examples: sound waves, compression waves in a spring.
    </p>
    <p class="concept-text">
      Every periodic wave is described by four key parameters: <strong>Amplitude A</strong> (maximum displacement from equilibrium), <strong>Wavelength &lambda;</strong> (distance between two consecutive identical points, e.g. crest to crest), <strong>Frequency f</strong> (number of complete cycles per second, in Hz), and <strong>Period T = 1/f</strong> (time for one complete cycle).
    </p>

    <div class="formula-box large">v = f&lambda; = &lambda;/T</div>
    <div class="key-point">Wave speed depends on the medium, not on frequency or amplitude. Changing f changes &lambda; so that v = f&lambda; stays constant for a given medium.</div>

    <div class="interactive-area">
      <div class="interactive-label">Interactive: Transverse Wave -- Adjust Wavelength &amp; Frequency</div>
      <svg id="s1Svg" width="100%" viewBox="0 0 700 220" style="display:block"></svg>
      <div class="slider-row">
        <label>Wavelength &lambda;</label>
        <input type="range" id="s1Lambda" min="60" max="300" value="150" step="5" oninput="updateS1()">
        <span class="slider-val" id="s1LambdaVal">150 px</span>
      </div>
      <div class="slider-row">
        <label>Frequency f</label>
        <input type="range" id="s1Freq" min="0.2" max="3" value="1" step="0.1" oninput="updateS1()">
        <span class="slider-val" id="s1FreqVal">1.0 Hz</span>
      </div>
      <div class="slider-row">
        <label>Amplitude A</label>
        <input type="range" id="s1Amp" min="10" max="80" value="50" step="5" oninput="updateS1()">
        <span class="slider-val" id="s1AmpVal">50 px</span>
      </div>
      <div class="readout">
        <div class="readout-item"><span class="label">Wave Speed v = f&lambda;</span><br><span class="value indigo" id="s1Speed">150 px/s</span></div>
        <div class="readout-item"><span class="label">Period T = 1/f</span><br><span class="value green" id="s1Period">1.00 s</span></div>
        <div class="readout-item"><span class="label">Wavelength &lambda;</span><br><span class="value amber" id="s1LamR">150 px</span></div>
      </div>
    </div>

    <div class="navy-context"><strong>Navy Context:</strong> Sonar uses longitudinal sound waves in water. Sound travels at about 1500 m/s in seawater -- roughly 4.4x faster than in air. A sonar ping at 1500 Hz has a wavelength of 1 m in water, making it effective for detecting submarine-sized objects.</div>

  </div></div>
</div>

<!-- ============================================================ -->
<!-- SECTION 2: THE WAVE EQUATION -->
<!-- ============================================================ -->
<div class="section-card" data-section="2">
  <div class="section-header" onclick="toggleSection(this)">
    <h2><span class="section-num">2</span> The Wave Equation</h2>
    <svg class="chevron" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"/></svg>
  </div>
  <div class="section-body"><div class="section-inner">

    <p class="concept-text">
      The displacement of a sinusoidal traveling wave can be written as a function of both position x and time t:
    </p>
    <div class="formula-box large">y(x,t) = A sin(kx &minus; &omega;t)</div>
    <p class="concept-text">
      Where <strong>k = 2&pi;/&lambda;</strong> is the <strong>wave number</strong> (radians per meter) and <strong>&omega; = 2&pi;f</strong> is the <strong>angular frequency</strong> (radians per second). The wave speed is also v = &omega;/k.
    </p>

    <div class="formula-box green">k = 2&pi;/&lambda; &nbsp;&nbsp;&nbsp; &omega; = 2&pi;f &nbsp;&nbsp;&nbsp; v = &omega;/k = f&lambda;</div>

    <p class="concept-text">
      <strong>Direction of travel:</strong> The sign in the argument determines direction. <strong>kx &minus; &omega;t</strong> travels in the +x direction. <strong>kx + &omega;t</strong> travels in the &minus;x direction. Think of it this way: for a crest to stay at the same phase, kx &minus; &omega;t = constant, so as t increases, x must increase -- the wave moves right.
    </p>

    <div class="key-point">Phase velocity: any point of constant phase moves at v = &omega;/k. A snapshot at fixed t shows a sinusoidal shape in space. An observation at fixed x shows sinusoidal oscillation in time.</div>

    <div class="interactive-area">
      <div class="interactive-label">Interactive: y(x,t) = A sin(kx &minus; &omega;t) Visualizer</div>
      <svg id="s2Svg" width="100%" viewBox="0 0 700 220" style="display:block"></svg>
      <div class="slider-row">
        <label>Wave number k</label>
        <input type="range" id="s2K" min="0.02" max="0.15" value="0.05" step="0.005" oninput="updateS2()">
        <span class="slider-val" id="s2KVal">0.050 rad/px</span>
      </div>
      <div class="slider-row">
        <label>Angular freq &omega;</label>
        <input type="range" id="s2Omega" min="0.5" max="8" value="3" step="0.5" oninput="updateS2()">
        <span class="slider-val" id="s2OmegaVal">3.0 rad/s</span>
      </div>
      <div class="slider-row">
        <label>Amplitude A</label>
        <input type="range" id="s2A" min="10" max="80" value="50" step="5" oninput="updateS2()">
        <span class="slider-val" id="s2AVal">50 px</span>
      </div>
      <div class="readout">
        <div class="readout-item"><span class="label">&lambda; = 2&pi;/k</span><br><span class="value indigo" id="s2LamR">125.7 px</span></div>
        <div class="readout-item"><span class="label">f = &omega;/2&pi;</span><br><span class="value green" id="s2FreqR">0.48 Hz</span></div>
        <div class="readout-item"><span class="label">v = &omega;/k</span><br><span class="value amber" id="s2SpeedR">60.0 px/s</span></div>
        <div class="readout-item"><span class="label">Direction</span><br><span class="value pink" id="s2DirR">+x (right)</span></div>
      </div>
    </div>

  </div></div>
</div>

<!-- ============================================================ -->
<!-- SECTION 3: WAVE SPEED ON A STRING -->
<!-- ============================================================ -->
<div class="section-card" data-section="3">
  <div class="section-header" onclick="toggleSection(this)">
    <h2><span class="section-num">3</span> Wave Speed on a String</h2>
    <svg class="chevron" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"/></svg>
  </div>
  <div class="section-body"><div class="section-inner">

    <p class="concept-text">
      The speed of a transverse wave on a stretched string depends on two properties of the string: the <strong>tension T</strong> (in newtons) and the <strong>linear mass density &mu; = m/L</strong> (mass per unit length, in kg/m).
    </p>

    <div class="formula-box large">v = &radic;(T/&mu;)</div>

    <p class="concept-text">
      <strong>Higher tension</strong> means the restoring force is stronger, so the wave travels faster. <strong>Greater mass density</strong> means more inertia, so the wave travels slower. This formula is exact for a perfectly flexible, massless-at-the-joints ideal string.
    </p>

    <div class="formula-box green">&mu; = m/L &nbsp;&nbsp;&nbsp; [kg/m]</div>

    <div class="key-point">To double the wave speed on a string, you must quadruple the tension (since v goes as the square root of T). This is why tuning a guitar string by tightening it raises the pitch -- higher v means higher frequency for a given string length.</div>

    <div class="interactive-area">
      <div class="interactive-label">Interactive: Wave Speed vs Tension &amp; Linear Density</div>
      <div class="slider-row">
        <label>Tension T</label>
        <input type="range" id="s3Tension" min="1" max="200" value="50" step="1" oninput="updateS3()">
        <span class="slider-val" id="s3TVal">50 N</span>
      </div>
      <div class="slider-row">
        <label>Linear density &mu;</label>
        <input type="range" id="s3Mu" min="0.001" max="0.1" value="0.01" step="0.001" oninput="updateS3()">
        <span class="slider-val" id="s3MuVal">0.010 kg/m</span>
      </div>
      <div class="readout">
        <div class="readout-item"><span class="label">Wave Speed v</span><br><span class="value indigo" id="s3Speed">70.7 m/s</span></div>
        <div class="readout-item"><span class="label">Tension T</span><br><span class="value green" id="s3TR">50 N</span></div>
        <div class="readout-item"><span class="label">Density &mu;</span><br><span class="value amber" id="s3MuR">0.010 kg/m</span></div>
      </div>
      <svg id="s3Svg" width="100%" viewBox="0 0 700 160" style="display:block;margin-top:12px"></svg>
    </div>

    <p class="concept-text" style="margin-top:16px"><strong>Worked Example 1:</strong> A 2.0 m string has mass 10 g and is under 80 N of tension. Find the wave speed.</p>
    <div class="formula-box">&mu; = 0.010 kg / 2.0 m = 0.005 kg/m &nbsp;&rarr;&nbsp; v = &radic;(80/0.005) = &radic;16000 = 126.5 m/s</div>

    <p class="concept-text"><strong>Worked Example 2:</strong> A wave on a string has speed 200 m/s and &mu; = 0.004 kg/m. What is the tension?</p>
    <div class="formula-box">T = &mu;v&sup2; = 0.004 &times; 200&sup2; = 0.004 &times; 40000 = 160 N</div>

  </div></div>
</div>

<!-- ============================================================ -->
<!-- SECTION 4: SUPERPOSITION & INTERFERENCE -->
<!-- ============================================================ -->
<div class="section-card" data-section="4">
  <div class="section-header" onclick="toggleSection(this)">
    <h2><span class="section-num">4</span> Superposition &amp; Interference</h2>
    <svg class="chevron" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"/></svg>
  </div>
  <div class="section-body"><div class="section-inner">

    <p class="concept-text">
      The <strong>principle of superposition</strong> states that when two or more waves overlap in the same medium, the resultant displacement at any point is the algebraic sum of the individual displacements: y_total = y1 + y2.
    </p>

    <div class="formula-box large">y_total(x,t) = y1(x,t) + y2(x,t)</div>

    <p class="concept-text">
      <strong>Constructive interference</strong> occurs when waves are in phase (&Delta;&phi; = 0, 2&pi;, 4&pi;, ...) -- crests align with crests and the amplitude doubles. <strong>Destructive interference</strong> occurs when waves are out of phase by &pi; (&Delta;&phi; = &pi;, 3&pi;, ...) -- crests align with troughs and the waves cancel.
    </p>

    <div class="formula-box green">Constructive: &Delta;&phi; = 0, 2&pi;, 4&pi;, ... &nbsp;&nbsp; (amplitude = A1 + A2)</div>
    <div class="formula-box pink">Destructive: &Delta;&phi; = &pi;, 3&pi;, 5&pi;, ... &nbsp;&nbsp; (amplitude = |A1 &minus; A2|)</div>

    <div class="key-point">Superposition is a fundamental property of linear wave equations. It fails for high-amplitude waves where non-linear effects matter (e.g. shock waves, breaking ocean waves).</div>

    <div class="interactive-area">
      <div class="interactive-label">Interactive: Two-Wave Superposition with Adjustable Phase</div>
      <svg id="s4Svg" width="100%" viewBox="0 0 700 360" style="display:block"></svg>
      <div class="slider-row">
        <label>Phase shift &Delta;&phi;</label>
        <input type="range" id="s4Phase" min="0" max="6.283" value="0" step="0.05" oninput="updateS4()">
        <span class="slider-val" id="s4PhaseVal">0.00 rad</span>
      </div>
      <div class="slider-row">
        <label>Amplitude A1</label>
        <input type="range" id="s4A1" min="10" max="60" value="40" step="5" oninput="updateS4()">
        <span class="slider-val" id="s4A1Val">40 px</span>
      </div>
      <div class="slider-row">
        <label>Amplitude A2</label>
        <input type="range" id="s4A2" min="10" max="60" value="40" step="5" oninput="updateS4()">
        <span class="slider-val" id="s4A2Val">40 px</span>
      </div>
      <div class="readout">
        <div class="readout-item"><span class="label">Phase &Delta;&phi;</span><br><span class="value indigo" id="s4PhaseR">0.00 rad (0&deg;)</span></div>
        <div class="readout-item"><span class="label">Resultant Amp</span><br><span class="value green" id="s4ResultAmp">80 px</span></div>
        <div class="readout-item"><span class="label">Type</span><br><span class="value amber" id="s4Type">Constructive</span></div>
      </div>
    </div>

  </div></div>
</div>

<!-- ============================================================ -->
<!-- SECTION 5: STANDING WAVES -->
<!-- ============================================================ -->
<div class="section-card" data-section="5">
  <div class="section-header" onclick="toggleSection(this)">
    <h2><span class="section-num">5</span> Standing Waves</h2>
    <svg class="chevron" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"/></svg>
  </div>
  <div class="section-body"><div class="section-inner">

    <p class="concept-text">
      When two identical waves travel in opposite directions on a string, they produce a <strong>standing wave</strong>. The result is a pattern of fixed <strong>nodes</strong> (points of zero displacement) and <strong>antinodes</strong> (points of maximum displacement). Unlike a traveling wave, a standing wave does not transport energy.
    </p>

    <div class="formula-box large">y(x,t) = 2A sin(kx) cos(&omega;t)</div>

    <p class="concept-text">
      For a string fixed at both ends of length L, only certain wavelengths fit: <strong>&lambda;_n = 2L/n</strong> for n = 1, 2, 3, ... The corresponding frequencies are:
    </p>

    <div class="formula-box large">f_n = nv / 2L = n &middot; f_1</div>
    <div class="formula-box green">n = 1: Fundamental (1st harmonic) &nbsp;&nbsp; f_1 = v/2L</div>
    <div class="formula-box amber">n = 2: 2nd harmonic (1st overtone) &nbsp;&nbsp; f_2 = 2f_1</div>
    <div class="formula-box pink">n = 3: 3rd harmonic (2nd overtone) &nbsp;&nbsp; f_3 = 3f_1</div>

    <p class="concept-text">
      The <strong>nth harmonic</strong> has n antinodes and (n+1) nodes (including the two fixed endpoints). The fundamental (n=1) has one antinode in the center and nodes at each end.
    </p>

    <div class="key-point">Musical instruments use standing waves. A guitar string vibrates in a mix of harmonics. The fundamental determines the pitch; the overtones determine the timbre (tone quality).</div>

    <div class="interactive-area">
      <div class="interactive-label">Interactive: Standing Wave Harmonics (n = 1 to 5)</div>
      <svg id="s5Svg" width="100%" viewBox="0 0 700 240" style="display:block"></svg>
      <div class="scenario-tabs" id="s5Tabs">
        <button class="scenario-tab active" onclick="setHarmonic(1,this)">n = 1</button>
        <button class="scenario-tab" onclick="setHarmonic(2,this)">n = 2</button>
        <button class="scenario-tab" onclick="setHarmonic(3,this)">n = 3</button>
        <button class="scenario-tab" onclick="setHarmonic(4,this)">n = 4</button>
        <button class="scenario-tab" onclick="setHarmonic(5,this)">n = 5</button>
      </div>
      <div class="readout">
        <div class="readout-item"><span class="label">Harmonic n</span><br><span class="value indigo" id="s5NR">1</span></div>
        <div class="readout-item"><span class="label">Nodes</span><br><span class="value pink" id="s5Nodes">2</span></div>
        <div class="readout-item"><span class="label">Antinodes</span><br><span class="value green" id="s5Anti">1</span></div>
        <div class="readout-item"><span class="label">&lambda;_n = 2L/n</span><br><span class="value amber" id="s5Lam">2L</span></div>
        <div class="readout-item"><span class="label">f_n = nf_1</span><br><span class="value indigo" id="s5Freq">f_1</span></div>
      </div>
    </div>

    <div class="navy-context"><strong>Navy Context:</strong> Vibrations in ship hulls and aircraft structures form standing wave patterns at resonant frequencies. Engineers must ensure that engine RPM and propeller frequencies do not excite these resonant modes, which could cause catastrophic fatigue failure.</div>

  </div></div>
</div>

<!-- ============================================================ -->
<!-- SECTION 6: PRACTICE PROBLEMS -->
<!-- ============================================================ -->
<div class="section-card" data-section="6">
  <div class="section-header" onclick="toggleSection(this)">
    <h2><span class="section-num">6</span> Practice Problems</h2>
    <svg class="chevron" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"/></svg>
  </div>
  <div class="section-body"><div class="section-inner">

    <div class="practice-block" style="border-top:none;padding-top:0">
      <div class="practice-title">Numerical Problems</div>

      <div class="problem">
        <p><strong>1.</strong> A wave has frequency f = 440 Hz and wavelength &lambda; = 0.78 m. What is the wave speed?</p>
        <div class="problem-input-row">
          <input type="number" id="p1" step="0.1" placeholder="v = ?" onkeydown="if(event.key==='Enter')checkNum('p1',343.2,2)">
          <span class="unit-label">m/s</span>
          <button class="btn btn-sm" onclick="checkNum('p1',343.2,2)">Check</button>
        </div>
        <div class="feedback" id="p1-fb"></div>
      </div>

      <div class="problem">
        <p><strong>2.</strong> A string has tension T = 100 N and linear density &mu; = 0.0025 kg/m. What is the wave speed on the string?</p>
        <div class="problem-input-row">
          <input type="number" id="p2" step="0.1" placeholder="v = ?" onkeydown="if(event.key==='Enter')checkNum('p2',200,2)">
          <span class="unit-label">m/s</span>
          <button class="btn btn-sm" onclick="checkNum('p2',200,2)">Check</button>
        </div>
        <div class="feedback" id="p2-fb"></div>
      </div>

      <div class="problem">
        <p><strong>3.</strong> A 0.60 m guitar string vibrates in its 3rd harmonic with wave speed 300 m/s. What is the frequency of this harmonic?</p>
        <div class="problem-input-row">
          <input type="number" id="p3" step="1" placeholder="f_3 = ?" onkeydown="if(event.key==='Enter')checkNum('p3',750,10)">
          <span class="unit-label">Hz</span>
          <button class="btn btn-sm" onclick="checkNum('p3',750,10)">Check</button>
        </div>
        <div class="feedback" id="p3-fb"></div>
      </div>

      <div class="problem">
        <p><strong>4.</strong> Two waves y1 = 5 sin(4x - 8t) and y2 = 5 sin(4x - 8t + &pi;) overlap. What is the amplitude of the resultant wave?</p>
        <div class="problem-input-row">
          <input type="number" id="p4" step="0.1" placeholder="A = ?" onkeydown="if(event.key==='Enter')checkNum('p4',0,0.1)">
          <span class="unit-label">units</span>
          <button class="btn btn-sm" onclick="checkNum('p4',0,0.1)">Check</button>
        </div>
        <div class="feedback" id="p4-fb"></div>
      </div>

      <div class="problem">
        <p><strong>5.</strong> A string of length L = 1.2 m is fixed at both ends and vibrates at its fundamental frequency of 220 Hz. What is the wave speed on the string? (Hint: f_1 = v / 2L)</p>
        <div class="problem-input-row">
          <input type="number" id="p5" step="1" placeholder="v = ?" onkeydown="if(event.key==='Enter')checkNum('p5',528,5)">
          <span class="unit-label">m/s</span>
          <button class="btn btn-sm" onclick="checkNum('p5',528,5)">Check</button>
        </div>
        <div class="feedback" id="p5-fb"></div>
      </div>

    </div>
  </div></div>
</div>

<!-- ============================================================ -->
<!-- SECTION 7: QUIZ -->
<!-- ============================================================ -->
<div class="section-card" data-section="7">
  <div class="section-header" onclick="toggleSection(this)">
    <h2><span class="section-num">7</span> Quick Quiz &mdash; Mechanical Waves</h2>
    <svg class="chevron" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"/></svg>
  </div>
  <div class="section-body"><div class="section-inner">

    <div class="quiz-score">
      <span class="score-text">Score: <span id="quizScore">0</span> / 10</span>
      <button class="btn btn-sm" onclick="resetQuiz()">Reset Quiz</button>
    </div>

    <div class="quiz-q" data-quiz="q1">
      <div class="q-num">Question 1 -- Wave basics</div>
      <p class="q-text">A wave has frequency 500 Hz and wavelength 0.68 m. What is the wave speed?</p>
      <div class="choices">
        <button class="choice-btn" onclick="quizAnswer('q1',this,true)">340 m/s</button>
        <button class="choice-btn" onclick="quizAnswer('q1',this,false)">735 m/s</button>
        <button class="choice-btn" onclick="quizAnswer('q1',this,false)">170 m/s</button>
        <button class="choice-btn" onclick="quizAnswer('q1',this,false)">0.00136 m/s</button>
      </div>
    </div>

    <div class="quiz-q" data-quiz="q2">
      <div class="q-num">Question 2 -- Transverse vs longitudinal</div>
      <p class="q-text">In a transverse wave, the particles of the medium move:</p>
      <div class="choices">
        <button class="choice-btn" onclick="quizAnswer('q2',this,false)">Parallel to the wave direction</button>
        <button class="choice-btn" onclick="quizAnswer('q2',this,true)">Perpendicular to the wave direction</button>
        <button class="choice-btn" onclick="quizAnswer('q2',this,false)">In circles</button>
        <button class="choice-btn" onclick="quizAnswer('q2',this,false)">They do not move at all</button>
      </div>
    </div>

    <div class="quiz-q" data-quiz="q3">
      <div class="q-num">Question 3 -- Wave equation</div>
      <p class="q-text">A wave is described by y = 3 sin(2x - 6t). What is the wave speed?</p>
      <div class="choices">
        <button class="choice-btn" onclick="quizAnswer('q3',this,true)">3 m/s (v = &omega;/k = 6/2)</button>
        <button class="choice-btn" onclick="quizAnswer('q3',this,false)">6 m/s</button>
        <button class="choice-btn" onclick="quizAnswer('q3',this,false)">2 m/s</button>
        <button class="choice-btn" onclick="quizAnswer('q3',this,false)">12 m/s</button>
      </div>
    </div>

    <div class="quiz-q" data-quiz="q4">
      <div class="q-num">Question 4 -- Direction of travel</div>
      <p class="q-text">The wave y = A sin(kx + &omega;t) travels in which direction?</p>
      <div class="choices">
        <button class="choice-btn" onclick="quizAnswer('q4',this,false)">+x direction (right)</button>
        <button class="choice-btn" onclick="quizAnswer('q4',this,true)">&minus;x direction (left)</button>
        <button class="choice-btn" onclick="quizAnswer('q4',this,false)">+y direction (up)</button>
        <button class="choice-btn" onclick="quizAnswer('q4',this,false)">It is a standing wave</button>
      </div>
    </div>

    <div class="quiz-q" data-quiz="q5">
      <div class="q-num">Question 5 -- String wave speed</div>
      <p class="q-text">If the tension in a string is quadrupled while the linear density stays the same, the wave speed:</p>
      <div class="choices">
        <button class="choice-btn" onclick="quizAnswer('q5',this,true)">Doubles</button>
        <button class="choice-btn" onclick="quizAnswer('q5',this,false)">Quadruples</button>
        <button class="choice-btn" onclick="quizAnswer('q5',this,false)">Halves</button>
        <button class="choice-btn" onclick="quizAnswer('q5',this,false)">Stays the same</button>
      </div>
    </div>

    <div class="quiz-q" data-quiz="q6">
      <div class="q-num">Question 6 -- Superposition</div>
      <p class="q-text">Two waves with the same amplitude A are exactly out of phase (&Delta;&phi; = &pi;). The resultant amplitude is:</p>
      <div class="choices">
        <button class="choice-btn" onclick="quizAnswer('q6',this,false)">2A</button>
        <button class="choice-btn" onclick="quizAnswer('q6',this,false)">A</button>
        <button class="choice-btn" onclick="quizAnswer('q6',this,true)">0</button>
        <button class="choice-btn" onclick="quizAnswer('q6',this,false)">A/2</button>
      </div>
    </div>

    <div class="quiz-q" data-quiz="q7">
      <div class="q-num">Question 7 -- Standing waves</div>
      <p class="q-text">A string fixed at both ends vibrates in its 4th harmonic. How many nodes are there (including the endpoints)?</p>
      <div class="choices">
        <button class="choice-btn" onclick="quizAnswer('q7',this,false)">4</button>
        <button class="choice-btn" onclick="quizAnswer('q7',this,true)">5</button>
        <button class="choice-btn" onclick="quizAnswer('q7',this,false)">3</button>
        <button class="choice-btn" onclick="quizAnswer('q7',this,false)">8</button>
      </div>
    </div>

    <div class="quiz-q" data-quiz="q8">
      <div class="q-num">Question 8 -- Harmonics</div>
      <p class="q-text">A 1.0 m string fixed at both ends has a fundamental frequency of 150 Hz. What is the frequency of the 3rd harmonic?</p>
      <div class="choices">
        <button class="choice-btn" onclick="quizAnswer('q8',this,false)">50 Hz</button>
        <button class="choice-btn" onclick="quizAnswer('q8',this,false)">300 Hz</button>
        <button class="choice-btn" onclick="quizAnswer('q8',this,true)">450 Hz</button>
        <button class="choice-btn" onclick="quizAnswer('q8',this,false)">600 Hz</button>
      </div>
    </div>

    <div class="quiz-q" data-quiz="q9">
      <div class="q-num">Question 9 -- Wave number</div>
      <p class="q-text">A wave has wavelength &lambda; = 0.5 m. What is its wave number k?</p>
      <div class="choices">
        <button class="choice-btn" onclick="quizAnswer('q9',this,false)">2 rad/m</button>
        <button class="choice-btn" onclick="quizAnswer('q9',this,false)">&pi; rad/m</button>
        <button class="choice-btn" onclick="quizAnswer('q9',this,true)">4&pi; rad/m</button>
        <button class="choice-btn" onclick="quizAnswer('q9',this,false)">0.5 rad/m</button>
      </div>
    </div>

    <div class="quiz-q" data-quiz="q10">
      <div class="q-num">Question 10 -- Nodes and antinodes</div>
      <p class="q-text">At a node of a standing wave, the displacement is always:</p>
      <div class="choices">
        <button class="choice-btn" onclick="quizAnswer('q10',this,true)">Zero</button>
        <button class="choice-btn" onclick="quizAnswer('q10',this,false)">Maximum</button>
        <button class="choice-btn" onclick="quizAnswer('q10',this,false)">Half the amplitude</button>
        <button class="choice-btn" onclick="quizAnswer('q10',this,false)">Equal to the wavelength</button>
      </div>
    </div>

  </div></div>
</div>

</div><!-- end content -->

<script>
/* ==================== PROGRESS & SECTIONS ==================== */
var completedSections = new Set();

function updateProgress() {
  var cards = document.querySelectorAll('.section-card');
  var total = cards.length;
  var pct = (completedSections.size / total) * 100;
  document.getElementById('progressFill').style.width = pct + '%';
  document.getElementById('progressLabel').textContent = completedSections.size + ' / ' + total + ' sections';
}

function markComplete(n) {
  if (completedSections.has(n)) return;
  completedSections.add(n);
  var card = document.querySelector('.section-card[data-section="'+n+'"]');
  if (card) card.classList.add('completed');
  updateProgress();
}

function toggleSection(header) {
  var card = header.parentElement;
  card.classList.toggle('open');
  if (card.classList.contains('open')) {
    var s = +card.getAttribute('data-section');
    markComplete(s);
  }
  updateProgress();
}

/* ==================== PROBLEM CHECKING ==================== */
function checkNum(id, answer, tol) {
  var inp = document.getElementById(id);
  var fb = document.getElementById(id + '-fb');
  var val = parseFloat(inp.value);
  if (isNaN(val)) { fb.className = 'feedback incorrect'; fb.textContent = 'Enter a number.'; inp.parentElement.parentElement.classList.add('shake'); setTimeout(function(){inp.parentElement.parentElement.classList.remove('shake')},400); return; }
  if (Math.abs(val - answer) <= tol) {
    fb.className = 'feedback correct'; fb.textContent = 'Correct! The answer is ' + answer + '.';
    inp.parentElement.parentElement.classList.add('pop'); setTimeout(function(){inp.parentElement.parentElement.classList.remove('pop')},350);
  } else {
    fb.className = 'feedback incorrect'; fb.textContent = 'Not quite. Try again. (Hint: near ' + answer.toFixed(1) + ')';
    inp.parentElement.parentElement.classList.add('shake'); setTimeout(function(){inp.parentElement.parentElement.classList.remove('shake')},400);
  }
}

function checkMC(btn, id, result) {
  var fb = document.getElementById(id + '-fb');
  var btns = btn.parentElement.querySelectorAll('.mc-btn');
  btns.forEach(function(b) { b.classList.add('disabled'); });
  if (result === 'correct') {
    btn.classList.add('correct');
    fb.className = 'feedback correct'; fb.textContent = 'Correct!';
    btn.closest('.problem').classList.add('pop'); setTimeout(function(){btn.closest('.problem').classList.remove('pop')},350);
  } else {
    btn.classList.add('wrong');
    fb.className = 'feedback incorrect'; fb.textContent = 'Not quite. Review the concept above.';
    btn.closest('.problem').classList.add('shake'); setTimeout(function(){btn.closest('.problem').classList.remove('shake')},400);
  }
}

/* ==================== QUIZ ==================== */
var quizScoreVal = 0, quizAnswered = new Set();

function quizAnswer(qn, btn, correct) {
  if (quizAnswered.has(qn)) return;
  quizAnswered.add(qn);
  var btns = btn.parentElement.querySelectorAll('.choice-btn');
  btns.forEach(function(b) { b.classList.add('disabled'); });
  if (correct) {
    btn.classList.add('selected-correct');
    quizScoreVal++;
    btn.closest('.quiz-q').classList.add('pop'); setTimeout(function(){btn.closest('.quiz-q').classList.remove('pop')},350);
  } else {
    btn.classList.add('selected-wrong');
    btns.forEach(function(b) {
      var oc = b.getAttribute('onclick');
      if (oc && oc.indexOf('true') !== -1) b.classList.add('reveal-correct');
    });
    btn.closest('.quiz-q').classList.add('shake'); setTimeout(function(){btn.closest('.quiz-q').classList.remove('shake')},400);
  }
  document.getElementById('quizScore').textContent = quizScoreVal;
}

function resetQuiz() {
  quizScoreVal = 0; quizAnswered.clear();
  document.getElementById('quizScore').textContent = '0';
  document.querySelectorAll('.quiz-q .choice-btn').forEach(function(b) { b.className = 'choice-btn'; });
}

/* ==================== ANIMATION ENGINE ==================== */
var animTime = 0;
var animRunning = true;

function animLoop(ts) {
  animTime = ts / 1000;
  drawS1Wave();
  drawS2Wave();
  drawS3Wave();
  drawS4Waves();
  drawS5Standing();
  if (animRunning) requestAnimationFrame(animLoop);
}

/* ==================== SECTION 1: WAVE BASICS ==================== */
var s1Lambda = 150, s1Freq = 1, s1Amp = 50;

function updateS1() {
  s1Lambda = +document.getElementById('s1Lambda').value;
  s1Freq = +document.getElementById('s1Freq').value;
  s1Amp = +document.getElementById('s1Amp').value;
  document.getElementById('s1LambdaVal').textContent = s1Lambda + ' px';
  document.getElementById('s1FreqVal').textContent = s1Freq.toFixed(1) + ' Hz';
  document.getElementById('s1AmpVal').textContent = s1Amp + ' px';
  var v = s1Freq * s1Lambda;
  var T = 1 / s1Freq;
  document.getElementById('s1Speed').textContent = v.toFixed(0) + ' px/s';
  document.getElementById('s1Period').textContent = T.toFixed(2) + ' s';
  document.getElementById('s1LamR').textContent = s1Lambda + ' px';
}

function drawS1Wave() {
  var svg = document.getElementById('s1Svg');
  var W = 700, H = 220, cy = H / 2;
  var k = 2 * Math.PI / s1Lambda;
  var omega = 2 * Math.PI * s1Freq;
  var pts = '';
  for (var x = 0; x <= W; x += 2) {
    var y = cy - s1Amp * Math.sin(k * x - omega * animTime);
    pts += (x === 0 ? 'M' : 'L') + x + ',' + y.toFixed(1);
  }
  var h = '<rect width="'+W+'" height="'+H+'" fill="#1a1d24" rx="6"/>';
  h += '<line x1="0" y1="'+cy+'" x2="'+W+'" y2="'+cy+'" stroke="#363b47" stroke-width="1" stroke-dasharray="4,4"/>';
  // wavelength marker
  var lx1 = 50, lx2 = 50 + s1Lambda;
  if (lx2 < W - 20) {
    h += '<line x1="'+lx1+'" y1="'+(H-20)+'" x2="'+lx2+'" y2="'+(H-20)+'" stroke="'+getCSS('--amber')+'" stroke-width="2" marker-start="url(#arrL)" marker-end="url(#arrR)"/>';
    h += '<text x="'+((lx1+lx2)/2)+'" y="'+(H-6)+'" text-anchor="middle" fill="'+getCSS('--amber')+'" font-size="10">&lambda; = '+s1Lambda+' px</text>';
  }
  // amplitude marker
  h += '<line x1="20" y1="'+cy+'" x2="20" y2="'+(cy-s1Amp)+'" stroke="'+getCSS('--green')+'" stroke-width="2"/>';
  h += '<text x="30" y="'+(cy-s1Amp+4)+'" fill="'+getCSS('--green')+'" font-size="9">A</text>';
  h += '<defs><marker id="arrL" markerWidth="6" markerHeight="4" refX="0" refY="2" orient="auto"><path d="M6,0 L0,2 L6,4Z" fill="'+getCSS('--amber')+'"/></marker>';
  h += '<marker id="arrR" markerWidth="6" markerHeight="4" refX="6" refY="2" orient="auto"><path d="M0,0 L6,2 L0,4Z" fill="'+getCSS('--amber')+'"/></marker></defs>';
  h += '<path d="'+pts+'" fill="none" stroke="'+getCSS('--indigo')+'" stroke-width="2.5"/>';
  svg.innerHTML = h;
}

/* ==================== SECTION 2: WAVE EQUATION ==================== */
var s2K = 0.05, s2Omega = 3, s2A = 50;

function updateS2() {
  s2K = +document.getElementById('s2K').value;
  s2Omega = +document.getElementById('s2Omega').value;
  s2A = +document.getElementById('s2A').value;
  document.getElementById('s2KVal').textContent = s2K.toFixed(3) + ' rad/px';
  document.getElementById('s2OmegaVal').textContent = s2Omega.toFixed(1) + ' rad/s';
  document.getElementById('s2AVal').textContent = s2A + ' px';
  var lam = 2 * Math.PI / s2K;
  var freq = s2Omega / (2 * Math.PI);
  var spd = s2Omega / s2K;
  document.getElementById('s2LamR').textContent = lam.toFixed(1) + ' px';
  document.getElementById('s2FreqR').textContent = freq.toFixed(2) + ' Hz';
  document.getElementById('s2SpeedR').textContent = spd.toFixed(1) + ' px/s';
  document.getElementById('s2DirR').textContent = '+x (right)';
}

function drawS2Wave() {
  var svg = document.getElementById('s2Svg');
  var W = 700, H = 220, cy = H / 2;
  var pts = '';
  for (var x = 0; x <= W; x += 2) {
    var y = cy - s2A * Math.sin(s2K * x - s2Omega * animTime);
    pts += (x === 0 ? 'M' : 'L') + x + ',' + y.toFixed(1);
  }
  var h = '<rect width="'+W+'" height="'+H+'" fill="#1a1d24" rx="6"/>';
  h += '<line x1="0" y1="'+cy+'" x2="'+W+'" y2="'+cy+'" stroke="#363b47" stroke-width="1" stroke-dasharray="4,4"/>';
  // direction arrow
  h += '<polygon points="'+(W-40)+','+(H-30)+' '+(W-20)+','+(H-25)+' '+(W-40)+','+(H-20)+'" fill="'+getCSS('--pink')+'" opacity="0.6"/>';
  h += '<text x="'+(W-60)+'" y="'+(H-20)+'" text-anchor="end" fill="'+getCSS('--pink')+'" font-size="9">+x</text>';
  h += '<path d="'+pts+'" fill="none" stroke="'+getCSS('--indigo')+'" stroke-width="2.5"/>';
  // equation label
  h += '<text x="10" y="18" fill="'+getCSS('--text-dim')+'" font-size="10">y(x,t) = '+s2A+'sin('+s2K.toFixed(3)+'x - '+s2Omega.toFixed(1)+'t)</text>';
  svg.innerHTML = h;
}

/* ==================== SECTION 3: WAVE SPEED ON A STRING ==================== */
function updateS3() {
  var T = +document.getElementById('s3Tension').value;
  var mu = +document.getElementById('s3Mu').value;
  document.getElementById('s3TVal').textContent = T + ' N';
  document.getElementById('s3MuVal').textContent = mu.toFixed(3) + ' kg/m';
  var v = Math.sqrt(T / mu);
  document.getElementById('s3Speed').textContent = v.toFixed(1) + ' m/s';
  document.getElementById('s3TR').textContent = T + ' N';
  document.getElementById('s3MuR').textContent = mu.toFixed(3) + ' kg/m';
}

function drawS3Wave() {
  var svg = document.getElementById('s3Svg');
  var T = +document.getElementById('s3Tension').value;
  var mu = +document.getElementById('s3Mu').value;
  var v = Math.sqrt(T / mu);
  var W = 700, H = 160, cy = H / 2;
  // wave speed maps to visual speed
  var maxV = Math.sqrt(200 / 0.001); // max possible speed
  var scaledFreq = 0.5 + (v / maxV) * 4;
  var omega = 2 * Math.PI * scaledFreq;
  var k = 0.04;
  var amp = 40;
  var pts = '';
  for (var x = 0; x <= W; x += 2) {
    var y = cy - amp * Math.sin(k * x - omega * animTime);
    pts += (x === 0 ? 'M' : 'L') + x + ',' + y.toFixed(1);
  }
  var h = '<rect width="'+W+'" height="'+H+'" fill="#1a1d24" rx="6"/>';
  h += '<line x1="0" y1="'+cy+'" x2="'+W+'" y2="'+cy+'" stroke="#363b47" stroke-width="1" stroke-dasharray="4,4"/>';
  // string endpoints
  h += '<circle cx="10" cy="'+cy+'" r="5" fill="'+getCSS('--amber')+'"/>';
  h += '<circle cx="'+(W-10)+'" cy="'+cy+'" r="5" fill="'+getCSS('--amber')+'"/>';
  h += '<text x="'+(W/2)+'" y="20" text-anchor="middle" fill="'+getCSS('--text-dim')+'" font-size="10">v = '+v.toFixed(1)+' m/s</text>';
  // thickness represents mu
  var sw = 1 + mu * 40;
  h += '<path d="'+pts+'" fill="none" stroke="'+getCSS('--indigo')+'" stroke-width="'+sw.toFixed(1)+'"/>';
  svg.innerHTML = h;
}

/* ==================== SECTION 4: SUPERPOSITION ==================== */
var s4Phase = 0, s4A1 = 40, s4A2 = 40;

function updateS4() {
  s4Phase = +document.getElementById('s4Phase').value;
  s4A1 = +document.getElementById('s4A1').value;
  s4A2 = +document.getElementById('s4A2').value;
  var deg = (s4Phase * 180 / Math.PI).toFixed(0);
  document.getElementById('s4PhaseVal').textContent = s4Phase.toFixed(2) + ' rad';
  document.getElementById('s4A1Val').textContent = s4A1 + ' px';
  document.getElementById('s4A2Val').textContent = s4A2 + ' px';
  document.getElementById('s4PhaseR').textContent = s4Phase.toFixed(2) + ' rad (' + deg + '\u00B0)';
  // resultant amplitude using phasor addition
  var rAmp = Math.sqrt(s4A1*s4A1 + s4A2*s4A2 + 2*s4A1*s4A2*Math.cos(s4Phase));
  document.getElementById('s4ResultAmp').textContent = rAmp.toFixed(1) + ' px';
  var absDiff = Math.abs(s4Phase % (2 * Math.PI));
  if (absDiff < 0.15 || absDiff > 6.13) {
    document.getElementById('s4Type').textContent = 'Constructive';
    document.getElementById('s4Type').className = 'value green';
  } else if (Math.abs(absDiff - Math.PI) < 0.15) {
    document.getElementById('s4Type').textContent = 'Destructive';
    document.getElementById('s4Type').className = 'value pink';
  } else {
    document.getElementById('s4Type').textContent = 'Partial';
    document.getElementById('s4Type').className = 'value amber';
  }
}

function drawS4Waves() {
  var svg = document.getElementById('s4Svg');
  var W = 700, H = 360;
  var cy1 = 70, cy2 = 180, cy3 = 290;
  var k = 0.04, omega = 2;
  var pts1 = '', pts2 = '', pts3 = '';
  for (var x = 0; x <= W; x += 2) {
    var y1v = s4A1 * Math.sin(k * x - omega * animTime);
    var y2v = s4A2 * Math.sin(k * x - omega * animTime + s4Phase);
    var y3v = y1v + y2v;
    pts1 += (x === 0 ? 'M' : 'L') + x + ',' + (cy1 - y1v).toFixed(1);
    pts2 += (x === 0 ? 'M' : 'L') + x + ',' + (cy2 - y2v).toFixed(1);
    pts3 += (x === 0 ? 'M' : 'L') + x + ',' + (cy3 - y3v).toFixed(1);
  }
  var h = '<rect width="'+W+'" height="'+H+'" fill="#1a1d24" rx="6"/>';
  // baselines
  h += '<line x1="0" y1="'+cy1+'" x2="'+W+'" y2="'+cy1+'" stroke="#363b47" stroke-width="1" stroke-dasharray="4,4"/>';
  h += '<line x1="0" y1="'+cy2+'" x2="'+W+'" y2="'+cy2+'" stroke="#363b47" stroke-width="1" stroke-dasharray="4,4"/>';
  h += '<line x1="0" y1="'+cy3+'" x2="'+W+'" y2="'+cy3+'" stroke="#363b47" stroke-width="1" stroke-dasharray="4,4"/>';
  // separator lines
  h += '<line x1="0" y1="125" x2="'+W+'" y2="125" stroke="#363b47" stroke-width="0.5"/>';
  h += '<line x1="0" y1="235" x2="'+W+'" y2="235" stroke="#363b47" stroke-width="0.5"/>';
  // labels
  h += '<text x="8" y="20" fill="'+getCSS('--indigo')+'" font-size="10" font-weight="600">Wave 1</text>';
  h += '<text x="8" y="140" fill="'+getCSS('--green')+'" font-size="10" font-weight="600">Wave 2 (phase shifted)</text>';
  h += '<text x="8" y="250" fill="'+getCSS('--amber')+'" font-size="10" font-weight="600">Resultant (y1 + y2)</text>';
  // waves
  h += '<path d="'+pts1+'" fill="none" stroke="'+getCSS('--indigo')+'" stroke-width="2.5"/>';
  h += '<path d="'+pts2+'" fill="none" stroke="'+getCSS('--green')+'" stroke-width="2.5"/>';
  h += '<path d="'+pts3+'" fill="none" stroke="'+getCSS('--amber')+'" stroke-width="3"/>';
  svg.innerHTML = h;
}

/* ==================== SECTION 5: STANDING WAVES ==================== */
var s5N = 1;

function setHarmonic(n, btn) {
  s5N = n;
  btn.parentElement.querySelectorAll('.scenario-tab').forEach(function(b){b.classList.remove('active')});
  btn.classList.add('active');
  document.getElementById('s5NR').textContent = n;
  document.getElementById('s5Nodes').textContent = n + 1;
  document.getElementById('s5Anti').textContent = n;
  document.getElementById('s5Lam').textContent = n === 1 ? '2L' : '2L/' + n;
  document.getElementById('s5Freq').textContent = n === 1 ? 'f_1' : n + 'f_1';
}

function drawS5Standing() {
  var svg = document.getElementById('s5Svg');
  var W = 700, H = 240, cy = H / 2;
  var pad = 40;
  var strL = W - 2 * pad;
  var amp = 70;
  var omega = 3;
  var h = '<rect width="'+W+'" height="'+H+'" fill="#1a1d24" rx="6"/>';
  h += '<line x1="'+pad+'" y1="'+cy+'" x2="'+(W-pad)+'" y2="'+cy+'" stroke="#363b47" stroke-width="1" stroke-dasharray="4,4"/>';
  // fixed ends
  h += '<rect x="'+(pad-6)+'" y="'+(cy-30)+'" width="6" height="60" fill="'+getCSS('--text-dim')+'" rx="2"/>';
  h += '<rect x="'+(W-pad)+'" y="'+(cy-30)+'" width="6" height="60" fill="'+getCSS('--text-dim')+'" rx="2"/>';
  // draw standing wave envelope (max and min)
  var envTop = '', envBot = '';
  var wavePts = '';
  for (var i = 0; i <= 200; i++) {
    var frac = i / 200;
    var x = pad + frac * strL;
    var envelope = amp * Math.sin(s5N * Math.PI * frac);
    var yTop = cy - envelope;
    var yBot = cy + envelope;
    envTop += (i === 0 ? 'M' : 'L') + x.toFixed(1) + ',' + yTop.toFixed(1);
    envBot += (i === 0 ? 'M' : 'L') + x.toFixed(1) + ',' + yBot.toFixed(1);
    var disp = envelope * Math.cos(omega * animTime);
    wavePts += (i === 0 ? 'M' : 'L') + x.toFixed(1) + ',' + (cy - disp).toFixed(1);
  }
  // envelope
  h += '<path d="'+envTop+'" fill="none" stroke="'+getCSS('--indigo')+'" stroke-width="1" stroke-dasharray="3,3" opacity="0.4"/>';
  h += '<path d="'+envBot+'" fill="none" stroke="'+getCSS('--indigo')+'" stroke-width="1" stroke-dasharray="3,3" opacity="0.4"/>';
  // actual wave
  h += '<path d="'+wavePts+'" fill="none" stroke="'+getCSS('--indigo')+'" stroke-width="3"/>';
  // mark nodes
  for (var j = 0; j <= s5N; j++) {
    var nx = pad + (j / s5N) * strL;
    h += '<circle cx="'+nx.toFixed(1)+'" cy="'+cy+'" r="5" fill="'+getCSS('--pink')+'" opacity="0.8"/>';
  }
  // mark antinodes
  for (var j = 0; j < s5N; j++) {
    var ax = pad + ((j + 0.5) / s5N) * strL;
    h += '<circle cx="'+ax.toFixed(1)+'" cy="'+cy+'" r="4" fill="none" stroke="'+getCSS('--green')+'" stroke-width="2"/>';
  }
  // legend
  h += '<circle cx="'+(W-180)+'" cy="18" r="4" fill="'+getCSS('--pink')+'"/>';
  h += '<text x="'+(W-170)+'" y="22" fill="'+getCSS('--pink')+'" font-size="9">Node</text>';
  h += '<circle cx="'+(W-120)+'" cy="18" r="4" fill="none" stroke="'+getCSS('--green')+'" stroke-width="2"/>';
  h += '<text x="'+(W-110)+'" y="22" fill="'+getCSS('--green')+'" font-size="9">Antinode</text>';
  // harmonic label
  h += '<text x="'+pad+'" y="18" fill="'+getCSS('--text-dim')+'" font-size="10">n = '+s5N+' ('+getHarmonicName(s5N)+')</text>';
  svg.innerHTML = h;
}

function getHarmonicName(n) {
  if (n === 1) return 'Fundamental';
  if (n === 2) return '2nd harmonic / 1st overtone';
  if (n === 3) return '3rd harmonic / 2nd overtone';
  if (n === 4) return '4th harmonic / 3rd overtone';
  if (n === 5) return '5th harmonic / 4th overtone';
  return n + 'th harmonic';
}

/* ==================== UTILITY ==================== */
function getCSS(prop) {
  return getComputedStyle(document.documentElement).getPropertyValue(prop).trim();
}

/* ==================== INIT ==================== */
updateS1();
updateS2();
updateS3();
updateS4();
markComplete(1);
requestAnimationFrame(animLoop);
</script>
</body>
</html>
